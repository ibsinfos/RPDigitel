var placeHolderEvent=function(event){if($(this).prev('.placeholder').exists()){if($(this).is(":focus")){$(this).prev('.placeholder').css('display','none');}else{if($(this).val()!=""){$(this).prev('.placeholder').css('display','none');}else{$(this).prev('.placeholder').css('display','');}}}};$(document).on("focus blur keyup change",'input',placeHolderEvent);$(document).on("focus blur keyup change",'textarea',placeHolderEvent);var placeholderClick=function(ph){if($(ph).next('input').exists()){$(ph).next('input').focus();}else if($(ph).next('textarea').exists()){$(ph).next('textarea').focus();}};var device=(function(){var ua=navigator.userAgent.toLowerCase();var self={};self.testCSS=function(prop){return prop in document.documentElement.style;};self.OS="";self.OSVersion="";self.Browser="";self.BrowserVersion="";self.RenderingEngine="";self.RenderingEngineVersion="";self.PhoneGap=!!((window.PhoneGap)||(window.cordova));self.iOSWebView=(ua.match(/ipad|iphone|ipod/i)!==null&&ua.indexOf('safari')==-1&&!window.navigator.standalone);self.iOSStandalone=!!(window.navigator.standalone);self.isOS={};self.isOS.iOS=((ua.match(/ipad|iphone|ipod/i)!==null));self.isOS.Android=(ua.indexOf("android")>-1);self.isOS.FirefoxOS=((ua.indexOf("firefox")>-1)&&(ua.indexOf("mobile")>-1)&&(ua.indexOf("android")==-1));self.isOS.Blackberry=((ua.indexOf("blackberry")>-1));self.isOS.Playbook=((ua.indexOf("playbook")>-1));self.isOS.WindowsPhone=((ua.indexOf("msie")>-1)&&(ua.indexOf("windows phone")>-1));self.isOS.WindowsCE=((ua.indexOf("msie")>-1)&&(ua.indexOf("windows ce")>-1));self.isOS.Zune=((ua.indexOf("msie")>-1)&&(ua.indexOf("zunewp7")>-1));self.isOS.webOS=(ua.indexOf("webos")>-1);self.isOS.OSX=((ua.match(/macintosh/i)!==null));self.isOS.Windows=((ua.match(/windows/i)!==null)&&!self.isOS.WindowsPhone);self.OSVersion=(function(){try{if(self.isOS.iOS){self.OS="iOS";if(/OS \d_\d(_\d)? like Mac OS X/i.test(navigator.userAgent)){var match=/OS \d_\d_?\d? like Mac OS X/i.exec(navigator.userAgent)[0];var sversion=/\d_\d_?\d?/i.exec(match)[0];return parseFloat(sversion.replace(/_/g,'.'))||undefined;}else if(/CPU like Mac OS X/i.test(navigator.userAgent)){return 1;}}
if(self.isOS.Android){self.OS="Android";if(/Android \d\.\d\.?\d?/i.test(navigator.userAgent)){var match=/Android \d\.\d\.?\d?/i.exec(navigator.userAgent)[0];var sversion=/\d\.\d\.?\d?/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isOS.FirefoxOS){self.OS="FirefoxOS";if(/Firefox\/\d+\.\d+/i.test(navigator.userAgent)){var match=/Firefox\/\d+\.\d+/i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isOS.Blackberry){self.OS="Blackberry";if(navigator.userAgent.indexOf("WebKit")>=0&&(/Version\/(\d+\.\d+)/i.test(navigator.userAgent))){return parseFloat(navigator.userAgent.match(/Version\/(\d+\.\d+)/)[1])||undefined;}else if(/BlackBerry\w+\/([\d\.]+)/i.test(navigator.userAgent)){var versAarray=/BlackBerry\w+\/([\d\.]+)/i.exec(navigator.userAgent);return parseInt(versAarray[1])||undefined;}}
if(self.isOS.Playbook){self.OS="Playbook";if((/RIM Tablet OS (\d+\.\d+)/i.test(navigator.userAgent))){return parseFloat(navigator.userAgent.match(/RIM Tablet OS (\d+\.\d+)/)[1])||undefined;}}
if(self.isOS.WindowsPhone){self.OS="WindowsPhone";if(/Windows Phone OS (\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Windows Phone OS (\d+\.\d+)/)[1])||undefined;}
if(/Windows Phone (\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Windows Phone (\d+\.\d+)/)[1])||undefined;}}
if(self.isOS.WindowsCE){self.OS="WindowsCE";if(/IEMobile (\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/IEMobile (\d+\.\d+)/)[1])||undefined;}}
if(self.isOS.Zune){self.OS="Zune";if(/MSIE (\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1])||undefined;}}
if(self.isOS.webOS){self.OS="webOS";if(/webOS\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/webOS\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isOS.OSX){self.OS="OSX";if(/Mac OS X \d+_\d+?/i.test(navigator.userAgent)){var match=/Mac OS X \d+_\d+?/i.exec(navigator.userAgent)[0];var sversion=/\d+_\d+_?/i.exec(match)[0];return parseFloat(sversion.replace(/_/g,'.'))||undefined;}}
if(self.isOS.Windows){self.OS="Windows";if(/Windows NT \d+\.\d+/i.test(navigator.userAgent)){var match=/Windows NT \d+\.\d+/i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}}}catch(e){console.log(e.message);}
return undefined;})();self.isBrowser={};self.isBrowser.MobileSafari=(self.isOS.iOS&&((ua.indexOf('safari/')>-1)||(self.iOSStandalone))&&(ua.indexOf('crios/')==-1)&&(ua.indexOf('opera mini/')==-1)&&(ua.indexOf('opera mobi')==-1)&&(ua.indexOf('mercury/')==-1));self.isBrowser.AndroidBrowser=((ua.indexOf("android")>-1)&&(ua.indexOf("chrome")==-1)&&(ua.indexOf('firefox/')==-1));self.isBrowser.MobileChrome=(((ua.indexOf('crios/')>-1)&&(ua.indexOf('safari/')>-1))||((ua.indexOf("android")>-1)&&(ua.indexOf("chrome")>-1)));self.isBrowser.MobileFirefox=(self.isOS.Android&&(ua.indexOf('firefox/')>-1));self.isBrowser.FirefoxOS=(ua.indexOf('android;')==-1&&ua.indexOf('firefox/')>-1);self.isBrowser.Mercury=(self.isOS.iOS&&(ua.indexOf('mercury/')>-1));self.isBrowser.OperaMobile=(ua.indexOf('opera mobi/')>-1);self.isBrowser.OperaMini=((ua.indexOf('opera mini/')>-1)&&!(ua.indexOf('opera mobi')>-1));self.isBrowser.Dolphin=(ua.indexOf('dolphin/')>-1);self.isBrowser.IEMobile=((ua.indexOf("msie")>-1)&&(ua.indexOf("iemobile")>-1)&&(ua.indexOf("windows ce")==-1));self.isBrowser.Blackberry=(((ua.indexOf("blackberry")>-1)||(ua.indexOf("playbook")>-1))&&(ua.indexOf('opera mini/')==-1)&&(ua.indexOf('opera mobi')==-1));self.isBrowser.webOS=(ua.indexOf("webos")>-1);self.isBrowser.Safari=((ua.indexOf("safari/")>-1)&&!(ua.match(/ipad|iphone|ipod/i)!==null)&&!(ua.indexOf("android")>-1)&&!(ua.indexOf("blackberry")>-1)&&!(ua.indexOf("playbook")>-1)&&!(ua.indexOf("chrome/")>-1)&&!(ua.indexOf("chromium/")>-1));self.isBrowser.Chrome=window.chrome&&((ua.indexOf("chrome/")>-1)&&(ua.indexOf("chromium/")==-1)&&(ua.indexOf("android")==-1));self.isBrowser.Firefox=(self.testCSS('MozBoxSizing')&&(ua.indexOf("android")==-1))||((ua.indexOf("firefox/")>-1)&&(ua.indexOf("seamonkey/")==-1)&&(ua.indexOf("android")==-1));self.isBrowser.Seamonkey=(ua.indexOf("seamonkey/")>-1);self.isBrowser.Opera=((!!(window.opera&&window.opera.version)||(ua.indexOf("opera/")>-1))&&!(ua.indexOf('opera mini/')>-1)&&!(ua.indexOf('opera mobi')>-1));self.isBrowser.InternetExplorer=(((self.testCSS('msTransform'))||(ua.indexOf("msie")>-1))&&!(ua.indexOf("windows ce")>-1)&&!(ua.indexOf("windows phone")>-1));self.BrowserVersion=(function(){try{if(self.isBrowser.MobileSafari){self.Browser="MobileSafari";if(/OS \d_\d(_\d)? like Mac OS X/i.test(navigator.userAgent)){var match=/OS \d_\d_?\d? like Mac OS X/i.exec(navigator.userAgent)[0];var sversion=/\d_\d_?\d?/i.exec(match)[0];return parseFloat(sversion.replace(/_/g,'.'))||undefined;}else if(/CPU like Mac OS X/i.test(navigator.userAgent)){return 1;}}
if(self.isBrowser.AndroidBrowser){self.Browser="AndroidBrowser";if(/Android \d\.\d\.?\d?/i.test(navigator.userAgent)){var match=/Android \d\.\d\.?\d?/i.exec(navigator.userAgent)[0];var sversion=/\d\.\d\.?\d?/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isBrowser.MobileChrome){self.Browser="MobileChrome";if(/CriOS\/\d+\.\d+\./i.test(navigator.userAgent)){var match=/CriOS\/\d+\.\d+\./i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}
if(/Chrome\/\d+\.\d+\./i.exec(navigator.userAgent)){var match=/Chrome\/\d+\.\d+\./i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isBrowser.MobileFirefox){self.Browser="MobileFirefox";if(/Firefox\/\d+\.\d+/i.test(navigator.userAgent)){var match=/Firefox\/\d+\.\d+/i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isBrowser.FirefoxOS){self.Browser="FirefoxOS";if(/Firefox\/\d+\.\d+/i.test(navigator.userAgent)){var match=/Firefox\/\d+\.\d+/i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isBrowser.Mercury){self.Browser="Mercury";if(/Mercury\/\d+\.\d+/i.test(navigator.userAgent)){var match=/Mercury\/\d+\.\d+/i.exec(navigator.userAgent)[0];var sversion=/\d+\.\d+/i.exec(match)[0];return parseFloat(sversion)||undefined;}}
if(self.isBrowser.OperaMobile){self.Browser="OperaMobile";if(/Opera Mobi\//i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.split("Opera Mobi/")[1])||undefined;}}
if(self.isBrowser.OperaMini){self.Browser="OperaMini";if(/Opera Mini\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Opera Mini\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.Dolphin){self.Browser="Dolphin";if(/Dolphin\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Dolphin\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.IEMobile){self.Browser="IEMobile";if(/IEMobile\/\d+\.\d+/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/IEMobile\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.Blackberry){self.Browser="Blackberry";if((/RIM Tablet OS (\d+\.\d+)/i.test(navigator.userAgent))){return parseFloat(navigator.userAgent.match(/RIM Tablet OS (\d+\.\d+)/)[1])||undefined;}else if(navigator.userAgent.indexOf("WebKit")>=0&&(/Version\/(\d+\.\d+)/i.test(navigator.userAgent))){return parseFloat(navigator.userAgent.match(/Version\/(\d+\.\d+)/)[1])||undefined;}else if(/BlackBerry\w+\/([\d\.]+)/i.test(navigator.userAgent)){var versAarray=/BlackBerry\w+\/([\d\.]+)/i.exec(navigator.userAgent);return parseInt(versAarray[1])||undefined;}}
if(self.isBrowser.webOS){self.Browser="webOS";if(/webOS\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/webOS\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.Safari){self.Browser="Safari";if(/Version\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Version\/(\d+\.\d+)/)[1])||2.0||undefined;}}
if(self.isBrowser.Chrome){self.Browser="Chrome";if(/Chrome\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Chrome\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.Firefox){self.Browser="Firefox";if(/Chrome\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Firefox\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.Seamonkey){self.Browser="Seamonkey";if(/Version\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Version\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.Opera){self.Browser="Opera";if(/Version\/(\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/Version\/(\d+\.\d+)/)[1])||parseFloat(navigator.userAgent.match(/Opera\/(\d+\.\d+)/)[1])||undefined;}}
if(self.isBrowser.InternetExplorer){self.Browser="InternetExplorer";if(/MSIE (\d+\.\d+)/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1])||undefined;}}}catch(e){console.log(e.message);}
return undefined;})();self.isRenderingEngine={};self.isRenderingEngine.WebKit=(ua.indexOf("webkit/")>-1);self.isRenderingEngine.Gecko=(ua.indexOf("gecko/")>-1);self.isRenderingEngine.Presto=(ua.indexOf("presto/")>-1);self.isRenderingEngine.Trident=((ua.indexOf("trident/")>-1)||(!(ua.indexOf("trident/")>-1)&&(ua.indexOf("msie")>-1)));self.isRenderingEngine.MIDP=(ua.indexOf("midp-")>-1);self.RenderingEngineVersion=(function(){try{if(self.isRenderingEngine.WebKit){self.RenderingEngine='WebKit';if(/WebKit\//i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.split("WebKit/")[1])||undefined;}}
if(self.isRenderingEngine.Gecko){self.RenderingEngine='Gecko';if(/Gecko\//i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.split("Gecko/")[1])||undefined;}}
if(self.isRenderingEngine.Presto){self.RenderingEngine='Presto';if(/Presto\//i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.split("Presto/")[1])||undefined;}}
if(self.isRenderingEngine.Trident){self.RenderingEngine='Trident';if(/Trident\//i.test(navigator.userAgent)){if(!(ua.indexOf("trident/")>-1)){return 1;}else{return parseFloat(navigator.userAgent.split("Trident/")[1])||undefined;}}}
if(self.isRenderingEngine.MIDP){self.RenderingEngine='MIDP';if(/MIDP\-/i.test(navigator.userAgent)){return parseFloat(navigator.userAgent.split("MIDP-")[1])||undefined;}}}catch(e){}
return undefined;})();self.iOS={};self.iOS.Version=null;self.iOS.SubVerions=null;self.iOS.Revision=null;if(self.isOS.iOS){if(/OS \d_\d(_\d)? like Mac OS X/i.test(navigator.userAgent)){var match=/OS \d_\d_?\d? like Mac OS X/i.exec(navigator.userAgent)[0];var sversion=/\d_\d_?\d?/i.exec(match)[0];var aversion=sversion.replace(/_/g,'.').split('.');self.iOS.Version=parseFloat(aversion[0]);self.iOS.SubVerions=parseFloat(aversion[1]);self.iOS.Revision=parseFloat(aversion[2]);}else if(/CPU like Mac OS X/i.test(navigator.userAgent)){self.iOS.Version=1;self.iOS.SubVerions=0;self.iOS.Revision=0;}}
self.PositionFixed=(function(){var ret=false;if(navigator.userAgent.match(/iPad|iPhone|iPod/i)!==null){ret=navigator.userAgent.match(/[5-9]_[0-9]/)!==null;}else if(navigator.userAgent.toLowerCase().indexOf("blackberry")>-1){ret=(navigator.userAgent.toLowerCase().indexOf("webkit")>-1);}else{var test=document.createElement('div'),control=test.cloneNode(false),fake=false,root=document.body||(function(){fake=true;return document.documentElement.appendChild(document.createElement('body'));}());var oldCssText=root.style.cssText;root.style.cssText='padding:0;margin:0';test.style.cssText='position:fixed;top:42px';root.appendChild(test);root.appendChild(control);ret=test.offsetTop!==control.offsetTop;root.removeChild(test);root.removeChild(control);root.style.cssText=oldCssText;if(fake){document.documentElement.removeChild(root);}}
return ret;})();self.PushState=(function(){if(self.Browser=="AndroidBrowser"&&self.BrowserVersion>=3){return false;}
return(typeof window.history.pushState=='function');})();self.InputFile=(function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return false;}
var el=document.createElement("input");el.type="file";return!el.disabled;})();self.downgraded=(self.OS=="Blackberry"&&self.OSVersion<6)||(self.OS=="Android"&&self.OSVersion<4);self.isIE8=(self.Browser=="InternetExplorer"&&self.BrowserVersion<=8);return self;})();function isOnline(){if(navigator.onLine!=null&&(device.OS!='Android'||device.OSVersion>=4)){return navigator.onLine;}
return true;}
var $_GET={};document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function decode(s){return decodeURIComponent(s.split("+").join(" "));}
$_GET[decode(arguments[1])]=decode(arguments[2]);});function refreshGET(){$_GET={};document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function decode(s){return decodeURIComponent(s.split("+").join(" "));}
$_GET[decode(arguments[1])]=decode(arguments[2]);});return $_GET;}
function updateGET(url){$_GET={};var obj=parseUrl(url);obj.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g,function(){function decode(s){return decodeURIComponent(s.split("+").join(" "));}
$_GET[decode(arguments[1])]=decode(arguments[2]);});}
function getHash(){var anchor="";if(location.href.indexOf("#")!=-1){anchor=location.href.substr(location.href.indexOf("#"));}
anchor=anchor.replace("#","");return anchor;}
function setHash(title){window.location.hash=title;}
jQuery.fn.exists=function(){return jQuery(this).length>0;};jQuery.fn.isChildOf=function(b){return(this.parents(b).length>0);};jQuery.fn.id=function(){return jQuery(this).attr('id');};if(typeof String.prototype.capitalize=="undefined"){String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+ this.slice(1);}}
if(typeof String.prototype.startswith=="undefined"){String.prototype.startswith=function(needle){return(this.substr(0,needle.length)==needle);}}
if(typeof String.prototype.rtrim=="undefined"){String.prototype.rtrim=function(){return this.replace(/\s+$/,'');}}
if(typeof String.prototype.killWhiteSpace=="undefined"){String.prototype.killWhiteSpace=function(){return this.replace(/\s/g,'');};}
if(typeof String.prototype.reduceWhiteSpace=="undefined"){String.prototype.reduceWhiteSpace=function(){return this.replace(/\s+/g,' ');};}
if(typeof Array.prototype.remove=="undefined"){Array.prototype.remove=function(e){var t,_ref;if((t=this.indexOf(e))>-1){return([].splice.apply(this,[t,t- t+ 1].concat(_ref=[])),_ref);}
return this;};}
if(typeof Array.prototype.contains=="undefined"){Array.prototype.contains=function(obj){var i=this.length;while(i--){if(this[i]===obj){return true;}}
return false;}}
if(typeof Number.prototype.isEven=="undefined"){Number.prototype.isEven=function(){return(this%2==0);};}
function parseUrl(url){var a=document.createElement('a');a.href=url;return a;}
function oc(a){var o={};for(var i=0;i<a.length;i++)
{o[a[i]]='';}
return o;}
function checkFileExists(url){var result=false;var online=isOnline();if(online==true){if(!device.downgraded){$.ajax({url:url,async:false,error:function(){result=false;},success:function(){result=true;}});}else{var xmlhttp=new XMLHttpRequest();xmlhttp.open("GET",url,false);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){result=true;}else if(xmlhttp.readyState==4&&xmlhttp.status==400){result=false;}};xmlhttp.send();}}else{result=false;}
return result;}
function checkImageAvailable(url){var online=isOnline();if(online==true){return checkFileExists(url);}else{return true;}}
function getFileSize(inputFile){var files=inputFile.files;if(!files){try{return-1;}catch(ex){return-1;}}else if(files.length>0){return files[0].size;}
return 0;}
function isValidXML(xml){try{if(xml!=null){if(typeof xml=='string'&&xml!=''){return true;}else return typeof xml=='object';}else{return false;}}catch(err){return false;}}
function isValidJSON(json){try{if(json!=null){if(typeof json=='string'&&json!=''){var object=$.parseJSON(json);return(object!=null);}else if(typeof json=='object'){return(json!=null);}else{return false;}}else{return false;}}catch(err){return false;}}
function formatPhoneNumber(number){var re=/\D/;var re2=/^\({1}\d{3}\) \d{3}-\d{4}/;var newNum=number;if((number!="")&&(re2.test(number)!=true)){while(re.test(number)){number=number.replace(re,"");}
if(number.length==10){newNum='('+ number.substring(0,3)+') '+ number.substring(3,6)+'-'+ number.substring(6,10);}else if(number.length>10){}}
return newNum;}
function formatURL(url){if(url.indexOf("http://")!=0&&url.indexOf("https://")!=0){url="http://"+ url;}
return url;}
function validateNumericValue(n){return!isNaN(parseFloat(n))&&isFinite(n);}
function validateEmailAddress(email){if(email!=null){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\._\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);}
return false;}
function validatePhoneNumber(number){if(number!=null){number=number.replace(/[^0-9]/g,"");if(number.length==10){return true;}else if(number.length>10){return true;}}
return false;}
function validateVideoURL(url){var video='';if(url!=null&&url!=""){var parts=parseUrl(url);if((parts.host=="www.youtube.com"||parts.host=="youtube.com")&&parts.search!=""){var v=getURLParam(parts.search,"v");if(v!=null&&v!=""){video=v;}
var video_id=getURLParam(parts.search,"video_id");if(video_id!=null&&video_id!=""){video=video_id;}}else if(url.startswith('http://youtu.be/')){video=url.substring(16);}else if(url.startswith('http://vimeo.com/')){video=url.substring(17);}else if(parts.host==""){video=url;}}
return video;}
function validateVideoType(url){var type=null;if(url!=null&&url!=""){var parts=parseUrl(url);if((parts.host=="www.youtube.com"||parts.host=="youtube.com")&&parts.search!=""){var v=getURLParam(parts.search,"v");if(v!=null&&v!=""){type='youtube';}
var video_id=getURLParam(parts.search,"video_id");if(video_id!=null&&video_id!=""){type='youtube';}}else if(url.startswith('http://youtu.be/')){type='youtube';}else if(url.startswith('http://vimeo.com/')){type='vimeo';}else if(parts.host==""){type=null;}}
return type;}
function buildVideoURLFromID(id,type){var url='';if(type=='youtube'){url='http://youtu.be/'+id;}
if(type=='vimeo'){url='http://vimeo.com/'+id;}
return url;}
function getURLParam(url,gkey){var returned=null;if(url.indexOf("?")!=-1){var list=url.split("?")[1].split("&"),gets=[];for(var ind in list){if(list.hasOwnProperty(ind)){if(validateNumericValue(ind)){var kv=list[ind].split("=");if(kv.length>0)
gets[kv[0]]=kv[1];}}}
returned=gets;if(typeof gkey!="undefined")
if(typeof gets[gkey]!="undefined")
returned=gets[gkey];}
return returned;}
function parseUrl(url){if($.type(url)==="object"){return url;}
var matches=urlParseRE.exec(url||"")||[];return{href:matches[0]||"",hrefNoHash:matches[1]||"",hrefNoSearch:matches[2]||"",domain:matches[3]||"",protocol:matches[4]||"",doubleSlash:matches[5]||"",authority:matches[6]||"",username:matches[8]||"",password:matches[9]||"",host:matches[10]||"",hostname:matches[11]||"",port:matches[12]||"",pathname:matches[13]||"",directory:matches[14]||"",filename:matches[15]||"",search:matches[16]||"",hash:matches[17]||""};}
var urlParseRE=/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/;var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());//Persist=function(){var a="0.1.0",b,c,d,e,f,g;g=function(){var a="Thu, 01-Jan-1970 00:00:01 GMT",b=1e3*60*60*24,c=["expires","path","domain"],d=escape,e=unescape,f=document,g;var h=function(){var a=new Date;a.setTime(a.getTime());return a};var j=function(a,b){var e,f,g,h=[],i=arguments.length>2?arguments[2]:{};h.push(d(a)+"="+d(b));for(e=0;e<c.length;e++){f=c[e];if(g=i[f])h.push(f+"="+g)}if(i.secure)h.push("secure");return h.join("; ")};var k=function(){var a="__EC_TEST__",b=new Date;b=b.toGMTString();this.set(a,b);this.enabled=this.remove(a)==b;return this.enabled};g={set:function(a,c){var d=arguments.length>2?arguments[2]:{},e=h(),g,k={};if(d.expires){d.expires*=b;k.expires=new Date(e.getTime()+d.expires);k.expires=k.expires.toGMTString()}var l=["path","domain","secure"];for(i=0;i<l.length;i++)if(d[l[i]])k[l[i]]=d[l[i]];var m=j(a,c,k);f.cookie=m;return c},has:function(a){a=d(a);var b=f.cookie,c=b.indexOf(a+"="),e=c+a.length+1,g=b.substring(0,a.length);return!c&&a!=g||c<0?false:true},get:function(a){a=d(a);var b=f.cookie,c=b.indexOf(a+"="),g=c+a.length+1,h=b.substring(0,a.length),i;if(!c&&a!=h||c<0)return null;i=b.indexOf(";",g);if(i<0)i=b.length;return e(b.substring(g,i))},remove:function(b){var c=g.get(b),d={expires:a};f.cookie=j(b,"",d);return c},keys:function(){var a=f.cookie,b=a.split("; "),c,d,g=[];for(c=0;c<b.length;c++){d=b[c].split("=");g.push(e(d[0]))}return g},all:function(){var a=f.cookie,b=a.split("; "),c,d,g=[];for(c=0;c<b.length;c++){d=b[c].split("=");g.push([e(d[0]),e(d[1])])}return g},version:"0.2.1",enabled:false};g.enabled=k.call(g);return g}();f=function(){};d=function(a){return a.replace(/_/g,"__").replace(/ /g,"_s")};unesc=function(a){return a.replace(/__/g,"_").replace(/_s/g," ")};C={search_order:["localstorage","cookie"],name_re:/^[a-z][a-z0-9_ -]+$/i,methods:["init","get","set","remove","load","save","getall"],sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k = ?",set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k = ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:true}}};c={gears:{size:-1,test:function(){return window.google&&window.google.gears?true:false},methods:{transaction:function(a){var b=this.db;b.execute("BEGIN").close();a.call(this,b);b.execute("COMMIT").close()},init:function(){var a;a=this.db=google.gears.factory.create("beta.database");a.open(d(this.name));a.execute(C.sql.create).close()},get:function(a,b,c){var d,e=C.sql.get;if(!b)return;this.transaction(function(f){d=f.execute(e,[a]);if(d.isValidRow())b.call(c||this,true,d.field(0));else b.call(c||this,false,null);d.close()})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set,g;this.transaction(function(g){g.execute(e,[a]).close();g.execute(f,[a,b]).close();if(c)c.call(d||this,true,b)})},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove,r,val;this.transaction(function(e){if(b){r=e.execute(d,[a]);if(r.isValidRow()){val=r.field(0);e.execute(sql,[a]).close();b.call(c||this,true,val)}else{b.call(c||this,false,null)}r.close()}else{e.execute(sql,[a]).close()}})}}},whatwg_db:{size:200*1024,test:function(){var a="PersistJS Test",b="Persistent database test.";if(!window.openDatabase)return false;if(!window.openDatabase(a,C.sql.version,b,c.whatwg_db.size))return false;return true},methods:{transaction:function(a){if(!this.db_created){var b=C.sql.create;this.db.transaction(function(a){a.executeSql(b,[],function(){this.db_created=true})},f)}this.db.transaction(a)},init:function(){var a,b;a=this.o.about||"Persistent storage for "+this.name;b=this.o.size||c.whatwg_db.size;this.db=openDatabase(this.name,C.sql.version,a,b)},get:function(a,b,c){var d=C.sql.get;if(!b)return;c=c||this;this.transaction(function(e){e.executeSql(d,[a],function(a,d){if(d.rows.length>0)b.call(c,true,d.rows.item(0)["v"]);else b.call(c,false,null)})})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.executeSql(e,[a],function(){g.executeSql(f,[a,b],function(a,e){if(c)c.call(d||this,true,b)})})});return b},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove;this.transaction(function(e){if(b){e.executeSql(d,[a],function(d,e){if(e.rows.length>0){var f=e.rows.item(0)["v"];d.executeSql(sql,[a],function(a,d){b.call(c||this,true,f)})}else{b.call(c||this,false,null)}})}else{e.executeSql(sql,[a])}})}}},globalstorage:{size:5*1024*1024,test:function(){return window.globalStorage?true:false},methods:{key:function(a){return d(this.name)+"-"+d(a)},init:function(){this.store=globalStorage[this.o.domain]},get:function(a,b,c){a=this.key(a);if(b)b.call(c||this,true,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store[a];this.store.removeItem(a);if(b)b.call(c||this,d!==null,d)}}},localstorage:{size:-1,test:function(){return window.localStorage?true:false},methods:{key:function(a){return d(this.name)+"-"+d(a)},unkey:function(a){var b=a.indexOf(d(this.name)+"-")+(d(this.name)+"-").length;var c=a.substring(b);return unesc(c)},init:function(){this.store=localStorage},get:function(a,b,c){a=this.key(a);if(b)b.call(c||this,true,this.store.getItem(a))},getall:function(){var a={};for(var b=0;b<localStorage.length;b++){var c=this.unkey(localStorage.key(b));var d=localStorage.getItem(localStorage.key(b));a[c]=d}return a},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store.getItem(a);this.store.removeItem(a);if(b)b.call(c||this,d!==null,d)}}},ie:{prefix:"_persist_data-",size:64*1024,test:function(){return window.ActiveXObject?true:false},make_userdata:function(a){var b=document.createElement("div");b.id=a;b.style.display="none";b.addBehavior("#default#userData");document.body.appendChild(b);return b},methods:{init:function(){var a=c.ie.prefix+d(this.name);this.el=c.ie.make_userdata(a);if(this.o.defer)this.load()},get:function(a,b,c){var e;a=d(a);if(!this.o.defer)this.load();e=this.el.getAttribute(a);if(b)b.call(c||this,e?true:false,e)},set:function(a,b,c,e){a=d(a);this.el.setAttribute(a,b);if(!this.o.defer)this.save();if(c)c.call(e||this,true,b)},load:function(){this.el.load(d(this.name))},save:function(){this.el.save(d(this.name))}}},cookie:{delim:"-",size:4e3,test:function(){return b.Cookie.enabled?true:false},methods:{key:function(a){return this.name+c.cookie.delim+a},subkey:function(a){var b=a.indexOf(this.name+c.cookie.delim)+(this.name+c.cookie.delim).length;var d=a.substring(b);return d},get:function(a,b,c){a=this.key(a);var d=g.get(a);if(b)b.call(c||this,d!=null,d)},getall:function(){var a=document.cookie.split(";");var b={};for(var c=0;c<a.length;c++){var d=a[c].split("=");b[this.subkey(d[0])]=unescape(d[1])}return b},set:function(a,b,c,d){a=this.key(a);g.set(a,b,this.o);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=g.remove(a);if(b)b.call(c||this,d!=null,d)}}},flash:{test:function(){if(!window.SWFObject||!deconcept||!deconcept.SWFObjectUtil)return false;var a=deconcept.SWFObjectUtil.getPlayerVersion().major;return a>=8?true:false},methods:{init:function(){if(!c.flash.el){var a,b,d,e=C.flash;d=document.createElement("div");d.id=e.div_id;document.body.appendChild(d);a=new SWFObject(this.o.swf_path||e.path,e.id,e.size.w,e.size.h,"8");for(b in e.args)a.addVariable(b,e.args[b]);a.write(d);c.flash.el=document.getElementById(e.id)}this.el=c.flash.el},get:function(a,b,c){var e;a=d(a);e=this.el.get(this.name,a);if(b)b.call(c||this,e!==null,e)},set:function(a,b,c,e){var f;a=d(a);f=this.el.set(this.name,a,b);if(c)c.call(e||this,true,b)},remove:function(a,b,c){var e;a=d(a);e=this.el.remove(this.name,a);if(b)b.call(c||this,true,e)}}}};var e=function(){var a,d,e,g,h=C.methods,i=C.search_order;for(a=0,d=h.length;a<d;a++)b.Store.prototype[h[a]]=f;b.type=null;b.size=-1;for(a=0,d=i.length;!b.type&&a<d;a++){e=c[i[a]];if(e.test()){b.type=i[a];b.size=e.size;for(g in e.methods)b.Store.prototype[g]=e.methods[g]}}if(b.type!=null){b.Store.prototype["getFor"]=function(a){var b=null;this.get(a,function(c,d){if(c){if(typeof d=="string"){if(d.rtrim()!=""){b=d.rtrim()}else{b=null;this.remove(a)}}else{b=null;this.remove(a)}}else{b=null}});return b}}else{b.Store.prototype["getFor"]=function(a){return null};b.Store.prototype["get"]=function(a,b){return null};b.Store.prototype["set"]=function(a,b){return null};b.Store.prototype["getall"]=function(a,b){return null};b.Store.prototype["remove"]=function(a){return null}}b._init=true};if(typeof String.prototype.rtrim=="undefined"){String.prototype.rtrim=function(){return this.replace(/\s+$/,"")}}b={VERSION:a,type:null,size:0,add:function(a){c[a.id]=a;C.search_order=[a.id].concat(C.search_order);e()},remove:function(a){var b=C.search_order.indexOf(a);if(b<0)return;C.search_order.splice(b,1);delete c[a];e()},Cookie:g,Store:function(a,b){if(!C.name_re.exec(a))throw new Error("Invalid name");b=b||{};this.name=a;b.domain=b.domain||location.hostname||"localhost.localdomain";this.o=b;b.expires=b.expires||365*2;b.path=b.path||"/";this.init()}};e();return b}();
Persist=function(){var a="0.1.0",b,c,d,e,f,g;g=function(){var a="Thu, 01-Jan-1970 00:00:01 GMT",b=1e3*60*60*24,c=["expires","path","domain"],d=escape,e=unescape,f=document,g;var h=function(){var a=new Date;a.setTime(a.getTime());return a};var j=function(a,b){var e,f,g,h=[],i=arguments.length>2?arguments[2]:{};h.push(d(a)+"="+ d(b));for(e=0;e<c.length;e++){f=c[e];if(g=i[f])h.push(f+"="+ g)}
if(i.secure)h.push("secure");return h.join("; ")};var k=function(){var a="__EC_TEST__",b=new Date;b=b.toGMTString();this.set(a,b);this.enabled=this.remove(a)==b;return this.enabled};g={set:function(a,c){var d=arguments.length>2?arguments[2]:{},e=h(),g,k={};if(d.expires){d.expires*=b;k.expires=new Date(e.getTime()+ d.expires);k.expires=k.expires.toGMTString()}
var l=["path","domain","secure"];for(i=0;i<l.length;i++)if(d[l[i]])k[l[i]]=d[l[i]];f.cookie=j(a,c,k);return c},has:function(a){a=d(a);var b=f.cookie,c=b.indexOf(a+"="),e=c+ a.length+ 1,g=b.substring(0,a.length);return(!c&&a!=g||c<0);},get:function(a){a=d(a);var b=f.cookie,c=b.indexOf(a+"="),g=c+ a.length+ 1,h=b.substring(0,a.length),i;if(!c&&a!=h||c<0)return null;i=b.indexOf(";",g);if(i<0)i=b.length;return e(b.substring(g,i))},remove:function(b){var c=g.get(b),d={expires:a};f.cookie=j(b,"",d);return c},keys:function(){var a=f.cookie,b=a.split("; "),c,d,g=[];for(c=0;c<b.length;c++){d=b[c].split("=");g.push(e(d[0]))}
return g},all:function(){var a=f.cookie,b=a.split("; "),c,d,g=[];for(c=0;c<b.length;c++){d=b[c].split("=");g.push([e(d[0]),e(d[1])])}
return g},version:"0.2.1",enabled:false};g.enabled=k.call(g);return g}();f=function(){};d=function(a){return a.replace(/_/g,"__").replace(/ /g,"_s")};unesc=function(a){return a.replace(/__/g,"_").replace(/_s/g," ")};C={search_order:['localstorage','globalstorage','cookie'],name_re:/^[a-z][a-z0-9_ -]+$/i,methods:["init","get","set","remove","load","save","getall"],sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k = ?",set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k = ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:true}}};c={localstorage:{size:-1,test:function(){try{localStorage.setItem("storage","");localStorage.removeItem("storage");return true;}catch(err){return false;}},methods:{key:function(a){return d(this.name)+"-"+ d(a)},unkey:function(a){var b=a.indexOf(d(this.name)+"-")+(d(this.name)+"-").length;var c=a.substring(b);return unesc(c)},init:function(){this.store=localStorage},get:function(a,b,c){a=this.key(a);if(b)b.call(c||this,true,this.store.getItem(a))},getall:function(){var a={};for(var b=0;b<localStorage.length;b++){var c=this.unkey(localStorage.key(b));a[c]=localStorage.getItem(localStorage.key(b));}
return a},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store.getItem(a);this.store.removeItem(a);if(b)b.call(c||this,d!==null,d)}}},globalstorage:{size:5*1024*1024,test:function(){return window.globalStorage?true:false},methods:{key:function(a){return d(this.name)+"-"+ d(a)},init:function(){this.store=globalStorage[this.o.domain]},get:function(a,b,c){a=this.key(a);if(b)b.call(c||this,true,this.store.getItem(a))},set:function(a,b,c,d){a=this.key(a);this.store.setItem(a,b);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=this.store[a];this.store.removeItem(a);if(b)b.call(c||this,d!==null,d)}}},cookie:{delim:"-",size:4e3,test:function(){return b.Cookie.enabled?true:false},methods:{key:function(a){return this.name+ c.cookie.delim+ a},subkey:function(a){var b=a.indexOf(this.name+ c.cookie.delim)+(this.name+ c.cookie.delim).length;return a.substring(b);},get:function(a,b,c){a=this.key(a);var d=g.get(a);if(b)b.call(c||this,d!=null,d)},getall:function(){var a=document.cookie.split(";");var b={};for(var c=0;c<a.length;c++){var d=a[c].split("=");b[this.subkey(d[0])]=unescape(d[1])}
return b},set:function(a,b,c,d){a=this.key(a);g.set(a,b,this.o);if(c)c.call(d||this,true,b)},remove:function(a,b,c){var d;a=this.key(a);d=g.remove(a);if(b)b.call(c||this,d!=null,d)}}},gears:{size:-1,test:function(){return window.google&&window.google.gears?true:false},methods:{transaction:function(a){var b=this.db;b.execute("BEGIN").close();a.call(this,b);b.execute("COMMIT").close()},init:function(){var a;a=this.db=google.gears.factory.create("beta.database");a.open(d(this.name));a.execute(C.sql.create).close()},get:function(a,b,c){var d,e=C.sql.get;if(!b)return;this.transaction(function(f){d=f.execute(e,[a]);if(d.isValidRow())b.call(c||this,true,d.field(0));else b.call(c||this,false,null);d.close()})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set,g;this.transaction(function(g){g.execute(e,[a]).close();g.execute(f,[a,b]).close();if(c)c.call(d||this,true,b)})},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove,r,val;this.transaction(function(e){if(b){r=e.execute(d,[a]);if(r.isValidRow()){val=r.field(0);e.execute(sql,[a]).close();b.call(c||this,true,val)}else{b.call(c||this,false,null)}
r.close()}else{e.execute(sql,[a]).close()}})}}},ie:{prefix:"_persist_data-",size:64*1024,test:function(){return window.ActiveXObject?true:false},make_userdata:function(a){var b=document.createElement("div");b.id=a;b.style.display="none";b.addBehavior("#default#userData");document.body.appendChild(b);return b},methods:{init:function(){var a=c.ie.prefix+ d(this.name);this.el=c.ie.make_userdata(a);if(this.o.defer)this.load()},get:function(a,b,c){var e;a=d(a);if(!this.o.defer)this.load();e=this.el.getAttribute(a);if(b)b.call(c||this,e?true:false,e)},set:function(a,b,c,e){a=d(a);this.el.setAttribute(a,b);if(!this.o.defer)this.save();if(c)c.call(e||this,true,b)},load:function(){this.el.load(d(this.name))},save:function(){this.el.save(d(this.name))}}},whatwg_db:{size:200*1024,test:function(){var a="PersistJS Test",b="Persistent database test.";if(!window.openDatabase)return false;return!(!window.openDatabase(a,C.sql.version,b,c.whatwg_db.size));},methods:{transaction:function(a){if(!this.db_created){var b=C.sql.create;this.db.transaction(function(a){a.executeSql(b,[],function(){this.db_created=true})},f)}
this.db.transaction(a)},init:function(){var a,b;a=this.o.about||"Persistent storage for "+ this.name;b=this.o.size||c.whatwg_db.size;this.db=openDatabase(this.name,C.sql.version,a,b)},get:function(a,b,c){var d=C.sql.get;if(!b)return;c=c||this;this.transaction(function(e){e.executeSql(d,[a],function(a,d){if(d.rows.length>0)b.call(c,true,d.rows.item(0)["v"]);else b.call(c,false,null)})})},set:function(a,b,c,d){var e=C.sql.remove,f=C.sql.set;this.transaction(function(g){g.executeSql(e,[a],function(){g.executeSql(f,[a,b],function(a,e){if(c)c.call(d||this,true,b)})})});return b},remove:function(a,b,c){var d=C.sql.get;sql=C.sql.remove;this.transaction(function(e){if(b){e.executeSql(d,[a],function(d,e){if(e.rows.length>0){var f=e.rows.item(0)["v"];d.executeSql(sql,[a],function(a,d){b.call(c||this,true,f)})}else{b.call(c||this,false,null)}})}else{e.executeSql(sql,[a])}})}}},flash:{test:function(){if(!window.SWFObject||!deconcept||!deconcept.SWFObjectUtil)return false;var a=deconcept.SWFObjectUtil.getPlayerVersion().major;return(a>=8);},methods:{init:function(){if(!c.flash.el){var a,b,d,e=C.flash;d=document.createElement("div");d.id=e.div_id;document.body.appendChild(d);a=new SWFObject(this.o.swf_path||e.path,e.id,e.size.w,e.size.h,"8");for(b in e.args){if(e.args.hasOwnProperty(b)){a.addVariable(b,e.args[b]);}}
a.write(d);c.flash.el=document.getElementById(e.id)}
this.el=c.flash.el},get:function(a,b,c){var e;a=d(a);e=this.el.get(this.name,a);if(b)b.call(c||this,e!==null,e)},set:function(a,b,c,e){var f;a=d(a);f=this.el.set(this.name,a,b);if(c)c.call(e||this,true,b)},remove:function(a,b,c){var e;a=d(a);e=this.el.remove(this.name,a);if(b)b.call(c||this,true,e)}}}};var e=function(){var a,d,e,g,h=C.methods,i=C.search_order;for(a=0,d=h.length;a<d;a++)b.Store.prototype[h[a]]=f;b.type=null;b.size=-1;for(a=0,d=i.length;!b.type&&a<d;a++){e=c[i[a]];if(e.test()){b.type=i[a];b.size=e.size;for(g in e.methods){if(e.methods.hasOwnProperty(g)){b.Store.prototype[g]=e.methods[g]}}}}
if(b.type!=null){b.Store.prototype["getFor"]=function(a){var b=null;this.get(a,function(c,d){if(c){if(typeof d=="string"){if(d.rtrim()!=""){b=d.rtrim()}else{b=null;this.remove(a)}}else{b=null;this.remove(a)}}else{b=null}});return b}}
else{b.Store.prototype["getFor"]=function(a){return null};b.Store.prototype["get"]=function(a,b){return null};b.Store.prototype["set"]=function(a,b){return null};b.Store.prototype["getall"]=function(a,b){return null};b.Store.prototype["remove"]=function(a){return null}}
b._init=true};if(typeof String.prototype.rtrim=="undefined"){String.prototype.rtrim=function(){return this.replace(/\s+$/,"")}}
b={VERSION:a,type:null,size:0,add:function(a){c[a.id]=a;C.search_order=[a.id].concat(C.search_order);e()},remove:function(a){var b=C.search_order.indexOf(a);if(b<0)return;C.search_order.splice(b,1);delete c[a];e()},Cookie:g,Store:function(a,b){if(!C.name_re.exec(a))throw new Error("Invalid name");b=b||{};this.name=a;b.domain=b.domain||location.hostname||"localhost.localdomain";this.o=b;b.expires=b.expires||365*2;b.path=b.path||"/";this.init()}};e();return b}();(function($){$.confirm=function(params){if($('#confirmOverlay').length){setTimeout(function(){$.confirm(params);},1000);return false;}
var buttonHTML='';var cnt=0;$.each(params.buttons,function(name,obj){cnt++;buttonHTML+='<a href="#" class="button '+obj['class']+'">'+name+'</a>';if(!obj.action){obj.action=function(){};}});buttonHTML=(buttonHTML!='')?'<div id="confirmButtons">'+buttonHTML+'</div>':'';var maxWidth=(params.maxWidth&&!isMobile())?params.maxWidth:'499px';var markup=['<div id="confirmOverlay" onclick="$.confirm.hide();">','<div id="confirmBox" style="max-width: '+maxWidth+';">','<h1 onclick="$.confirm.hide();">',params.title,'<span class="icon_menu close"></span></h1>','<div class="contents">'+params.message+'</div>',buttonHTML,'</div>','</div>'].join('');$(document.body).removeClass('menu');$(document.body).addClass('popup');$(markup).appendTo('body');if(device.downgraded){$('.body').hide();$('.main.menu').hide();}
if($(document.body).hasClass('mobile')==false){var minHeight=$(document.body).height();if(device.PositionFixed){$('#confirmOverlay').css('min-height','');}else{$('#confirmOverlay').css('min-height',minHeight+'px');}}
var buttons=$('#confirmButtons .button'),i=0;$.each(params.buttons,function(name,obj){buttons.eq(i++).click(function(){if(obj.action()!=false){$.confirm.hide();}
return false;});});$('#confirmBox').click(function(evt){evt.stopPropagation();});if(params.callbackfunction&&typeof(params.callbackfunction)=="function"){params.callbackfunction();}
if(isMobile()&&!device.PositionFixed){scrollToTop();}
adjustTextSize();};$.confirm.hide=function(){$('#confirmOverlay').remove();$(document.body).removeClass('popup');$('.body').show();$('.main.menu').show();adjustFrameSize();adjustTextSize();rewireIframe('body');};$.confirm.hideOnly=function(popup){$(popup).remove();if($('#confirmOverlay').exists()==false){$(document.body).removeClass('popup');$('.body').show();$('.main.menu').show();adjustFrameSize();adjustTextSize();rewireIframe('body');}};})(jQuery);(function($){$.error=function(params){if($('#errorOverlay').length){setTimeout(function(){$.error(params);},2000);return false;}
var buttonHTML='';var cnt=0;$.each(params.buttons,function(name,obj){cnt++;buttonHTML+='<a href="#" class="button '+obj['class']+'">'+name+'</a>';if(!obj.action){obj.action=function(){};}});buttonHTML=(buttonHTML!='')?'<div id="errorButtons">'+buttonHTML+'</div>':'';var maxWidth=(params.maxWidth&&!isMobile())?params.maxWidth:'499px';var markup=['<div id="errorOverlay" onclick="$.confirm.hide();">','<div id="errorBox" style="max-width: '+maxWidth+';">','<h1 onclick="$.error.hide();">',params.title,'<span class="icon_menu close"></span></h1>','<div class="contents">'+params.message+'</div>',buttonHTML,'</div>','</div>'].join('');$(markup).appendTo('body');if(device.downgraded){$('.body').hide();$('.main.menu').hide();}
if($(document.body).hasClass('mobile')==false){var minHeight=$(document.body).height();if(device.PositionFixed){$('#errorOverlay').css('min-height','');}else{$('#errorOverlay').css('min-height',minHeight+'px');}}
var buttons=$('#errorButtons .button'),i=0;$.each(params.buttons,function(name,obj){buttons.eq(i++).click(function(){if(obj.action()!=false){$.error.hide();}
return false;});});$('#errorBox').click(function(evt){evt.stopPropagation();});if(params.callbackfunction&&typeof(params.callbackfunction)=="function"){params.callbackfunction();}
if(isMobile()&&!device.PositionFixed){scrollToTop();}
adjustTextSize();};$.error.hide=function(){$('#errorOverlay').remove();adjustFrameSize();adjustTextSize();rewireIframe('body');};})(jQuery);(function(t,e){if(typeof exports=="object")module.exports=e();else if(typeof define=="function"&&define.amd)define(e);else t.Spinner=e()})(this,function(){"use strict";var t=["webkit","Moz","ms","O"],e={},i;function o(t,e){var i=document.createElement(t||"div"),o;for(o in e)i[o]=e[o];return i}function n(t){for(var e=1,i=arguments.length;e<i;e++)t.appendChild(arguments[e]);return t}var r=function(){var t=o("style",{type:"text/css"});n(document.getElementsByTagName("head")[0],t);return t.sheet||t.styleSheet}();function s(t,o,n,s){var a=["opacity",o,~~(t*100),n,s].join("-"),f=.01+n/s*100,l=Math.max(1-(1-t)/o*(100-f),t),d=i.substring(0,i.indexOf("Animation")).toLowerCase(),u=d&&"-"+d+"-"||"";if(!e[a]){r.insertRule("@"+u+"keyframes "+a+"{"+"0%{opacity:"+l+"}"+f+"%{opacity:"+t+"}"+(f+.01)+"%{opacity:1}"+(f+o)%100+"%{opacity:"+t+"}"+"100%{opacity:"+l+"}"+"}",r.cssRules.length);e[a]=1}return a}function a(e,i){var o=e.style,n,r;if(o[i]!==undefined)return i;i=i.charAt(0).toUpperCase()+i.slice(1);for(r=0;r<t.length;r++){n=t[r]+i;if(o[n]!==undefined)return n}}function f(t,e){for(var i in e)t.style[a(t,i)||i]=e[i];return t}function l(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)if(t[o]===undefined)t[o]=i[o]}return t}function d(t){var e={x:t.offsetLeft,y:t.offsetTop};while(t=t.offsetParent)e.x+=t.offsetLeft,e.y+=t.offsetTop;return e}var u={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};function p(t){if(typeof this=="undefined")return new p(t);this.opts=l(t||{},p.defaults,u)}p.defaults={};l(p.prototype,{spin:function(t){this.stop();var e=this,n=e.opts,r=e.el=f(o(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex}),s=n.radius+n.length+n.width,a,l;if(t){t.insertBefore(r,t.firstChild||null);l=d(t);a=d(r);f(r,{left:(n.left=="auto"?l.x-a.x+(t.offsetWidth>>1):parseInt(n.left,10)+s)+"px",top:(n.top=="auto"?l.y-a.y+(t.offsetHeight>>1):parseInt(n.top,10)+s)+"px"})}r.setAttribute("role","progressbar");e.lines(r,e.opts);if(!i){var u=0,p=(n.lines-1)*(1-n.direction)/2,c,h=n.fps,m=h/n.speed,y=(1-n.opacity)/(m*n.trail/100),g=m/n.lines;(function v(){u++;for(var t=0;t<n.lines;t++){c=Math.max(1-(u+(n.lines-t)*g)%m*y,n.opacity);e.opacity(r,t*n.direction+p,c,n)}e.timeout=e.el&&setTimeout(v,~~(1e3/h))})()}return e},stop:function(){var t=this.el;if(t){clearTimeout(this.timeout);if(t.parentNode)t.parentNode.removeChild(t);this.el=undefined}return this},lines:function(t,e){var r=0,a=(e.lines-1)*(1-e.direction)/2,l;function d(t,i){return f(o(),{position:"absolute",width:e.length+e.width+"px",height:e.width+"px",background:t,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/e.lines*r+e.rotate)+"deg) translate("+e.radius+"px"+",0)",borderRadius:(e.corners*e.width>>1)+"px"})}for(;r<e.lines;r++){l=f(o(),{position:"absolute",top:1+~(e.width/2)+"px",transform:e.hwaccel?"translate3d(0,0,0)":"",opacity:e.opacity,animation:i&&s(e.opacity,e.trail,a+r*e.direction,e.lines)+" "+1/e.speed+"s linear infinite"});if(e.shadow)n(l,f(d("#000","0 0 4px "+"#000"),{top:2+"px"}));n(t,n(l,d(e.color,"0 0 1px rgba(0,0,0,.1)")))}return t},opacity:function(t,e,i){if(e<t.childNodes.length)t.childNodes[e].style.opacity=i}});function c(){function t(t,e){return o("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',e)}r.addRule(".spin-vml","behavior:url(#default#VML)");p.prototype.lines=function(e,i){var o=i.length+i.width,r=2*o;function s(){return f(t("group",{coordsize:r+" "+r,coordorigin:-o+" "+-o}),{width:r,height:r})}var a=-(i.width+i.length)*2+"px",l=f(s(),{position:"absolute",top:a,left:a}),d;function u(e,r,a){n(l,n(f(s(),{rotation:360/i.lines*e+"deg",left:~~r}),n(f(t("roundrect",{arcsize:i.corners}),{width:o,height:i.width,left:i.radius,top:-i.width>>1,filter:a}),t("fill",{color:i.color,opacity:i.opacity}),t("stroke",{opacity:0}))))}if(i.shadow)for(d=1;d<=i.lines;d++)u(d,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(d=1;d<=i.lines;d++)u(d);return n(e,l)};p.prototype.opacity=function(t,e,i,o){var n=t.firstChild;o=o.shadow&&o.lines||0;if(n&&e+o<n.childNodes.length){n=n.childNodes[e+o];n=n&&n.firstChild;n=n&&n.firstChild;if(n)n.opacity=i}}}var h=f(o("group"),{behavior:"url(#default#VML)"});if(!a(h,"transform")&&h.adj)c();else i=a(h,"animation");return p});
(function(e,t){var n=function(e,t,n){var r;return function(){function i(){if(!n)e.apply(s,arguments);r=null}var s=this;if(r)clearTimeout(r);else if(n)e.apply(s,arguments);r=setTimeout(i,t||100)}};jQuery.fn[t]=function(e){return e?this.bind("resize",n(e)):this.trigger(t)}})(jQuery,"smartresize");(function($){$.fn.textfill=function(options){$(this).css('width',"");var width=$(this).parent().width();var marginleft=parseInt($(this).css('margin-left'));var maxwidth=(width- marginleft)+"px";$(this).css('width',maxwidth);var defaults={maxFontPixels:40,innerTag:'span'};var Opts=jQuery.extend(defaults,options);return this.each(function(){var fontSize=Opts.maxFontPixels;var ourText=$(Opts.innerTag+':first',this);var maxHeight=$(this).height();var maxWidth=$(this).width();var textHeight;var textWidth;do{ourText.css('font-size',fontSize);textHeight=ourText.height();textWidth=ourText.width();fontSize=fontSize- 1;}while((textHeight>maxHeight||textWidth>maxWidth)&&fontSize>3);});};})(jQuery);if(!device.downgraded){var addToHomeConfig={autostart:false,startDelay:200,lifespan:240000,touchIcon:true,returningVisitor:false};var shortcutToHomeConfig={autostart:false,startDelay:200,lifespan:240000,touchIcon:true,returningVisitor:false};var addToHome=(function(w){var nav=w.navigator,isIDevice=true,isIPad,isRetina,isSafari,isStandalone,OSVersion,startX=0,startY=0,lastVisit=0,isExpired,isSessionActive,isReturningVisitor,balloon,ifrm,overlay,overrideChecks,positionInterval,closeTimeout,options={autostart:true,returningVisitor:false,animationIn:'drop',animationOut:'fade',startDelay:2000,lifespan:15000,bottomOffset:14,expire:0,message:'',touchIcon:false,arrow:true,hookOnLoad:true,iterations:100},intl={ca_es:'Per instal·lar aquesta aplicació al vostre %device premeu %icon i llavors <strong>Afegir a pantalla d\'inici</strong>.',cs_cz:'Pro instalaci aplikace na Váš %device, stiskněte %icon a v nabídce <strong>Přidat na plochu</strong>.',da_dk:'Tilføj denne side til din %device: tryk på %icon og derefter <strong>Føj til hjemmeskærm</strong>.',de_de:'Installieren Sie diese App auf Ihrem %device: %icon antippen und dann <strong>Zum Home-Bildschirm</strong>.',el_gr:'Εγκαταστήσετε αυτήν την Εφαρμογή στήν συσκευή σας %device: %icon μετά πατάτε <strong>Προσθήκη σε Αφετηρία</strong>.',en_us:'Install this web app on your %device: tap %icon and then<br /><strong>Add to Home Screen</strong>.',es_es:'Para instalar esta app en su %device, pulse %icon y seleccione <strong>Añadir a pantalla de inicio</strong>.',fi_fi:'Asenna tämä web-sovellus laitteeseesi %device: paina %icon ja sen jälkeen valitse <strong>Lisää Koti-valikkoon</strong>.',fr_fr:'Ajoutez cette application sur votre %device en cliquant sur %icon, puis <strong>Ajouter à l\'écran d\'accueil</strong>.',he_il:'<span dir="rtl">התקן אפליקציה זו על ה-%device שלך: הקש %icon ואז <strong>הוסף למסך הבית</strong>.</span>',hu_hu:'Telepítse ezt a web-alkalmazást az Ön %device-jára: nyomjon a %icon-ra majd a <strong>Főképernyőhöz adás</strong> gombra.',it_it:'Installa questa applicazione sul tuo %device: premi su %icon e poi <strong>Aggiungi a Home</strong>.',ja_jp:'このウェブアプリをあなたの%deviceにインストールするには%iconをタップして<strong>ホーム画面に追加</strong>を選んでください。',ko_kr:'%device에 웹앱을 설치하려면 %icon을 터치 후 "홈화면에 추가"를 선택하세요',nb_no:'Installer denne appen på din %device: trykk på %icon og deretter <strong>Legg til på Hjem-skjerm</strong>',nl_nl:'Installeer deze webapp op uw %device: tik %icon en dan <strong>Zet in beginscherm</strong>.',pl_pl:'Aby zainstalować tę aplikacje na %device: naciśnij %icon a następnie <strong>Dodaj jako ikonę</strong>.',pt_br:'Instale este web app em seu %device: aperte %icon e selecione <strong>Adicionar à Tela Inicio</strong>.',pt_pt:'Para instalar esta aplicação no seu %device, prima o %icon e depois o <strong>Adicionar ao ecrã principal</strong>.',ru_ru:'Установите это веб-приложение на ваш %device: нажмите %icon, затем <strong>Добавить в «Домой»</strong>.',sv_se:'Lägg till denna webbapplikation på din %device: tryck på %icon och därefter <strong>Lägg till på hemskärmen</strong>.',th_th:'ติดตั้งเว็บแอพฯ นี้บน %device ของคุณ: แตะ %icon และ <strong>เพิ่มที่หน้าจอโฮม</strong>',tr_tr:'%device için bu uygulamayı kurduktan sonra %icon simgesine dokunarak <strong>Ana Ekrana Ekle</strong>yin.',zh_cn:'您可以将此应用程式安装到您的 %device 上。请按 %icon 然后点选<strong>添加至主屏幕</strong>。',zh_tw:'您可以將此應用程式安裝到您的 %device 上。請按 %icon 然後點選<strong>加入主畫面螢幕</strong>。'};function init(){if(!isIDevice)return;var now=Date.now(),i;if(w.addToHomeConfig){for(i in w.addToHomeConfig){options[i]=w.addToHomeConfig[i];}}
if(!options.autostart)options.hookOnLoad=false;isIPad=(/ipad/gi).test(nav.platform);isRetina=w.devicePixelRatio&&w.devicePixelRatio>1;isSafari=nav.appVersion.match(/Safari/gi);isStandalone=false;OSVersion=nav.appVersion.match(/OS (\d+_\d+)/i);OSVersion=6;lastVisit=+w.localStorage.getItem('addToHome');isSessionActive=w.sessionStorage.getItem('addToHomeSession');isReturningVisitor=options.returningVisitor?lastVisit&&lastVisit+ 28*24*60*60*1000>now:true;if(!lastVisit)lastVisit=now;isExpired=isReturningVisitor&&lastVisit<=now;if(options.hookOnLoad)w.addEventListener('load',loaded,false);else if(!options.hookOnLoad&&options.autostart)loaded();}
function loaded(){w.removeEventListener('load',loaded,false);if(!isReturningVisitor)w.localStorage.setItem('addToHome',Date.now());else if(options.expire&&isExpired)w.localStorage.setItem('addToHome',Date.now()+ options.expire*60000);if(!overrideChecks&&(!isSafari||!isExpired||isSessionActive||isStandalone||!isReturningVisitor))return;var icons=options.touchIcon?document.querySelectorAll('head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]'):[],sizes,touchIcon='',closeButton,platform=nav.platform.split(' ')[0],language=nav.language.replace('-','_'),i,l;balloon=document.createElement('div');balloon.id='addToHomeScreen';balloon.style.cssText+='left:-9999px;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);position:'+(OSVersion<5?'absolute':'fixed');if(options.message in intl){language=options.message;options.message='';}
if(options.message===''){options.message=language in intl?intl[language]:intl['en_us'];}
if(icons.length){for(i=0,l=icons.length;i<l;i++){sizes=icons[i].getAttribute('sizes');if(sizes){if(isRetina&&sizes=='114x114'){touchIcon=icons[i].href;break;}}else{touchIcon=icons[i].href;}}
touchIcon='<span style="background-image:url('+ touchIcon+')" class="addToHomeTouchIcon"></span>';}
balloon.className=(isIPad?'addToHomeIpad':'addToHomeIphone')+(touchIcon?' addToHomeWide':'');balloon.innerHTML=touchIcon+
options.message.replace('%device',platform).replace('%icon',OSVersion>=4.2?'<span class="addToHomeShare"></span>':'<span class="addToHomePlus">+</span>')+
(options.arrow?'<span class="addToHomeArrow"></span>':'')+'<span class="addToHomeClose">\u00D7</span>';overlay=document.createElement('div');overlay.className='cubiq-overlay';overlay.appendChild(balloon);ifrm=document.createElement("iframe");ifrm.setAttribute("src","http://www.youtube.com/embed/9-nfXyreWH0?rel=0");ifrm.setAttribute("frameborder","0");ifrm.setAttribute("class","iframe");var width=300;var height=169;if(isIPad){width=500;height=282;ifrm.style.top="50%";ifrm.style.marginTop="-170px";ifrm.style.marginLeft="-250px";}
ifrm.setAttribute("width",width);ifrm.setAttribute("height",height);ifrm.style.width=width+"px";ifrm.style.height=height+"px";overlay.appendChild(ifrm);document.body.appendChild(overlay);closeButton=balloon.querySelector('.addToHomeClose');if(closeButton)closeButton.addEventListener('click',clicked,false);if(closeButton)overlay.addEventListener('click',clicked,false);setTimeout(show,options.startDelay);}
function show(){var duration,iPadXShift=160;if(isIPad){if(OSVersion<5){startY=w.scrollY;startX=w.scrollX;iPadXShift=208;}
balloon.style.top=startY+ options.bottomOffset+'px';balloon.style.left=startX+ iPadXShift- Math.round(balloon.offsetWidth/2)+'px';switch(options.animationIn){case'drop':duration='0.6s';balloon.style.webkitTransform='translate3d(0,'+-(w.scrollY+ options.bottomOffset+ balloon.offsetHeight)+'px,0)';break;case'bubble':duration='0.6s';balloon.style.opacity='0';balloon.style.webkitTransform='translate3d(0,'+(startY+ 50)+'px,0)';break;default:duration='1s';balloon.style.opacity='0';}}else{startY=w.innerHeight+ w.scrollY;if(OSVersion<5){startX=Math.round((w.innerWidth- balloon.offsetWidth)/ 2) + w.scrollX;
balloon.style.left=startX+'px';balloon.style.top=startY- balloon.offsetHeight- options.bottomOffset+'px';}else{balloon.style.left='50%';balloon.style.marginLeft=-Math.round(balloon.offsetWidth/2)+'px';balloon.style.bottom=options.bottomOffset+'px';}
switch(options.animationIn){case'drop':duration='1s';balloon.style.webkitTransform='translate3d(0,'+-(startY+ options.bottomOffset)+'px,0)';break;case'bubble':duration='0.6s';balloon.style.webkitTransform='translate3d(0,'+(balloon.offsetHeight+ options.bottomOffset+ 50)+'px,0)';break;default:duration='1s';balloon.style.opacity='0';}}
balloon.offsetHeight;balloon.style.webkitTransitionDuration=duration;balloon.style.opacity='1';balloon.style.webkitTransform='translate3d(0,0,0)';balloon.addEventListener('webkitTransitionEnd',transitionEnd,false);closeTimeout=setTimeout(close,options.lifespan);}
function manualShow(override){if(!isIDevice||balloon)return;overrideChecks=override;loaded();}
function close(){clearInterval(positionInterval);clearTimeout(closeTimeout);closeTimeout=null;var posY=0,posX=0,opacity='1',duration='0',closeButton=balloon.querySelector('.addToHomeClose');if(closeButton)closeButton.removeEventListener('click',close,false);if(OSVersion<5){posY=isIPad?w.scrollY- startY:w.scrollY+ w.innerHeight- startY;posX=isIPad?w.scrollX- startX:w.scrollX+ Math.round((w.innerWidth- balloon.offsetWidth)/2) - startX;
}
balloon.style.webkitTransitionProperty='-webkit-transform,opacity';overlay.style.webkitTransitionProperty='-webkit-transform,opacity';switch(options.animationOut){case'drop':if(isIPad){duration='0.4s';opacity='0';posY=posY+ 50;}else{duration='0.6s';posY=posY+ balloon.offsetHeight+ options.bottomOffset+ 50;}
break;case'bubble':if(isIPad){duration='0.8s';posY=posY- balloon.offsetHeight- options.bottomOffset- 50;}else{duration='0.4s';opacity='0';posY=posY- 50;}
break;default:duration='0.8s';opacity='0';}
balloon.addEventListener('webkitTransitionEnd',transitionEnd,false);balloon.style.opacity=opacity;overlay.style.opacity=opacity;balloon.style.webkitTransitionDuration=duration;overlay.style.webkitTransitionDuration=duration;balloon.style.webkitTransform='translate3d('+ posX+'px,'+ posY+'px,0)';overlay.style.webkitTransform='translate3d('+ posX+'px,'+ posY+'px,0)';}
function clicked(){w.sessionStorage.setItem('addToHomeSession','1');isSessionActive=true;close();}
function transitionEnd(){balloon.removeEventListener('webkitTransitionEnd',transitionEnd,false);balloon.style.webkitTransitionProperty='-webkit-transform';balloon.style.webkitTransitionDuration='0.2s';if(!closeTimeout){balloon.parentNode.removeChild(balloon);overlay.parentNode.removeChild(overlay);balloon=null;overlay=null;return;}
if(OSVersion<5&&closeTimeout)positionInterval=setInterval(setPosition,options.iterations);}
function setPosition(){var matrix=new WebKitCSSMatrix(w.getComputedStyle(balloon,null).webkitTransform),posY=isIPad?w.scrollY- startY:w.scrollY+ w.innerHeight- startY,posX=isIPad?w.scrollX- startX:w.scrollX+ Math.round((w.innerWidth- balloon.offsetWidth)/ 2) - startX;
if(posY==matrix.m42&&posX==matrix.m41)return;balloon.style.webkitTransform='translate3d('+ posX+'px,'+ posY+'px,0)';}
function reset(){isSessionActive=false;w.localStorage.removeItem('addToHome');w.sessionStorage.removeItem('addToHomeSession');}
init();return{show:manualShow,close:close,reset:reset};})(this);var shortcutToHome=(function(w){var ua=navigator.userAgent.toLowerCase();var nav=w.navigator,isAndroid=true,startX=0,startY=0,lastVisit=0,isExpired,isSessionActive,isReturningVisitor,balloon,ifrm,overlay,overrideChecks,positionInterval,closeTimeout,options={autostart:true,returningVisitor:false,animationIn:'drop',animationOut:'fade',startDelay:2000,lifespan:15000,bottomOffset:14,expire:0,message:'',touchIcon:false,arrow:true,hookOnLoad:true,iterations:100},intl={en_us:'Bookmark to your %device:<br /> Tap the Menu Button %icon on your Device, then <strong>Add/Bookmarks</strong>.'};function init(){if(!isAndroid)return;var now=Date.now(),i;if(w.shortcutToHomeConfig){for(i in w.shortcutToHomeConfig){options[i]=w.shortcutToHomeConfig[i];}}
if(!options.autostart)options.hookOnLoad=false;lastVisit=+w.localStorage.getItem('shortcutToHome');isSessionActive=w.sessionStorage.getItem('shortcutToHomeSession');isReturningVisitor=options.returningVisitor?lastVisit&&lastVisit+ 28*24*60*60*1000>now:true;if(!lastVisit)lastVisit=now;isExpired=isReturningVisitor&&lastVisit<=now;if(options.hookOnLoad)w.addEventListener('load',loaded,false);else if(!options.hookOnLoad&&options.autostart)loaded();}
function loaded(){w.removeEventListener('load',loaded,false);if(!isReturningVisitor)w.localStorage.setItem('shortcutToHome',Date.now());else if(options.expire&&isExpired)w.localStorage.setItem('shortcutToHome',Date.now()+ options.expire*60000);if(!overrideChecks&&(!isExpired||isSessionActive||!isReturningVisitor))return;var icons=options.touchIcon?document.querySelectorAll('head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]'):[],sizes,touchIcon='',closeButton,platform=nav.platform.split(' ')[0],language=nav.language.replace('-','_'),i,l;balloon=document.createElement('div');balloon.id='shortcutToHomeScreen';balloon.style.cssText+='left:-9999px;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);position: fixed';if(options.message in intl){language=options.message;options.message='';}
if(options.message===''){options.message=language in intl?intl[language]:intl['en_us'];}
if(icons.length){for(i=0,l=icons.length;i<l;i++){sizes=icons[i].getAttribute('sizes');if(sizes){}else{touchIcon=icons[i].href;}}
touchIcon='<span style="background-image:url('+ touchIcon+')" class="shortcutToHomeTouchIcon"></span>';}
balloon.className='shortcutToHomeScreen'+(touchIcon?' shortcutToHomeWide':'');balloon.innerHTML=touchIcon+
options.message.replace('%device','Android').replace('%icon','<span class="shortcutToHomeShare"></span>')+
(options.arrow?'<span class="shortcutToHomeArrow"></span>':'')+'<span class="shortcutToHomeClose">\u00D7</span>';overlay=document.createElement('div');overlay.className='cubiq-overlay';overlay.appendChild(balloon);ifrm=document.createElement("iframe");ifrm.setAttribute("src","http://www.youtube.com/embed/ZjIni6Fh4OM?rel=0");ifrm.setAttribute("frameborder","0");ifrm.setAttribute("class","iframe");var width=300;var height=169;if(window.innerWidth>=600&&window.innerHeight>=600){width=500;height=282;ifrm.style.top="50%";ifrm.style.marginTop="-170px";ifrm.style.marginLeft="-250px";}
ifrm.setAttribute("width",width);ifrm.setAttribute("height",height);ifrm.style.width=width+"px";ifrm.style.height=height+"px";overlay.appendChild(ifrm);document.body.appendChild(overlay);closeButton=balloon.querySelector('.shortcutToHomeClose');if(closeButton)closeButton.addEventListener('click',clicked,false);if(closeButton)overlay.addEventListener('click',clicked,false);setTimeout(show,options.startDelay);}
function show(){var duration,iPadXShift=160;startY=w.innerHeight+ w.scrollY;balloon.style.left='50%';balloon.style.marginLeft=-Math.round(balloon.offsetWidth/2)+'px';balloon.style.bottom=options.bottomOffset+'px';switch(options.animationIn){case'drop':duration='1s';balloon.style.webkitTransform='translate3d(0,'+-(startY+ options.bottomOffset)+'px,0)';break;case'bubble':duration='0.6s';balloon.style.webkitTransform='translate3d(0,'+(balloon.offsetHeight+ options.bottomOffset+ 50)+'px,0)';break;default:duration='1s';balloon.style.opacity='0';}
balloon.offsetHeight;balloon.style.webkitTransitionDuration=duration;balloon.style.opacity='1';balloon.style.webkitTransform='translate3d(0,0,0)';balloon.addEventListener('webkitTransitionEnd',transitionEnd,false);closeTimeout=setTimeout(close,options.lifespan);}
function manualShow(override){if(!isAndroid||balloon)return;overrideChecks=override;loaded();}
function close(){clearInterval(positionInterval);clearTimeout(closeTimeout);closeTimeout=null;var posY=0,posX=0,opacity='1',duration='0',closeButton=balloon.querySelector('.shortcutToHomeClose');if(closeButton)closeButton.removeEventListener('click',close,false);balloon.style.webkitTransitionProperty='-webkit-transform,opacity';overlay.style.webkitTransitionProperty='-webkit-transform,opacity';switch(options.animationOut){case'drop':duration='0.6s';posY=posY+ balloon.offsetHeight+ options.bottomOffset+ 50;break;case'bubble':duration='0.4s';opacity='0';posY=posY- 50;break;default:duration='0.8s';opacity='0';}
balloon.addEventListener('webkitTransitionEnd',transitionEnd,false);balloon.style.opacity=opacity;overlay.style.opacity=opacity;balloon.style.webkitTransitionDuration=duration;overlay.style.webkitTransitionDuration=duration;balloon.style.webkitTransform='translate3d('+ posX+'px,'+ posY+'px,0)';overlay.style.webkitTransform='translate3d('+ posX+'px,'+ posY+'px,0)';}
function clicked(){w.sessionStorage.setItem('shortcutToHomeSession','1');isSessionActive=true;close();}
function transitionEnd(){balloon.removeEventListener('webkitTransitionEnd',transitionEnd,false);balloon.style.webkitTransitionProperty='-webkit-transform';balloon.style.webkitTransitionDuration='0.2s';if(!closeTimeout){balloon.parentNode.removeChild(balloon);overlay.parentNode.removeChild(overlay);balloon=null;overlay=null;}}
function setPosition(){var matrix=new WebKitCSSMatrix(w.getComputedStyle(balloon,null).webkitTransform),posY=w.scrollY+ w.innerHeight- startY,posX=w.scrollX+ Math.round((w.innerWidth- balloon.offsetWidth)/ 2) - startX;
if(posY==matrix.m42&&posX==matrix.m41)return;balloon.style.webkitTransform='translate3d('+ posX+'px,'+ posY+'px,0)';}
function reset(){isSessionActive=false;w.localStorage.removeItem('shortcutToHome');w.sessionStorage.removeItem('shortcutToHomeSession');}
init();return{show:manualShow,close:close,reset:reset};})(this);}
var params=['cardid','parent','page','contact','info','infomenu','debug','key','pass','code','purchase','type','admenu'];if(Persist.type){var store=new Persist.Store('onecard');for(var i=0;i<params.length;i++){if((!device.iOSStandalone||device.OSVersion<6)&&params[i]!='infomenu'){store.remove('page-'+ params[i]);}
if(device.iOSStandalone&&device.OSVersion>=6){if(params[i]!='page'&&params[i]!='contact'&&params[i]!='info'&&params[i]!='infomenu'){store.remove('page-'+ params[i]);}}}}
else{var store=null;}
var onecard={};onecard.cardid=null;onecard.company=null;onecard.card=null;onecard.account=null;onecard.admin={};onecard.admin.isPortal=false;onecard.admin.loggedIn=false;onecard.admin.timer=null;onecard.admin.timerAlert=null;onecard.types={};onecard.types.numbers=new Array();onecard.types.addresses=new Array();onecard.types.sociallinks=new Array();onecard.types.infoicons=new Array();onecard.types.questions=new Array();onecard.firstime=false;onecard.spinner=null;onecard.previousPage=null;onecard.lastCardUpdate=null;onecard.updateReady=false;onecard.touchIcon=null;onecard.profilePicture=null;onecard.bannerImage=null;onecard.sorting=false;onecard.sortingParentKey='';onecard.sortingParentType='';onecard.dragSrcEl=null;if(window.location.hostname.indexOf("myonecard")>-1||window.location.hostname.indexOf("onecardme")>-1){var siteAddress=window.location.hostname;}else{var siteAddress='onecardme.com';}
if(siteAddress.indexOf('admin')!=-1||siteAddress.indexOf('ba.')!=-1||siteAddress.indexOf('ba2.')!=-1){onecard.admin.isPortal=true;}
function loadDebuging(){var message='';message+='<ul class="menu">';message+='<li>';message+='<span class="placeholder" style="display: none;" onclick="placeholderClick(this);">Server Address</span>';message+='<input id="server-address" type="text" name="server-address" value="192.168.1.100" />';message+='</li>';message+='</ul>';$.confirm({'title':"Server Address",'message':message,'buttons':{'Okay':{'class':'blue','action':function(){loadDebugingReal($('#server-address').val());}},'Cancel':{'class':'gray','action':function(){clearParam('debug');}}}});}
function loadDebugingReal(address){setParam('debug','true',true);var dbg=document.createElement('script');dbg.type='text/javascript';dbg.async=true;dbg.src='http://'+address+':8081/target/target-script-min.js#anonymous';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(dbg,s);$('.menu #debugging-notification').text('(Debugging)');}
function lookForCardIDRequest(){var cardid=null;cardIDInHash=function(){if((getHash()!=null)&&(getHash()!="")){var hash=getHash();if(hash.indexOf("html")!=-1){if(hash.indexOf("cardid=")!=-1){var id=hash.substr(hash.indexOf("cardid=")).replace("cardid=","").toLowerCase();if(id.indexOf("&")!=-1){id=id.substr(0,id.indexOf("&")).toLowerCase();}
if(!onecard.admin.isPortal){if(id.indexOf('/')!=-1){id=id.split('/')[1];}}
return id;}else{return null;}}else{return null;}}else{return null;}};cardIDInParams=function(){if($_GET['cardid']!=null&&$_GET['cardid'].rtrim()!=""){var id=$_GET['cardid'].rtrim().toLowerCase();if(!onecard.admin.isPortal){if(id.indexOf('/')!=-1){id=id.split('/')[1];}}
return id;}else{return null;}};cardIDInObject=function(){if(onecard.card!=null){return getCardID(onecard.card).toLowerCase();}else{return null;}};if(cardIDInHash()!=null){cardid=cardIDInHash();}else if(cardIDInParams()!=null){cardid=cardIDInParams();}else if(cardIDInObject()!=null){cardid=cardIDInObject();}
if(cardid!=null){if(onecard.card!=null){if(getCardID(onecard.card)!=cardid){onecard.card=null;}}else{onecard.card=null;}}else{onecard.card=null;}
return cardid;}
function lookForCompanyRequest(){var company=null;companyInHash=function(){if((getHash()!=null)&&(getHash()!="")){var hash=getHash();if(hash.indexOf("html")!=-1){if(hash.indexOf("cardid=")!=-1){var id=hash.substr(hash.indexOf("cardid=")).replace("cardid=","").toLowerCase();if(id.indexOf("&")!=-1){id=id.substr(0,id.indexOf("&")).toLowerCase();}
if(id.indexOf('/')!=-1){return id.split('/')[0];}else{return null;}}else{return null;}}else{return null;}}else{return null;}};companyInParams=function(){if($_GET['cardid']!=null&&$_GET['cardid'].rtrim()!=""){var id=$_GET['cardid'].rtrim().toLowerCase();if(id.indexOf('/')!=-1){return id.split('/')[0];}else{return null;}}else{return null;}};companyInObject=function(){if(onecard.card!=null){return getCompany(onecard.card).toLowerCase();}else{return null;}};if(companyInHash()!=null){company=companyInHash();}else if(companyInParams()!=null){company=companyInParams();}else if(companyInObject()!=null){company=companyInObject();}
return company;}
function loadCurrentCard(){if(onecard.cardid!=null&&onecard.cardid!=""){var shouldAsync=true;if(isOnline()==false){if(store&&Persist.type=='localstorage'){var request=onecard.cardid;if(onecard.company!=null){request=onecard.company+'/'+request;}
if(store.getFor(request)!=null){var tcard=JSON.parse(store.getFor(request));if(tcard!=null&&String(tcard.cardid).toLowerCase()==onecard.cardid&&(tcard.company==null||String(tcard.company.id).toLowerCase()==onecard.company)){onecard.card=tcard;BuildCardForApplication();return onecard.card;}}
store.remove(onecard.cardid);}
noConnectionError();return null;}
if(onecard.card!=null&&card.cardid.toLowerCase()==onecard.cardid&&(card.company==null||String(card.company.id).toLowerCase()==onecard.company)){return onecard.card;}
if(!device.downgraded){$.ajax({type:"POST",url:"http://"+ siteAddress+"/data/api.php",data:"type=get_Card&cardid="+ onecard.cardid+(onecard.company!=null?"&company="+onecard.company:""),dataType:"json",async:shouldAsync,cache:false,success:function(data){if(data==null||data==''){ajaxError();}
else if(data!=null&&String(data.cardid).toLowerCase()==onecard.cardid){onecard.card=data;if(store&&Persist.type=='localstorage'){var request=onecard.cardid;if(onecard.company!=null){request=onecard.company+'/'+request;}
var string=JSON.stringify(onecard.card);store.set(request,string);}}
else if(data.cardid=='invalid'&&onecard.company!=null){onecard.cardid=onecard.company;onecard.company=null;return loadCurrentCard();}
else{invalidCardID(onecard.cardid);onecard.card=null;}
BuildCardForApplication();},error:function(xhr,textStatus,errorThrown){onecard.card=null;ajaxError();BuildCardForApplication();}});}
if(device.downgraded){var url="http://"+ siteAddress+"/data/api.php";var xmlhttp=new XMLHttpRequest();xmlhttp.open("POST",url,shouldAsync);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");var params="type="+encodeURIComponent('get_Card')+"&cardid="+ encodeURIComponent(onecard.cardid);xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){if(xmlhttp.responseText!=null&&xmlhttp.responseText!=""){var data=JSON.parse(xmlhttp.responseText);if(xmlhttp.responseText==null||xmlhttp.responseText==''){ajaxError();}
else if(data!=null&&String(data.cardid).toLowerCase()==onecard.cardid){onecard.card=data;if(store&&Persist.type=='localstorage'){var request=onecard.cardid;if(onecard.company!=null){request=onecard.company+'/'+request;}
var string=JSON.stringify(onecard.card);store.set(request,string);}}
else if(data.cardid=='invalid'&&onecard.company!=null){onecard.cardid=onecard.company;onecard.company=null;return loadCurrentCard();}
else{invalidCardID(onecard.cardid);onecard.card=null;}
BuildCardForApplication();}else{onecard.card=null;ajaxError();BuildCardForApplication();}}};xmlhttp.send(params);}}else{onecard.cardid=null;onecard.company=null;onecard.card=null;}
return onecard.card;}
function getCardID(card){if(card!=null){return String(card.cardid).toLowerCase();}
else{return null;}}
function getCompany(card){if(card!=null&&card.company!=null){return String(card.company.id).toLowerCase();}
else{return null;}}
function getCardIDActual(card){if(card!=null){if(card.company!=null&&!onecard.admin.isPortal){return String(card.company.id).toLowerCase()+'/'+ String(card.cardid).toLowerCase();}
else{return String(card.cardid).toLowerCase();}}
else{return null;}}
function getDisplayCardID(card){if(card!=null){return String(card.cardid);}else{return null;}}
function getFullName(card){var name="";if(card!=null){if(card.name!=null){if(isCompanyCard(card)){name=card.name.company;}else{var first=card.name.first;var middle=card.name.middle;var last=card.name.last;if(first!=""){name+=first.capitalize();}
if(middle!=""){name+=' '+ middle.capitalize();}
if(last!=""){name+=' '+ last.capitalize();}}}}
return name;}
function isCompanyCard(card){if(card!=null){return(card.is_company=="1");}else{return null;}}
function isFreemium(card){if(card!=null){return(card.is_freemium=="1");}else{return null;}}
function isEmployeeCard(card){if(card!=null){return(card.company!=null);}else{return false;}}
var appCache=window.applicationCache;if(appCache!=null&&onecard.admin.isPortal==false&&!device.downgraded&&siteAddress.indexOf('preview.')==-1){function handleCacheEvent(e){switch(appCache.status){case appCache.DOWNLOADING:$('.menu #update-notification').text('(Updating)');break;case appCache.UPDATEREADY:if(window.applicationCache.status==window.applicationCache.UPDATEREADY){window.applicationCache.swapCache();console.log('Cache Updated');$('.header td.menu').each(function(){$(this).addClass('notify').attr('data-content','!');});$('.menu #update-notification').text('(Update Ready)');onecard.updateReady=true;}
break;case appCache.UNCACHED:case appCache.OBSOLETE:break;case appCache.IDLE:case appCache.CHECKING:default:if(onecard.updateReady==false){$('.menu #update-notification').text('');}
break;}}
function handleCacheError(){}
appCache.addEventListener('cached',function(e){},false);appCache.addEventListener('checking',handleCacheEvent,false);appCache.addEventListener('downloading',handleCacheEvent,false);appCache.addEventListener('error',handleCacheError,false);appCache.addEventListener('noupdate',handleCacheEvent,false);appCache.addEventListener('obsolete',handleCacheEvent,false);appCache.addEventListener('progress',handleCacheEvent,false);appCache.addEventListener('updateready',handleCacheEvent,false);setInterval(function(){try{appCache.update();}catch(err){}},3000);}
$.ajaxPrefilter(function(options,originalOptions,jqXHR){if(window.applicationCache!=null){if(window.applicationCache&&window.applicationCache.status!=window.applicationCache.UNCACHED&&window.applicationCache.status!=window.applicationCache.OBSOLETE){options.isLocal=true;}}});function displayError(title,msg,note){scrollToTop();title=((typeof(title)!='undefined')&&(title!=null))?title:"Message";note=((typeof(note)!='undefined')&&(note!=null))?note:"";var message=''+ msg+'';if(note!=""){message+='<br /><br /><i style="font-size: 13px;">'+ note+'</i>';}
$.error({'title':title,'message':'<p>'+message+'</p>','buttons':{'Okay':{'class':'gray','action':function(){}}}});}
function ajaxError(){displayError("Error","There has been an error communicating with the One Card™ Server. Please try your request again later.",'If the error persists please contact QRPro support directly by emailing <a href="mailto:support@qrpro.co">support@qrpro.co</a>');}
function noConnectionError(){displayError('No Connection',"Unable to establish a connection at this time.","Without an Active Internet Connection we will be unable to load the information you have requested.");}
function invalidCardID(cardid){$.error({'title':'Invalid Card ID','message':"<p>The Card ID <u>"+ cardid+"</u> is invalid or has been discontinued.<br /><br />You will be redirect to QRPro\'s website temporarily until the new Directory has been completed.</p>",'buttons':{'Okay':{'class':'gray','action':function(){window.location='http://onecardme.com/home/';}}}});}
function displayMessage(title,msg,note){scrollToTop();title=((typeof(title)!='undefined')&&(title!=null))?title:"Message";note=((typeof(note)!='undefined')&&(note!=null))?note:"";var message=''+ msg+'';if(note!=""){message+='<br /><br /><i style="font-size: 13px;">'+ note+'</i>';}
$.confirm({'title':title,'message':'<p>'+message+'</p>','buttons':{'Okay':{'class':'blue','action':function(){}}}});}
function scannerAppBrowser(){displayMessage("Notice",'<div style="margin: 0 10px;">For the best One Card™ experience we suggest leaving this app now and opening the One Card™ in the Safari.<br /><br />Most QRCode scanner apps include a button in the bottom toolbar to reopen the website in Safari.</div>','');}
function showPageLoadingMsg(){if(device.downgraded){return;}
if($('body > #loading').exists()){return;}
var html='<div id="loading"></div>';$(document.body).append(html);var opts={lines:9,length:9,width:6,radius:11,corners:1,rotate:22,direction:1,color:'#BDBDBD',speed:1,trail:50,shadow:true,hwaccel:true,className:'spinner',zIndex:7000,top:'auto',left:'auto'};var target=document.getElementById('loading');onecard.spinner=new Spinner(opts).spin(target);}
function hidePageLoadingMsg(){if(onecard.spinner!=null){onecard.spinner.stop();}
$('body > #loading').remove();}
function displayFirstTimeVisit(){var html=' \
	<div id="first-time" onclick="$(this).remove();$(document.body).removeClass(\'popup\');" >\
		<table><tbody><tr>\
			<td style="width: 51px;"></td>\
			<td style="height: 190px;"><div>\
				<a>Save</a>\
				<img src="images/first-time/save.png" style="position: absolute;top: 18px;width: 141px;height: 175px;margin-left: -120px;left: 50%;" />\
				<a class="button" id="save"></a>\
			</div></td>\
			<td style="height: 190px;"><div>\
				<a>Share</a>\
				<img src="images/first-time/share.png" style="position: absolute; top: 18px; width: 172px; height: 174px; margin-left: -100px; left: 50%;" />\
				<a class="button" id="share"></a>\
			</div></td>\
		</tr></tbody></table>\
		<div style="text-align: center;padding-top: 30px;">\
			<span style="color: white;font-size: 40px;font-style: italic;font-weight: bold;">'+getFullName(onecard.card)+'</span><br />\
			<img src="images/first-time/welcome.png" style="width: 280px;height: 84px;margin-top: 5px;" /><br />\
			<span style="color: white;font-size: 14px;display: inline-block;padding-top: 20px;">Tap anywhere to close.</span>\
		</div>\
		<br /><br />\
	</div>';$(document.body).append(html);$(document.body).addClass('popup');$('#first-time a.button').click(function(evt){evt.stopPropagation();$(document.body).removeClass('popup');$('#first-time').remove();if($(this).id()=='save'){showPopup('save');}
if($(this).id()=='share'){showPopup('share');}});}
function markEnvironment(){var didChange=false;if(device.PositionFixed&&!$(document.body).hasClass('positionfixed')){$(document.body).addClass('positionfixed');}
if(device.downgraded&&!$(document.body).hasClass('downgraded')){$(document.body).addClass('downgraded');}
$(document.body).removeClass('card');if(onecard.cardid!=null){$(document.body).addClass('card');}
if(device.Browser=="InternetExplorer"&&device.BrowserVersion<=8){var w=$(window).width();var h=$(window).height();}else{var w=window.innerWidth;var h=window.innerHeight;}
var page=getCurrentPageID();if(w<600||h<600){if(!isMobile()){didChange=true;$(document.body).removeClass('regular').removeClass('extended');$(document.body).addClass('mobile');collapseAllButFirst();$(document.body).removeClass('menu');if(page!="info"){$('.page .grid').removeClass('menu');}else{$('.page .grid').addClass('menu');}}}else{if(!$(document.body).hasClass('regular')){didChange=true;$(document.body).removeClass('mobile');$(document.body).addClass('regular');collapseAllButFirst();$(document.body).removeClass('menu');if(page!="info"||w>=h){$('.page .grid').removeClass('menu');}else if(page=="info"){$('.page .grid').addClass('menu');}}
if((w>=1025&&h>=769)||(w>=769&&h>=1025)){if(!$(document.body).hasClass('extended')){didChange=true;$(document.body).addClass('extended');}}else{if($(document.body).hasClass('extended')){didChange=true;$(document.body).removeClass('extended');}}}
var didRotate=false;if(w>=h&&$(document.body).hasClass('landscape')==false){didChange=true;didRotate=true;$(document.body).removeClass('portrait').addClass('landscape');$(document.body).removeClass('menu');$('.page .grid').removeClass('menu');}else if(w<h&&$(document.body).hasClass('portrait')==false){didChange=true;didRotate=true;$(document.body).removeClass('landscape').addClass('portrait');$(document.body).removeClass('menu');if(page=="info"){$('.page .grid').addClass('menu');}else{$('.page .grid').removeClass('menu');}}
if(didChange){adjustFrameSize();adjustTextSize();rewireIframe('body');}
return didChange;}
function isMobile(){return $(document.body).hasClass('mobile');}
function getParam(key){if(store){if(store.getFor('page-'+ key)!=null){return store.getFor('page-'+ key);}else{store.remove('page-'+ key);}}
if($_GET[key]!=null){if($_GET[key].rtrim()!=""){return $_GET[key].rtrim();}}
if((getHash()!=null)&&(getHash()!="")){var val=null;var hash=getHash();if(hash.indexOf("html")!=-1){if(hash.indexOf(key+"=")!=-1){val=hash.substr(hash.indexOf(key+"=")).replace(key+"=","");if(val.indexOf("&")!=-1){val=val.substr(0,val.indexOf("&"));}}else{return null;}}else{return null;}
return val;}
return null;}
function setParam(key,val,updateAddress){if(store){store.set('page-'+ key,val);if(updateAddress){updateBrowserAddressForPage(getCurrentPageID()+'.html',true);}}}
function clearParam(key){if(store){store.remove('page-'+ key);}
$_GET[key]=null;var hash=getHash();if((getHash()!=null)&&(getHash()!="")){if(hash.indexOf(key)!=-1){var part1=hash.substring(0,hash.indexOf("&"+ key));var part2=hash.substring(hash.indexOf("&"+ key)+ 1);var part3=(part2.indexOf('&')!=-1)?part2.substring(part2.indexOf('&')):"";hash=part1+ part3;setHash(hash);}}
updateBrowserAddressForPage(getCurrentPageID()+'.html',true);}
function buildURL(page,local){var url='';for(var i=0;i<params.length;i++){switch(params[i]){case'cardid':var cParam=onecard.cardid;if(cParam!=null&&(page!='card.html'&&page!='account.html')){url+=(url!='')?'&'+params[i]+'=':params[i]+'=';if(onecard.company!=null){url+=onecard.company+'/'+cParam;}else{url+=cParam;}}
break;case'debug':var cParam=getParam(params[i]);if(cParam!=null){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'contact':var cParam=getParam(params[i]);if(cParam!=null&&page=="index.html"){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'infomenu':case'info':var cParam=getParam(params[i]);if(cParam!=null&&page=="info.html"){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'key':case'pass':var cParam=getParam(params[i]);if(cParam!=null&&page=="create.html"){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'code':var cParam=getParam(params[i]);if(cParam!=null&&page=="shortcode.html"){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'purchase':case'type':var cParam=getParam(params[i]);if(cParam!=null&&(page=="login.html"||page=="account.html"||page=="card.html"||page=="new.html")){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'admenu':var cParam=getParam(params[i]);if(cParam!=null&&!isMobile()&&onecard.admin.loggedIn&&page!="account.html"){url+=(url!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;default:break;}}
if(url!=''){url=page+'?'+ url;}else{url=page;}
if(local!=true){url='http://'+ siteAddress+'/'+ url;}
return url;}
function buildHash(page){var newHash='';for(var i=0;i<params.length;i++){switch(params[i]){case'cardid':var cParam=onecard.cardid;if(cParam!=null&&(page!='card.html'&&page!='account.html')){newHash+=(newHash!='')?'&'+params[i]+'=':params[i]+'=';if(onecard.company!=null){newHash+=onecard.company+'/'+cParam;}else{newHash+=cParam;}}
break;case'debug':break;case'contact':var cParam=getParam(params[i]);if(cParam!=null&&page=="index.html"){newHash+=(newHash!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'infomenu':case'info':var cParam=getParam(params[i]);if(cParam!=null&&page=="info.html"){newHash+=(newHash!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'key':case'pass':var cParam=getParam(params[i]);if(cParam!=null&&page=="create.html"){newHash+=(newHash!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'code':var cParam=getParam(params[i]);if(cParam!=null&&page=="shortcode.html"){newHash+=(newHash!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'purchase':case'type':var cParam=getParam(params[i]);if(cParam!=null&&(page=="login.html"||page=="account.html"||page=="card.html"||page=="new.html")){newHash+=(newHash!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;case'admenu':var cParam=getParam(params[i]);if(cParam!=null&&!isMobile()&&onecard.admin.loggedIn&&page!="account.html"){newHash+=(newHash!='')?'&'+ params[i]+'='+ cParam:params[i]+'='+ cParam;}
break;default:break;}}
if(newHash!=''){newHash='#/'+ page+'?'+ newHash;}else{newHash='#/'+ page;}
return newHash;}
function buildBaseURIForPage(page){return'http://'+ siteAddress+'/'+ page;}
function buildCleanURL(cardid){return'http://OneCardMe.com/'+ cardid;}
function buildShortUrl(){var cardid=getCardIDActual(onecard.card);var page='c';switch(getCurrentPageID()){case'index':page='c';break;case'social':page='s';break;case'bio':page='a';break;case'info':page='i';break;default:page='c';break;}
var tab=page=='c'?getParam('contact'):(page=='i'?getParam('info'):null);var url='http://1crd.me/'+cardid+'/'+page+'/';url+=tab?tab:'';return url;}
function updateBrowserAddressForPage(fileName,replace){var url=buildURL(fileName,true);var hash=buildHash(fileName);var initialHref;if(onecard.previousPage!=null){initialHref=buildBaseURIForPage(onecard.previousPage);onecard.previousPage=null;}else{initialHref=buildBaseURIForPage(fileName);}
if(device.PushState){var state={hash:hash,title:document.title,initialHref:initialHref,page:fileName};if(replace==false){history.pushState(state,document.title,url);}else{history.replaceState(state,document.title,url);}
updateGET(url);}else{setHash(hash);}}
$(window).on('popstate',function(e){if(e.originalEvent.state!=null){showPageLoadingMsg();scrollToTop();onecard.previousPage=getCurrentPageID()+'.html';updateBrowserAddressForPage(e.originalEvent.state.page,true);if(onecard.card==null){onecard.cardid=lookForCardIDRequest();if(onecard.cardid!=null){loadCurrentCard();}else{window.location='http://onecardme.com/home/';return;}}
loadCurrentPage();rewireIframe('body');console.log(e.originalEvent.state);}});function changePage(fileName){showPageLoadingMsg();collapseAllMenus('');scrollToTop();if(device.downgraded||!device.PushState){var url=buildURL(fileName,true);if(window.location.href!=('http://'+siteAddress+'/'+url)){window.location.href=url;}}else{onecard.previousPage=getCurrentPageID()+'.html';updateBrowserAddressForPage(fileName,false);setTimeout(function(){loadCurrentPage();$('.banner_image img.img, .banner_banner img.img').each(function(){resizeImage(this,0,0);});},0);}
setParam('page',fileName,false);}
function loadCurrentPage(){var url=document.URL;updateGET(url);var pageID=getCurrentPageID();var page=getCurrentPage(pageID);if($('.wrapper').exists()){$(document.body).attr('page',pageID);}
clearUIElements();loadUIElements(page);adjustFrameSize();adjustTextSize();rewireIframe('body');resetFaddingTitleBar();scrollToTop();hidePageLoadingMsg();}
function reloadCurrentPage(){showPageLoadingMsg();if(device.downgraded||!device.PushState){window.location.href=buildURL(getCurrentPageID+'.html',true);}else{loadCurrentPage();}}
$(window).smartresize(function(){if(!markEnvironment()){adjustFrameSize();adjustTextSize();rewireIframe('body');}});setInterval(function(){markEnvironment();},5000);function clearUIElements(){$('#admin-wrapper').remove();$('.grid').removeClass('no-nav');$.confirm.hide();collapseAllMenus('');$(document.body).attr('accent','');$('.video-frame iframe').each(function(){$(this).attr('src',"");});$('.header #name').children().remove();$('.header .username #username').html('');$('.page .banner .banner_name div span').html('');$('.page .grid .grid_title .title .name').html('');$('.page .grid .grid_nav_scroller').children().remove();$('.page .grid .grid_content_scroller').children().remove();if(onecard.admin.isPortal){$('.page .banner .banner_image .image .img').replaceWith('<img class="img" />');$('.page .banner .banner_banner .image .img').replaceWith('<img class="img" />');$('.banner_icon img.img').attr('src','');$('.adminmenu #steps').html('');$('.adminmenu').find('.upgradeButton').remove();$('.adminmenu .cardid #cardid').html('');$('.adminmenu .url #url').html('');$('.adminmenu .renewaldate #renewaldate').html('');$('.adminmenu input#directory').prop('checked',false);$('input#directory').off('change');$('.adminmenu #icon-preview').attr('src','');$('.adminmenu .accent-color #accent-color').removeClass();$('.adminmenu .accent-color #accent-color span').each(function(){$(this).html('');$(this).off('click');});$('.adminmenu #qrcode').attr('src','');}}
function collapseAllMenus(but){if(but!='menu'){$(document.body).removeClass('menu');}
if(isMobile()||but=="details"||but=="settings"||but=="tutorials"){if(but!='details'){$(document.body).removeClass('details');}
if(but!='settings'){$(document.body).removeClass('settings');}
if(but!='tutorials'){$(document.body).removeClass('tutorials');}}
if(but!='grid'&&getCurrentPageID()!='info'){$('.page .grid').removeClass('menu');}
if(but=='grid'&&$('.body').id()=='info'){clearParam('info');if(onecard.admin.isPortal){loadTutorials('info');}}}
function getCurrentPageID(){var page=null;pageInHash=function(){if((getHash()!=null)&&(getHash()!="")){var hash=getHash();if(hash.indexOf("html")!=-1){if(hash.indexOf("/")!=-1){return hash.substring(hash.indexOf("/")+1,hash.indexOf(".html")).toLowerCase();}else{return null;}}else{return null;}}else{return null;}};pageInURL=function(){var urlPath=window.location.pathname;var start=urlPath.substring(urlPath.indexOf('/')+ 1,urlPath.indexOf('.'));if(start=="/"){start="index";}
return start;};if(pageInHash()!=null){page=pageInHash();}else if(pageInURL()!=null){page=pageInURL();}
if(page==null){page="index"}
return page;}
function getCurrentPage(pageID){var page=null;if($('#'+pageID+'.body').exists()){page=$('#'+pageID+'.body');}else{page=$('.body');$(page).attr('id',pageID);}
return page;}
function loadAccentColor(){if(onecard.card!=null&&onecard.card.accent!=null&&onecard.card.accent!=''){$(document.body).attr('accent',onecard.card.accent);}}
function loadTheme(){if(onecard.card!=null&&onecard.card.theme!=null){if(onecard.card.theme.name!="default"){if($('head').children('#theme').exists()==false){}}else{removeTheme();}}else{removeTheme();}}
function removeTheme(){$('head').children('#theme').remove();}
function adjustFrameSize(){var minHeight;if(onecard.admin.isPortal==false){minHeight=(device.isIE8)?$(window).height():window.innerHeight;if(isMobile()&&(device.Browser=="MobileSafari")){minHeight=(window.orientation==0)?window.screen.availHeight:window.screen.availWidth;}}else{if(device.Browser=="MobileSafari"&&isMobile()==true){$('.wrapper').css('height','').css('min-height',((window.orientation==0)?window.screen.availHeight:window.screen.availWidth)+'px');}else if($(document.body).hasClass('extended')==true){$('.wrapper').css('height','').css('min-height','');}else if($(document.body).hasClass('regular')==true){$('.wrapper').css('height',($(window).height()-41)+'px').css('min-height','');}else{$('.wrapper').css('height','').css('min-height','');}
minHeight=(device.Browser=="MobileSafari"&&isMobile())?((window.orientation==0)?window.screen.availHeight:window.screen.availWidth):((device.isIE8)?$(window).height():window.innerHeight);}
$('body .main.menu').css('min-height',(isMobile()?minHeight+'px':''));$('body div#details').css('min-height',(isMobile()?(minHeight)+'px':''));$('body div#settings').css('min-height',(isMobile()?(minHeight)+'px':''));$('body div#tutorials').css('min-height',(isMobile()?(minHeight)+'px':''));if(onecard.admin.isPortal&&isMobile()==false){minHeight=$('.body').height();}
if($('.body > .header').is(':visible')){minHeight-=42;}
if($('.admin-menu').exists()){minHeight-=40;}
if($('.body > .footer').is(':visible')){if(onecard.admin.isPortal==false){minHeight=minHeight-((isMobile())?($(document.body).hasClass('portrait')?54:30):0);}else{minHeight-=54;}}
minHeight-=1;if(isMobile()||onecard.admin.isPortal){$('.page').css('min-height',minHeight+'px');$('.page').css('height','auto');$('div.grid').css('min-height',(minHeight-(($('.banner').is(':visible'))?$('.banner').height():0)));$('.grid_nav').css('height','');$('.grid_content').css('height','');$('.body > .header').css('width',$('.body').width()+'px');$('.body > .footer').css('width',$('.body').width()+'px');}else{$('.page').css('height',minHeight+'px');$('.page').css('min-height','0px');$('div.grid').css('min-height','0px');if(device.Browser=="InternetExplorer"){$('.grid_nav').css('height',($('.grid').height()- 38)+'px');$('.grid_content').css('height',($('.grid').height()- 38)+'px');}else{$('.grid_nav').css('height',($('.grid').height()- 38)+'px');$('.grid_content').css('height',($('.grid').height()- 38)+'px');}
$('.body > .header').css('width','');$('.body > .footer').css('width','');}
if(getCurrentPageID()=='bio'){if(isMobile()){collapseAllButFirst();}else{expandAllSections();}}
$('.banner_image img.img, .banner_banner img.img').each(function(){resizeImage(this,0,0);});if($(document.body).hasClass('mobile')==false){var minHeight=$(document.body).height();if(device.PositionFixed){$('#confirmOverlay').css('min-height','');$('#errorOverlay').css('min-height','');}else{$('#confirmOverlay').css('min-height',minHeight+'px');$('#errorOverlay').css('min-height',minHeight+'px');}}}
function adjustTextSize(){if(!device.downgraded&&!device.isIE8){var adjusts=$('.page').find('.adj');$(adjusts).each(function(){if($(this).children('span').text!=""){var size=parseInt($(this).children('span').css('font-size'));$(this).textfill({maxFontPixels:size,innerTag:'span'});}});}}
function adjustVideoFrameSize(){var adjusts=$('.video-frame');$(adjusts).each(function(){var width=$(this).width();var height=width*0.6;$(this).children('iframe').css('width',width+'px');$(this).children('iframe').css('height',height+'px');$(this).children('iframe').attr('width',width+'px');$(this).children('iframe').attr('height',height+'px');$(this).children('object').attr('width',width+'px');$(this).children('object').attr('height',height+'px');$(this).children('object').children('embed').attr('width',width+'px');$(this).children('object').children('embed').attr('height',height+'px');});}
function scrollToTop(){if(device.downgraded){return;}
$('.ms, .rs').each(function(){$(this).scrollTop(0);});}
function scrollToPos(y,elm){if(device.downgraded){return;}
if(isMobile()&&(device.Browser=="IEMobile"||device.Browser=="InternetExplorer")){var scroller=$('body,html');}else{var scroller=(isMobile())?$(elm).closest('.ms'):$(elm).closest('.rs');}
scroller.animate({scrollTop:y},200);}
function scrollToElm(elm){if(device.downgraded){return;}
$(elm).each(function(){if($(this).parents('.grid_nav').exists()){return;}
if(isMobile()){var wHeight=$(window).height();var pHeight=$('.body').outerHeight();var offSetTop=$(this).offset().top;}else{var parent=$(this).closest('.rs');var wHeight=$(parent).height()-((onecard.admin.isPortal)?0:39);var pHeight=0;if(getCurrentPageID()!='info'){$(parent).children().each(function(){pHeight+=$(this).height();});}else{pHeight+=$(this).height();}
if(onecard.admin.isPortal==false){var offSetTop=this.offsetTop- 5;}else{var offSetTop=($(this).position().top+ $('div.grid_content').position().top)+ $('table.banner').height();}}
var maxScroll=pHeight- wHeight;if(isMobile()&&device.PositionFixed==true){offSetTop-=(41+ 5);}
if(offSetTop>maxScroll){offSetTop=maxScroll;}
if(offSetTop<0){offSetTop=0;}
scrollToPos(offSetTop,this);});}
function changeTitles(text){$('body > .header .title #page').html(text);$('.header .title #name').html(text);}
function changePageTitle(text){$('.grid_title .title #name').text(text);}
function showAdminMenu(menu){collapseAllMenus(menu);if(!$(document.body).hasClass(menu)){$(document.body).addClass(menu);}
if(!isMobile()){if($(document.body).hasClass(menu)){setParam('admenu',menu,true);}else{clearParam('admenu');}}else{clearParam('admenu');}
rewireIframe('body');if(menu=='tutorials'){reloadShareWidgets();}}
function toggleGridMenu(){ alert('hi'); collapseAllMenus('grid');$('.page .grid').toggleClass('menu');if($('.body').id()=='info'){scrollToTop();resetFaddingTitleBar();}}
function closePopup(event){$.confirm.hide();adjustFrameSize();if(event!=null){if(event.preventDefault){event.preventDefault();event.stopPropagation();}
else{event.returnValue=false;}}}
function showPopup(name){var title=name.capitalize();var message="";if(name=="save"){title="Save to Device";message+='<ul class="menu">';var ipad=(navigator.userAgent.toLowerCase().match(/ipad/i)!==null);if(device.OS=="iOS"&&device.Browser=="MobileSafari"){message+='<li class="button iphone"><a onclick="showiOSAddToHomescreen();" data-role="button" data-theme="c" data-icon="apple">Save App to Homescreen<span class="icon_menu apple"></span></a></li>';if(device.BrowserVersion>="6"&&ipad==false){message+='<li class="button"><a href="http://'+ siteAddress+'/passbook/pass.php?cardid='+getCardIDActual(onecard.card)+'">Save to Passbook<span class="icon_menu apple"></span></a></li>';}}
if(device.OS=="Android"&&(device.Browser=='AndroidBrowser'||device.Browser=='MobileChrome')){message+='<li class="button"><a onclick="showAndroidShortcutToHomescreen();" data-role="button" data-theme="c" data-icon="android">Bookmark to Homescreen<span class="icon_menu android"></span></a></li>';}
if(device.OS=="WindowsPhone"){message+='<li class="button"><a onclick="showWindowsPhonePinToStart();" data-role="button" data-theme="c" data-icon="phone">Pin Tile Shortcut<span class="icon_menu windows"></span></a></li>';}
if(onecard.admin.isPortal==false){message+='<li class="title" style="padding: 5px 10px;">Save to Contacts</li>';message+='<input id="import-id" type="hidden" name="id" value="'+getCardIDActual(onecard.card)+'" />';message+='<input id="import-name" type="hidden" name="name" value="'+getFullName(onecard.card)+'" />';if((device.OS!="iOS"||device.OSVersion>=7)||window.location.hostname.indexOf("beta.")>-1){message+='<li class="button"><a href="http://'+ siteAddress+'/vcard/import.php?type=download&id='+ getCardIDActual(onecard.card)+'">Download<span class="icon_menu download"></span></a></li>';}
if((device.OS=="iOS"&&device.OSVersion<7)||window.location.hostname.indexOf("beta.")>-1){message+='<li class="button"><a target="_blank" href="http://'+ siteAddress+'/vcard/import.php?type=downloadIniCal&id='+ getCardIDActual(onecard.card)+'">Download *<span class="icon_menu download"></span></a></li>';message+='<li>';message+='<i style="font-size: 12px; color: #999;">* Some iPhones are unable to directly download a contact card. This will download the calendar event, then select the contact card to save it.</i>';message+='</li>';}
message+='<li style="padding: 4px 80px 4px 2px; position: relative;">';message+='<span class="placeholder" onclick="placeholderClick(this);" style="width: auto;">Email Address for Import</span>';message+='<input id="import-email" type="email" name="email" onkeydown="if(event.keyCode==13){sendImport();}" />';message+='<a onclick="sendImport();" class="send-button">Send</a>';message+='</li>';message+='<li class="error"></li>';}
message+='</ul>';}
if(name=="share"){message+='<ul class="menu">';message+='<li class="title" style="padding: 5px 10px;">Share by '+((onecard.card.is_freemium=='0')?'Text or':'')+' Email</li>';message+='<input id="share-id" type="hidden" name="id" value="'+getCardIDActual(onecard.card)+'" />';message+='<input id="share-name" type="hidden" name="name" value="'+getFullName(onecard.card)+'" />';message+='<li style="padding: 4px 2px 4px 50px; position: relative;">';message+='<div style="position: absolute; left: 8px; margin-top: 10px; color: #4E4E4E; font-weight: bold;">To:</div>';message+='<span class="placeholder" onclick="placeholderClick(this);" style="padding: 10px 3% 10px 60px; width: auto;">Recipients '+((onecard.card.is_freemium=='0')?'Number/':'')+'Email</span>';message+='<input id="share-number-email" type="text" name="number-email" onkeydown="if(event.keyCode==13){sendShare();}" />';message+='</li>';message+='<li style="padding: 4px 80px 4px 50px; position: relative;">';message+='<div style="position: absolute; left: 8px; margin-top: 10px; color: #4E4E4E; font-weight: bold;">From:</div>';message+='<span class="placeholder" onclick="placeholderClick(this);" style="padding: 10px 3% 10px 60px; width: auto;">Senders '+((onecard.card.is_freemium=='0')?'Name/':'')+'Email</span>';message+='<input id="share-name-email" type="text" name="name-email" onkeydown="if(event.keyCode==13){sendShare();}" />';message+='<a onclick="sendShare();" class="send-button">Send</a>';message+='</li>';message+='<li class="error"></li>';var shareUrl=buildShortUrl();message+='<li class="title" style="padding: 5px 10px;">Sharing by Social Network</li>';message+='<li>';message+='<table class="social-share-widgets"><tr>';message+='<td style="padding: 6px 0;">';message+='<a style="display: block;" href="https://twitter.com/intent/tweet?original_referer=http%3A%2F%2Fonecardme.com%2Findex.html%3Fcardid%3Djosh&text='+encodeURIComponent(getFullName(onecard.card)+' has a #DigitalBusinessCard\n')+'&tw_p=tweetbutton&url='+encodeURIComponent(document.URL)+'&via=OneCard" target="_blank"><span class="icon_social twitter" style="vertical-align: bottom;"></span></a>';message+='</td>';message+='<td style="padding: 6px 0;">';message+='<a style="display: block;" href="https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(shareUrl)+'" target="_blank"><span class="icon_social facebook" style="vertical-align: bottom;"></span></a>';message+='</td>';message+='<td style="padding: 6px 0;">';message+='<a style="display: block;" href="http://www.linkedin.com/shareArticle?mini=true&url='+encodeURIComponent(shareUrl)+'" target="_blank"><span class="icon_social linkedin" style="vertical-align: bottom;"></span></a>';message+='</td>';message+='<td style="padding: 6px 0;">';message+='<a style="display: block;" href="https://plusone.google.com/_/+1/confirm?hl=en&url='+encodeURIComponent('http://onecardme.com/index.html?cardid='+getCardIDActual(onecard.card))+'" target="_blank"><span class="icon_social googleplus" style="vertical-align: bottom;"></span></a>';message+='</td>';message+='</tr></table>';message+='</li>';message+='<li class="title" style="padding: 5px 10px;">Short URL for Sharing Page</li>';message+='<li><a href="'+buildShortUrl()+'" target="_blank" style="font-size: 16px;">'+buildShortUrl()+'</a></li>';message+='<li class="title" style="padding: 5px 10px;">Scan QRCode for Link</li>';var src='http://'+ siteAddress+'/qrcode/qrcode.php?path='+ encodeURIComponent(buildShortUrl());message+='<li style="padding: 3% 0;max-width: 100%;width: 100%;"><img class="share-qrcode" src="'+src+'" /></li>';message+='</ul>';}
if(name=="sendTo"){title='Send to Smartphone';message+='<ul class="menu">';message+='<li class="title" style="padding: 5px 10px;">Send Text/Email to Device</li>';message+='<input id="share-id" type="hidden" name="id" value="'+getCardIDActual(onecard.card)+'" />';message+='<input id="share-name" type="hidden" name="name" value="'+getFullName(onecard.card)+'" />';message+='<li style="padding: 4px 80px 4px 50px; position: relative;">';message+='<div style="position: absolute; left: 8px; margin-top: 10px; color: #4E4E4E; font-weight: bold;">To:</div>';message+='<span class="placeholder" onclick="placeholderClick(this);" style="padding: 10px 3% 10px 60px; width: auto;">Your Number or Email</span>';message+='<input id="share-number-email" type="text" name="number-email" onkeydown="if(event.keyCode==13){sendShare();}" />';message+='<a onclick="sendSendTo();" class="send-button">Send</a>';message+='</li>';message+='<li class="error"></li>';message+='<li class="title" style="padding: 5px 10px;">Visit Website on Device</li>';message+='<li><a href="http://OneCardMe.com/'+getCardIDActual(onecard.card)+'" target="_blank" style="font-size: 16px;">http://OneCardMe.com/<wbr />'+ getDisplayCardID(onecard.card)+'</a></li>';message+='<li class="title" style="padding: 5px 10px;">Or Scan QRCode</li>';var url='http://onecardme.com/'+ getCardIDActual(onecard.card);var src='http://'+ siteAddress+'/qrcode/qrcode.php?path='+ encodeURIComponent(url);message+='<li style="padding: 3% 0;max-width: 100%;width: 100%;"><img class="share-qrcode" src="'+src+'" /></li>';message+='</ul>';}
if(message!=""){$.confirm({'title':title,'message':message,'buttons':{}});adjustTextSize();rewireIframe('body');}}
function showiOSAddToHomescreen(){closePopup(null);if(device.Browser!="InternetExplorer"||device.BrowserVersion>=9.0){$('title').each(function(){$(this).html(getFullName(onecard.card));});}
addToHome.reset();addToHome.show();}
function showAndroidShortcutToHomescreen(){closePopup(null);shortcutToHome.reset();shortcutToHome.show();}
function showWindowsPhonePinToStart(){closePopup(null);if(device.OS=="WindowsPhone"||window.location.hostname.indexOf("beta.")>-1){var width=$(window).width();var height=$(window).height();var top=(height- 40);var html='';html+='<div id="wp-pin-to-start" class="wrapper" >';html+='<div class="wp-pin-to-start" style="width: '+width+'px; height: '+width+'px;">';html+='<img class="onecard-logo" src="http://'+ siteAddress+'/images/logos/one_card_logo_white_larger.png" />';if(onecard.admin.isPortal||onecard.card.images.profile==''){html+='<img class="app-icon" src="http://'+ siteAddress+'/images/appicons/admin.png" />';}else{var d=new Date();var src=(onecard.profilePicture!=null)?onecard.profilePicture:'http://'+ siteAddress+'/files/'+ getCardIDActual(onecard.card)+'/profile.png?t='+ d.getTime();onecard.profilePicture=src;html+='<img class="app-icon" src="'+src+'" />';}
if(onecard.admin.isPortal){html+='<div id="title" class="jtf"><span>Admin Portal</span></div>';}else{html+='<div id="title" class="jtf"><span>'+(onecard.card!=null?getFullName(onecard.card):'')+'</span></div>';}
html+='</div>';html+='<div class="instructions" style="top: '+top+'px">Tap the Menu<br />then Pin to Start &darr;</div>';html+='<a class="close-button" style="top: '+top+'px" onclick="closeWindowsPhonePinToStart(this);">Close</a>';html+='</div>';$('body').append(html);$('.wp-pin-to-start').find('.jtf').each(function(){if($(this).find('span').text!=""){var size=parseInt($(this).css('font-size'));$(this).textfill({maxFontPixels:size,innerTag:'span'});}});}}
function closeWindowsPhonePinToStart(index){$(index).parent().remove();}
function sendImport(){var id=$('#import-id').val();var name=$('#import-name').val();var email=$('#import-email').val();var isReady=true;if((email=='')||(validateEmailAddress(email)==false)){isReady=false;$('.error').html('Please Enter a Valid Email Address');}
if(isReady==true){$.confirm.hide();showPageLoadingMsg();if(isOnline()==true){$.ajax({type:"GET",url:"http://"+ siteAddress+"/vcard/import.php",data:"type=email&id="+ id,dataType:"text",async:true,success:function(txt){if(txt!="ERROR"){$.ajax({type:"POST",url:"http://"+ siteAddress+"/email/email.php",data:"form=import&email="+ email+"&id="+ id+"&name="+ name+"&filename="+ txt,dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){displayMessage('Email Status',txt+' to '+ email,null);}else{displayMessage('Email Status','There was an error sending your message. Please try again and if the problem persists, contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}});}else{hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();ajaxError();}});}else{hidePageLoadingMsg();noConnectionError();}}}
function sendShare(){var id=$('#share-id').val();var name=$('#share-name').val();var to=$('#share-number-email').val();var from=$('#share-name-email').val();var isReady=true;var isText=false;if((to=='')||(validateEmailAddress(to)==false)){if(validatePhoneNumber(to)==false){isReady=false;$('.error').html('Please enter a valid phone number or email.');}else if(onecard.card.is_freemium=='0'){isText=true;}else{isReady=false;$('.error').html('Please enter a valid email address.');}}
if(isReady==true&&from==''){isReady=false;if(isText==false){$('.error').html('Please enter your email address in the from field.');}else{$('.error').html('Please enter your name in the from field.');}}else if(isReady==true&&from!=''){if(isText==false&&validateEmailAddress(from)==false){isReady=false;$('.error').html('Please enter your email address in the from field.');}else if(isText==true&&validateEmailAddress(from)==true){isReady=false;$('.error').html('Please enter your name when sharing by text');}}
if(isReady==true){$.confirm.hide();showPageLoadingMsg();if(isOnline()==true){if(isText==false){$.ajax({type:"GET",url:"http://"+ siteAddress+"/vcard/import.php",data:"type=email&id="+ id,dataType:"text",async:true,success:function(txt){if(txt!="ERROR"){$.ajax({type:"POST",url:"http://"+ siteAddress+"/email/email.php",data:"form=share&to="+ to+"&from="+ from+"&id="+ id+"&name="+ name+"&filename="+ txt+"&url="+ encodeURIComponent(buildShortUrl()),dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){displayMessage('Email Status',txt+' to '+ to,null);}else{displayMessage('Email Status','There was an error sending your message. Please try again and if the problem persists, contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}});}else{hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();ajaxError();}});}
else if(onecard.card.is_freemium=='0'){$.ajax({type:"POST",url:"http://"+ siteAddress+"/sms/sms.php",data:"form=sendonecard&to="+ to+"&from="+ from+"&id="+ id+"&name="+ name+"&url="+ encodeURIComponent(buildShortUrl()),dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){displayMessage('Text Message Status',txt+' to '+ to,null);}
else if(txt=="The message From/To pair violates a blacklist rule."){displayMessage('Text Message Status','This number has requested not to receive text messages from One Card&trade;.<br /><br />Please contact '+to+' directly.',null);}
else{displayMessage('Text Message Status','There was an error sending your message. Please try again and if the problem persists, contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Text Message Status',"Cannot Establish a Connection at this Time",null);}});}}else{hidePageLoadingMsg();noConnectionError();}}}
function sendSendTo(){var id=$('#share-id').val();var name=$('#share-name').val();var to=$('#share-number-email').val();var isReady=true;var isText=false;if(to==''||validateEmailAddress(to)==false){if(validatePhoneNumber(to)==false){isReady=false;$('.error').html('Please enter a valid phone number or email.');}
else{isText=true;}}
if(isReady==true){$.confirm.hide();showPageLoadingMsg();if(isOnline()==true){if(isText==false){$.ajax({type:"GET",url:"http://"+ siteAddress+"/vcard/import.php",data:"type=email&id="+ id,dataType:"text",async:true,success:function(txt){if(txt!="ERROR"){$.ajax({type:"POST",url:"http://"+ siteAddress+"/email/email.php",data:"form=sendtodevice&to="+ to+"&from=&id="+ id+"&name="+ name+"&filename="+ txt+"&url="+ encodeURIComponent('http://1crd.me/'+id),dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){displayMessage('Email Status',txt+' to '+ to,null);}else{displayMessage('Email Status','There was an error sending your message. Please try again and if the problem persists, contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}});}else{hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();ajaxError();}});}
else{$.ajax({type:"POST",url:"http://"+ siteAddress+"/sms/sms.php",data:"form=sendonecard&to="+ to+"&from=&id="+ id+"&name="+ name+"&url="+ encodeURIComponent('http://1crd.me/'+id),dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){displayMessage('Text Message Status',txt+' to '+ to,null);}
else if(txt=="The message From/To pair violates a blacklist rule."){displayMessage('Text Message Status','This number has requested not to receive text messages from One Card&trade;.<br /><br />Please contact '+to+' directly.',null);}
else{displayMessage('Text Message Status','There was an error sending your message. Please try again and if the problem persists, contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Text Message Status',"Cannot Establish a Connection at this Time",null);}});}}else{hidePageLoadingMsg();noConnectionError();}}}
function sendRequestContact(){var to=$('input#contact-to').val();var id=$('input#contact-id').val();var name=$('input#contact-name').val();var from=$('input#contact-from').val();var subject=$('input#contact-subject').val();var message=$('textarea#contact-message').val();var isReady=true;if((from=='')||(validateEmailAddress(from)==false)){isReady=false;displayMessage('Form Error','Please enter a valid Email Address.','Email address must contain an @ symbol and a (.) Period before the end.<br />Example:  support@qrpro.co');}else if(subject==''){isReady=false;displayMessage('Form Error','Please enter a Subject.','Example: I have questions about your prices.');}else if(message==''){isReady=false;displayMessage('Form Error','Please enter a Message.','Example: Do you offer any discounts for military or senior citizens?');}
if(isReady==true){showPageLoadingMsg();if(isOnline()==true){$.ajax({type:"POST",url:"http://"+ siteAddress+"/email/email.php",data:"form=requestcontact&to="+ to+"&from="+ from+"&subject="+ subject+"&message="+ message+"&id="+ id+"&name="+ name,dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){$('#contact-from').val('');$('#contact-subject').val('');$('#contact-message').val('');$('#placeholder-email').show();$('#placeholder-subject').show();$('#placeholder-message').show();displayMessage('Email Status',txt,null);}else{displayMessage('Email Status','There was an error sending your message. Please try again and if the problem persists, contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}});}else{hidePageLoadingMsg();noConnectionError();}}}
function sendContactEmail(){var email=$('#contact-email-from').val();var subject=$('#contact-email-subject').val();var message=$('#contact-email-message').val();var isReady=true;if((email=='')||(validateEmailAddress(email)==false)){isReady=false;displayMessage('Form Error','Please Enter a Valid Email To Address.','Email address must contain an @ symbol and a (.) Period before the end.<br />Example:  support@qrpro.co');}else if(message==''){isReady=false;displayMessage('Form Error','Please Enter a Message before Submitting.',null);}
if(isReady==true){showPageLoadingMsg();if(isOnline()==true){$.ajax({type:"POST",url:"http://"+ siteAddress+"/email/email.php",data:"form=contact&email="+ email+"&subject="+ subject+"&message="+ message,dataType:"text",async:true,success:function(txt){hidePageLoadingMsg();if(txt=="Message Sent Successfully"){displayMessage('Email Status',txt,null);}else{displayMessage('Email Status','There was an error sending your message. Please contact QRPro directly via email or by phone.',null);}},error:function(xhr,textStatus,errorThrown){hidePageLoadingMsg();displayMessage('Email Status',"Cannot Establish a Connection at this Time",null);}});}else{hidePageLoadingMsg();noConnectionError();}}}
function loadTouchIcons(){if(device.downgraded){return;}
if(onecard.cardid!=null&&onecard.card!=null&&onecard.admin.isPortal==false&&isOnline()==true&&onecard.touchIcon==null){if(onecard.card.images.appicon!=''||onecard.card.images.profile!=''){var d=new Date();onecard.touchIcon=true;$('link[rel="apple-touch-icon"]').remove();$('link[rel="apple-touch-icon-precomposed"]').remove();var img=onecard.card.images.appicon?onecard.card.images.appicon:onecard.card.images.profile;var cardid=getCardIDActual(onecard.card);if(!onecard.admin.isPortal&&onecard.card.company&&onecard.card.company.images&&onecard.card.company.images.appicon!=''){img=onecard.card.company.images.appicon?onecard.card.company.images.appicon:onecard.card.company.images.profile;cardid=onecard.card.company.id.toLowerCase();}
$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/data/image.php?t='+d.getTime()+'&type=icon-app&size=180&path=files/'+ cardid+'/'+img+'" /> ');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/data/image.php?t='+d.getTime()+'&type=icon-app&size=152&path=files/'+ cardid+'/'+img+'" /> ');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/data/image.php?t='+d.getTime()+'&type=icon-app&size=120&path=files/'+ cardid+'/'+img+'" /> ');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/data/image.php?t='+d.getTime()+'&type=icon-app&size=76&path=files/'+ cardid+'/'+img+'" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" href="/data/image.php?t='+d.getTime()+'&type=icon-app&size=76&path=files/'+ cardid+'/'+img+'" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon" href="/data/image.php?t='+d.getTime()+'&type=icon-app&size=52&path=files/'+ cardid+'/'+img+'" />');}
else{onecard.touchIcon=false;loadDefaultTouchIcons();}}
else if(onecard.touchIcon==null){onecard.touchIcon=false;loadDefaultTouchIcons();}}
function loadDefaultTouchIcons(){$('link[rel="apple-touch-icon"]').remove();$('link[rel="apple-touch-icon-precomposed"]').remove();$('link[rel="apple-touch-icon-precomposed"][size="76x76"]').remove();$('link[rel="apple-touch-icon-precomposed"][size="120x120"]').remove();$('link[rel="apple-touch-icon-precomposed"][size="152x152"]').remove();$('link[rel="apple-touch-icon-precomposed"][size="180x180"]').remove();if(!device.downgraded){if(onecard.admin.isPortal){$('head meta[name="viewport"]').after('<link rel="apple-touch-icon" href="images/appicons/admin-set/iphone.png" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" href="images/appicons/admin-set/iphone.png" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/appicons/admin-set/ipad.png" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/appicons/admin-set/iphone4.png" /> ');}else{$('head meta[name="viewport"]').after('<link rel="apple-touch-icon" href="images/appicons/onecard-set/iphone.png" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" href="images/appicons/onecard-set/iphone.png" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="72x72" href="images/appicons/onecard-set/ipad.png" />');$('head meta[name="viewport"]').after('<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/appicons/onecard-set/iphone4.png" /> ');}}}
function loadDefaultStartImage(){if(!device.downgraded){if($('link[rel="apple-touch-startup-image"]').exists()){}else{$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-1496x2048.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 768px) and (min-device-height: 1004px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" />');
$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-1536x2008.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 768px) and (min-device-height: 1004px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" />');
$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-748x1024.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 768px) and (min-device-height: 1004px) and (orientation:landscape)" />');	
$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-768x1004.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 768px) and (min-device-height: 1004px) and (orientation:portrait)" />');	
$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-640x1096.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 320px) and (min-device-height: 568px) and (-webkit-min-device-pixel-ratio: 2)" />');
$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-640x920.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 320px) and (-webkit-min-device-pixel-ratio: 2)" />');
$('head meta[name="viewport"]').after('<link rel="apple-touch-startup-image" href="images/loading/splash-320x460.jpg?t='+Math.round(new Date().getTime()/ 1000)+'" media="(min-device-width: 320px) and not (-webkit-min-device-pixel-ratio: 2)" />');
}}}
function expandSection(key){var group=$('.page').find('#'+key+'.group');if($(group).exists()&&onecard.sorting==false){if((!onecard.admin.isPortal)||$('.body').id()=='info'){$('.group').each(function(){if($(this).id()!=key){$(this).removeClass('expanded').addClass('collapsed');}});}
$(group).each(function(){if($(this).hasClass('expanded')){if((isMobile()||onecard.admin.isPortal)&&$('.body').id()!='info'){$(this).removeClass('expanded');$(this).addClass('collapsed');}}
else if($(group).hasClass('collapsed')){$(this).removeClass('collapsed');$(this).addClass('expanded');scrollToElm($(this));changePageTitle($(this).find('.group_header_title .name > span').text());}});if($('.body').id()=='index'){setParam('contact',key,true);}
if($('.body').id()=='info'){setParam('info',key,true);if(onecard.admin.isPortal){loadTutorials('info');}}}
$('.page .grid').removeClass('menu');adjustTextSize();rewireIframe('body');resetFaddingTitleBar();}
function expandAllSections(){var group=$('.page').find('.group');if($(group).exists()){$(group).each(function(){$(this).removeClass('collapsed').addClass('expanded');});}
adjustTextSize();rewireIframe('body');}
function collapseAllButFirst(){var group=$('.page').find('.group');if($(group).exists()&&onecard.sorting==false){var expandedsID='';$(group).each(function(){if(expandedsID==''&&(isMobile()||($('.body').id()!='bio'||$(this).id()!='commercial'))){$(this).removeClass('collapsed').addClass('expanded');changePageTitle($(this).find('.group_header_title .name > span').text());expandedsID=$(this).id();}else if(expandedsID==$(this).id()){$(this).removeClass('collapsed').addClass('expanded');}else{$(this).removeClass('expanded').addClass('collapsed');}});if($('.body').id()=='index'){if(expandedsID!=''){setParam('contact',expandedsID);}else{clearParam('contact');}}}
adjustTextSize();rewireIframe('body');}
function collapseAllButCurrent(key){var group=$('.page').find('.group');if($(group).exists()&&onecard.sorting==false){$(group).each(function(){if(key==$(this).id()){$(this).removeClass('collapsed').addClass('expanded');changePageTitle($(this).find('.group_header_title .name > span').text());}else{$(this).removeClass('expanded').addClass('collapsed');}});}
adjustTextSize();rewireIframe('body');}
function collapseAllSections(){var group=$('.page').find('.group');if($(group).exists()){$(group).each(function(){$(this).removeClass('expanded').addClass('collapsed');});}
adjustTextSize();rewireIframe('body');}
function expandNextSection(){var group=$('.grid_content_scroller').find('.group.expanded:first');if($(group).exists()&&onecard.sorting==false){var id=$(group).id();$('.grid_content_scroller .group').each(function(){if($(this).id()==id){if($(this).next('.group').exists()){expandSection($(this).next('.group').id());}else if($('.grid_content_scroller').find('.group:first').exists()){expandSection($('.grid_content_scroller').find('.group:first').id());}
return false;}});}}
function expandPreviousSection(){var group=$('.grid_content_scroller').find('.group.expanded:first');if($(group).exists()&&onecard.sorting==false){var id=$(group).id();$('.grid_content_scroller .group').each(function(){if($(this).id()==id){if($(this).prev('.group').exists()){expandSection($(this).prev('.group').id());}else if($('.grid_content_scroller').find('.group:last').exists()){var gp=$('.grid_content_scroller').find('.group:last');var key=gp.id();expandSection(key);}
return false;}});}}
function collapseGridNavIfNotNeeded(){var group=$('.grid_content').find('.group');if((group==null||$(group).exists()==false||group.length<=1)&&onecard.admin.isPortal==false){$('.grid').addClass('no-nav');}else{$('.grid').removeClass('no-nav');}}
function playVideo(video,type){if(isMobile()&&!device.PositionFixed){scrollToTop();}
var message="";message+='<span class="text-align: center; display: block;">';message+='<div class="video-frame" style="margin: 2px;">';message+=buildFrameforVideo(video,type,false);message+='</div>';message+='</span>';$.confirm({'title':"Video",'message':message,'buttons':{},'maxWidth':"80%",'maxHeight':"80%"});rewireIframe('#confirmOverlay');}
function playVideoFromSRC(src){if(isMobile()&&!device.PositionFixed){scrollToTop();}
var message="";message+='<span class="text-align: center; display: block;">';message+='<div class="video-frame" style="margin: 2px;">';message+='<iframe class="video-embeded" width="560" height="315" src="'+src+'" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';message+='</div>';message+='</span>';$.confirm({'title':"Video",'message':message,'buttons':{},'maxWidth':"80%",'maxHeight':"80%"});rewireIframe('#confirmOverlay');}
function rewireIframe(scope){if(isMobile()&&$('#confirmOverlay').exists()){}
adjustVideoFrameSize();var frames=$(scope).find('iframe');$(frames).each(function(){if($(this).is(':visible')){if($(this).attr('src')==null||$(this).attr('src')==''){if($(this).attr('alt')!=null&&$(this).attr('alt')!=''){$(this).attr('src',$(this).attr('alt'));}}
if($(this).prev().exists()&&$(this).prev().hasClass('iframeScreen')){$(this).show();}
return;}
if($(this).attr('src')!=null||$(this).attr('src')!=''){console.log('This just happened?');}});adjustVideoFrameSize();}
function buildFrameforVideo(video,type,cover){var html='';if(type=='youtube'||type=='YouTube'){if(device.Browser=="InternetExplorer"){html+='<object id="youtube-video" class="youtube" width="560" height="315">';html+='<param name="movie" value="http://www.youtube.com/v/'+video+'?version=3&amp;hl=en_US&autoplay=1"></param>';html+='<param name="allowFullScreen" value="true"></param>';html+='<param name="allowscriptaccess" value="always"></param>';html+='<param name="wmode" value="transparent"></param>';html+='<embed src="http://www.youtube.com/v/'+video+'?version=3&amp;hl=en_US" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="transparent" width="560" height="315"></embed>';html+='</object>';}else{html+='<iframe class="video-embeded" width="560" height="315" src="" alt="http://www.youtube.com/embed/'+video+'?rel=0&wmode=transparent" frameborder="0" wmode="Opaque" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';}}
if(type=='vimeo'||type=='Vimeo'){html+='<iframe class="video-embeded" width="560" height="315" src="" alt="http://player.vimeo.com/video/'+video+'?title=0&amp;byline=0&amp;portrait=0" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';}
if(cover&&html!=''&&device.Browser!="InternetExplorer"){html='<div class="iframeScreen"></div>'+ html;}
return html;}
var iFrameScreenClick=function(event){var iframe=$(this).next().get(0);if(iframe!=null){var src=iframe.src+'&autoplay=1';playVideoFromSRC(src);}else{$(this).hide();}};$(document).on("click",'div.iframeScreen',iFrameScreenClick);function expandImage(src){scrollToTop();var message="";message+='<div class="text-align: center; display: block;">';message+='<img style="max-width: 94%; width: auto; height: auto;margin: 10px 0;" src="'+src+'" />';message+='</div>';$.confirm({'title':"Image",'message':message,'buttons':{}});}
function getCountofType(type){var cnt=0;for(var c in onecard.card.contacts){if(onecard.card.contacts[c].key!='0'&&onecard.card.contacts[c].type==type){cnt++;}
if(onecard.card.contacts[c].key!='0'&&onecard.card.contacts[c].contacts!=null&&onecard.card.contacts[c].contacts.length>0){for(var cc in onecard.card.contacts[c].contacts){if(onecard.card.contacts[c].contacts[cc].type==type){cnt++;}}}}
return cnt;}
function getCountofContacts(){var cnt=0;for(var c in onecard.card.contacts){if(onecard.card.contacts[c].key!=null&&onecard.card.contacts[c].key!='0'){cnt++;}
if(onecard.card.contacts[c].contacts!=null&&onecard.card.contacts[c].contacts.length>0){for(var cc in onecard.card.contacts[c].contacts){cnt++;}}}
return cnt;}
function getCountofSocial(type){var matches=$.grep(onecard.card.social,function(social,index){return(social.description==type&&social.url.rtrim()!='');});return matches.length;}
function getCoundofInfoType(type){var cnt=0;for(var c in onecard.card.infocenter){if(type=='Page'){cnt++;}
if(onecard.card.infocenter[c].groups!=null&&onecard.card.infocenter[c].groups.length>0){for(var cc in onecard.card.infocenter[c].groups){if(type=='Group'){cnt++;}
if(onecard.card.infocenter[c].groups[cc].items!=null&&onecard.card.infocenter[c].groups[cc].items.length>0){for(var ccc in onecard.card.infocenter[c].groups[cc].items){if(onecard.card.infocenter[c].groups[cc].items[ccc].type==type){cnt++;}}}}}}
return cnt;}
function contactsHaveGeneral(){var found=false;for(var c in onecard.card.contacts){if(onecard.card.contacts[c].key==undefined){found=true;}}
return found;}
function resetFaddingTitleBar(){$('.grid').css('padding-top','');$('.grid_title').css('position','');$('.grid_title').css('top','');$('.grid_title').stop(true,true).css('display','');}
function loadCard(page,cardid){if(onecard.card!=null&&onecard.card.cardid.toString().toLowerCase()==cardid){if(isCompanyCard(onecard.card)){$(document.body).addClass('company-card')}else{$(document.body).removeClass('company-card');}
if(onecard.card.is_freemium=='1'){$(document.body).addClass('freemium')}else{$(document.body).removeClass('freemium');}
if(onecard.card.show_name=='0'){$(document.body).addClass('hide-name')}else{$(document.body).removeClass('hide-name');}
loadCardParts(page,onecard.card);}
else{onecard.cardid=null;onecard.card=null;onecard.cardid=cardid;}}
function loadCardParts(page,card){if(card!=null){if(onecard.admin.isPortal==false){changeTitles(getFullName(card));}
loadName();loadAccentColor();var id=$(page).attr('id');switch(id){case"index":changePageTitle('Contact');loadVideos(page);loadContacts(page);if(isEmployeeCard(card)&&!onecard.admin.isPortal){loadCompanyContacts(page);}
collapseGridNavIfNotNeeded();if(onecard.admin.isPortal){expandAllSections();}else{if(getParam('contact')!=null){collapseAllButCurrent(getParam('contact'));if($('.page').find('.group.expanded').exists()==false){collapseAllButFirst();}}else{collapseAllButFirst();}}
break;case"staff":changePageTitle('Staff');if(onecard.card.is_freemium=='1'){loadAdvertisementPage(page);break;}
loadStaff(page);collapseAllButFirst();collapseGridNavIfNotNeeded();if(onecard.admin.isPortal){expandAllSections();}
break;case"social":changePageTitle('Social Media Dashboard');if(onecard.card.is_freemium=='1'){loadAdvertisementPage(page);break;}
loadSocial(page);break;case"bio":changePageTitle('About');if(onecard.card.is_freemium=='1'){loadAdvertisementPage(page);break;}
loadAbout(page);loadSkillsAndExpertise(page);if(isCompanyCard(onecard.card)==false){loadResumeHistory(page);}
if(isEmployeeCard(card)&&!onecard.admin.isPortal){loadCompanyAbout(page);loadCompanySkillsAndExpertise(page);}
if(isMobile()){collapseAllButFirst();}else{expandAllSections();}
break;case"info":changePageTitle('Information Center');if(onecard.card.is_freemium=='1'){loadAdvertisementPage(page);break;}
loadInfoMenu(page);loadInfoItems(page);break;}
loadNotices(page);loadClear(page);rewireIframe('body');hideFooterIcons();}}
function hideFooterIcons(){if(onecard.admin.isPortal){return;}
if(onecard.card.is_freemium=='1'){$('table.footer tr td').remove();$('.banner_nav div').remove();$(document.body).removeClass('no-footer');$('table.footer tr').append('<td style="text-align: center;background-color: #E9E8E8;height: 54px;"><a class="only mobile" href="http://admin.onecardme.com/new.html" target="_blank" style="width: 100%;"><img src="images/freemium/banner_mobile.png" style="max-width: 90%;max-height: 90%;height: auto;width:auto;"></a></td>');$('.banner_nav').append('<a class="only regular landscape" href="http://admin.onecardme.com/new.html" target="_blank" style="width: 100%;"><img src="images/freemium/banner_reg_lanscape.png" style="max-width: 90%;max-height: 90%;height: auto;width:auto;"></a>');$('.banner_nav').append('<a class="only regular portrait" href="http://admin.onecardme.com/new.html" target="_blank" style="width: 100%;"><img src="images/freemium/banner_reg_portrait.png" style="max-width: 90%;max-height: 90%;height: auto;width:auto;"></a>');return;}
var staff=($.grep(onecard.card.contacts,function(contact,index){return(contact.type=='Location'&&contact.employees.length>0);}).length>0);var social=(onecard.card.social.length>0||onecard.card.contact_email!=''||(onecard.card.company!=null&&((onecard.card.company.social!=null&&onecard.card.company.social.length>0)||onecard.card.company.contact_email!=null)));var bio=(onecard.card.history.education.length>0||onecard.card.history.employment.length>0||onecard.card.about!=''||onecard.card.skills.length>0||(onecard.card.company!=null&&(onecard.card.company.about!=null||(onecard.card.company.services!=null&&onecard.card.company.services.length>0)||onecard.card.company.commercial!=null)));var info=(onecard.card.infocenter.length>0||(onecard.card.company!=null&&onecard.card.company.infocenter!=null&&onecard.card.company.infocenter.length>0));if(!social){$('.footer td.social').hide();$('.banner_nav div.banner_nav_3').hide();}
if(!bio){$('.footer td.bio').hide();$('.banner_nav div.banner_nav_2').hide();}
if(!info){$('.footer td.info').hide();$('.banner_nav div.banner_nav_4').hide();}
if((!staff&&getCurrentPageID()=='staff')||(!social&&getCurrentPageID()=='social')||(!bio&&getCurrentPageID()=='bio')||(!info&&getCurrentPageID()=='info'))
changePage('index');if(!social&&!bio&&!info){$('table.footer').hide();$('.banner_nav div.banner_nav_1').hide();$(document.body).addClass('no-footer');}else{$('table.footer').attr('style','');$('.banner_nav div.banner_nav_1').attr('style','');$(document.body).removeClass('no-footer');}}
function loadHeader(key,title,subtitle,hasChildren,hasDetails,isParent){var html="";html+='<div class="group_header">';html+='<table><tr>';if(hasChildren){html+='<td class="group_header_expandable">';html+='<a onclick="expandSection(\''+key+'\');">';html+='<span class="icon_menu plus"></span>';html+='</a>';html+='</td>';}
html+='<td class="group_header_title" >';html+='<a onclick="expandSection(\''+key+'\');">';if(title!=null&&title!=''){html+='<div class="adj name"><span>'+title+'</span></div>';if(subtitle!=null&&subtitle!=''){html+='<div class="job_title"><span>'+subtitle+'</span></div>';}}else if(subtitle!=null&&subtitle!=''){html+='<div class="adj name"><span>'+subtitle+'</span></div>';}else{html+='<div class="adj name"><span>Company Information</span></div>';}
html+='</a>';html+='</td>';if(hasDetails){html+='<td class="group_header_info">';var ckey=key.replace(/[A-Za-z$-]/g,"");html+='<a onclick="showContactDetails(\''+ckey+'\', '+isParent+');">';html+='<span class="icon_menu info"></span>';html+='</a>';html+='</td>';}
html+='</tr></table>';html+='</div>';return html;}
function loadCardImages(){if(onecard.card==null){return;}
if(onecard.admin.isPortal){onecard.profilePicture=null;onecard.bannerImage=null;}
loadCardPictures();rewireIframe('body');}
function loadCardPictures(){$('.banner_image').addClass('fullWidth');$('#banner_slider').html('');var d=new Date();if(onecard.card.images.profile!=''||onecard.admin.isPortal){if(onecard.card.images.profile!=''){var src='http://'+ siteAddress+'/files/'+ getCardIDActual(onecard.card)+'/profile.png?t='+ d.getTime();if(!onecard.admin.isPortal&&onecard.card.company&&onecard.card.company.images&&onecard.card.company.images.profile!=''){var src='http://'+ siteAddress+'/files/'+ onecard.card.company.id.toLowerCase()+'/profile.png?t='+ d.getTime();}}else{var src='http://'+ siteAddress+'/images/placeholders/profile_placeholder.png';}
$('.banner_image').attr('style','').show();var img=new Image();$(img).load(function(){$(this).addClass('img');$(this).attr('id','profile-image');var w=this.width;var h=this.height;$('<div class="slider_image_wrapper"></div>').appendTo('#banner_slider').append(this);var img=document.getElementById($(this).id());resizeImage(img,w,h);$(this).show();adjustFrameSize();if(onecard.admin.isPortal){$(this).click(function(){adminPopupProfileImage();});}}).attr('id','profile-image').attr('src',src);}
else{$('.banner_image').attr('style','display: none !important;');}
var bannerIcon=onecard.card.images.appicon?onecard.card.images.appicon:onecard.card.images.profile;var cardid=getCardIDActual(onecard.card);if(onecard.card.company&&onecard.card.company.images&&(onecard.card.company.images.appicon!=''||onecard.card.company.images.profile!='')){var bannerIcon=onecard.card.company.images.appicon?onecard.card.company.images.appicon:onecard.card.company.images.profile;var cardid=onecard.card.company.id.toLowerCase();}
if(bannerIcon!=''){var d=new Date();var src='http://'+ siteAddress+'/files/'+ cardid+'/'+bannerIcon+'?t='+ d.getTime();$('.banner_icon img.img').attr('src',src);$('.banner_icon').attr('style','').show();}
else{$('.banner_icon').attr('style','display: none !important;');}}
function startImageAnimation(){if($('#banner_slider').children().length<=1){return;}
$('#banner_slider').removeClass('static').addClass('slidding');$('#banner_slider > div:first-child').addClass('active');$("#banner_slider .active").siblings().hide();$('#banner_slider').children().each(function(){var top=($('#banner_slider').height()- $(this).height())/ 2;
$(this).css('top',top+'px');});setInterval(function(){var active=$('#banner_slider .active');var next=(active.next().length>0)?active.next():$("#banner_slider > div:first-child");active.fadeOut(3000,function(){active.removeClass('active');});next.fadeIn(3000,function(){next.addClass('active');});},10000);}
function resizeImage(img,w,h){if($(img).attr('data-width')===undefined){$(img).attr('data-width',w);$(img).attr('data-height',h);}
var w=$(img).attr('data-width');var h=$(img).attr('data-height');var width=(isMobile()||onecard.admin.isPortal)?($(img).parent().width()-20):$('.banner_image').width()-(10+40);var ratio=width/w;var bHeight=$('table.banner').height()-20;var maxHeight=(isMobile()||onecard.admin.isPortal)?200:$('.banner_image').height()-20;if((h*ratio)>maxHeight){var ratio=maxHeight/h;var width=w*ratio;}
if(parseInt($('#banner_slider').css('height'))<(maxHeight+ 20)){$('#banner_slider').css('min-height',(maxHeight+20)+'px');}
$(img).css('width',width+'px');$(img).css('height','auto');}
function loadNotices(page){var html="";if(!onecard.admin.isPortal&&onecard.card.is_freemium=='0'&&((onecard.card.notices!=null&&onecard.card.notices!="")||(isEmployeeCard(onecard.card)&&onecard.card.company.notices&&onecard.card.company.notices!=""))){html+='<div class="notices-wrappers">';html+='<a class="notices">';html+='Notices & Disclaimers';html+='<span class="icon_menu enter"></span></a>';html+='</div>';if(onecard.admin.isPortal==false&&$('.body').id()=='info'){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);if(onecard.admin.isPortal==false){$('.notices').off('click').click(function(evt){var notices=onecard.card.notices;if(isEmployeeCard(onecard.card)&&onecard.card.company.notices&&onecard.card.company.notices!=""){notices=onecard.card.company.notices;}
$.confirm({'title':'Notices','message':'<div class="formated-text">'+ notices+'</div>','buttons':{}});});}}}
function loadName(){if(onecard.card.name!=null){$('.banner_name div span').html(getFullName(onecard.card));$('.header .title #name').html(getFullName(onecard.card));}}
function loadVideos(page){if((onecard.card.video_intro!=null&&onecard.card.video_intro.url!="")||onecard.admin.isPortal){$('.page .banner .banner_image a.video').off('click').click(function(){playVideo(onecard.card.video_intro.url,onecard.card.video_intro.type);});$('.page .banner .banner_image a.video').css('display','inline-block');}}
function loadContacts(page){var html="";var expanded=true;var foundCompany=false;var foundLocation=false;if(onecard.card.contacts!=null){$(onecard.card.contacts).each(function(){if((this.type!="General"||this.contacts.length>0)&&(this.type!="Location"||this.key!=0)){var key=(this.key!=null)?this.key:'0';html+='<div id="'+key+'" class="group '+((expanded)?'expanded':'collapsed')+'" data-type="'+this.type+'" '+((this.type!="General")?'data-sortable="groups"':'')+'>';if(expanded==true){expanded=false;}
switch(this.type){case"General":html+=loadContact('general',this,false);break;case"Company":if(onecard.card.is_freemium=="0"||foundCompany==false){html+=loadContact('company',this,false);foundCompany=true;}
break;case"Location":if(onecard.card.is_freemium=="0"||foundLocation==false){html+=loadContact('location',this,false);foundLocation=true;}
break;}
html+='</div>';}});}
if(html!=''){if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);}}
function loadCompanyContacts(page){var html="";var expanded=true;var foundCompany=false;var foundLocation=false;if(onecard.card.company.contacts!=null){$(onecard.card.company.contacts).each(function(){if((this.type!="General"||this.contacts.length>0)&&(this.type!="Location"||this.key!=0)){var key=(this.key!=null)?this.key:'0';html+='<div id="p'+key+'" class="group '+((expanded)?'expanded':'collapsed')+'" data-type="'+this.type+'" '+((this.type!="General")?'data-sortable="groups"':'')+'>';if(expanded==true){expanded=false;}
switch(this.type){case"General":html+=loadContact('general',this,true);break;case"Company":if(onecard.card.is_freemium=="0"||foundCompany==false){html+=loadContact('company',this,true);foundCompany=true;}
break;case"Location":if(onecard.card.is_freemium=="0"||foundLocation==false){html+=loadContact('location',this,true);foundLocation=true;}
break;}
html+='</div>';}});}
if(html!=''){if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);}}
function loadContact(type,node,isParent){var html="";var title="";if(type=="general"){title=(isCompanyCard(onecard.card)||isParent)?'Corporate Information':'Primary Information';}else if(type=="company"){title=node.name;}else if(type=="location"){title=node.title;}
var subtitle=(type=="company")?node.title:null;var key=(node.key!=null)?node.key:'0';if(isParent)key='p'+key;var hasChildren=(onecard.admin.isPortal||node.contacts.length>0||hasContactDetails(node)||hasContactVideo(node)||node.key==undefined);var hasDetails=((hasContactDetails(node)||hasContactVideo(node))&&node.key!=undefined);html+=loadHeader(key,title,subtitle,hasChildren,hasDetails,isParent);html+='<div class="collapsible-content">';if(!onecard.admin.isPortal&&node.key==undefined&&onecard.card.video_intro!=null&&onecard.card.video_intro.url!=""){html+='<div style="white-space: nowrap;" class="company-details">';html+='<a onclick="playVideo(\''+onecard.card.video_intro.url+'\', \''+onecard.card.video_intro.type+'\');">Tap to Watch Welcome Video</a>';html+='</div>';}
if(onecard.admin.isPortal&&node.key==undefined){html+='<div style="white-space: nowrap;" class="company-details">';if(onecard.card.video_intro!=null&&onecard.card.video_intro.url!=""){html+='<a onclick="adminPopupWelcomeVideo();">Edit Welcome Video</a>';}else{html+='<a onclick="adminPopupWelcomeVideo();">Add Welcome Video</a>';}
html+='</div>';}
if(node.key!=undefined&&(hasContactDetails(node)||hasContactVideo(node))){html+='<div style="white-space: nowrap;" class="company-details">';if(hasContactDetails(node)&&hasContactVideo(node)){html+='<a style="width: 50%;" onclick="playVideo(\''+node.video+'\', \''+node.video_type+'\');">Tap to<br>Watch Commercial</a>';html+='<a style="width: 50%;" onclick="showContactDetails(\''+node.key+'\', '+isParent+');">Tap to<br>view details</a>';}
else if(hasContactDetails(node)){html+='<a onclick="showContactDetails(\''+node.key+'\', '+isParent+');">Tap to view details</a>';}
else if(hasContactVideo(node)){html+='<a onclick="playVideo(\''+node.video+'\', \''+node.video_type+'\');">Tap to Watch Commercial</a>';}
html+='</div>';}
html+='<div class="detail-group">';html+=loadContactDetails(node,isParent);html+='</div>';if(onecard.admin.isPortal&&(node.key!=undefined||node.contacts.length>1)){html+='<div class="group-toolbar">';if(node.key!=undefined&&node.contacts.length>1){html+='<div id="group-edit"><a class="details" data-type="'+node.type+'" data-key="'+node.key+'" >';html+='Edit<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-sort"><a class="sort" onclick="sortingStart(this, \'contacts\');" >';html+='Sort<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-save"><a class="save" onclick="sortingSave();" >';html+='Save<span class="icon_menu enter"></span>';html+='</a></div>';}
else if(node.key==undefined&&node.contacts.length>1){html+='<div id="group-sort" class="full"><a class="sort" onclick="sortingStart(this, \'contacts\');" >';html+='Sort<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-save" class=""><a class="save" onclick="sortingSave();" >';html+='Save<span class="icon_menu enter"></span>';html+='</a></div>';}
else if(node.key!=undefined&&node.contacts.length<=1){html+='<div id="group-edit" class="full"><a class="details" data-type="'+node.type+'" data-key="'+node.key+'" >';html+='Edit '+(isCompanyCard(onecard.card)?'Location':'Company')+'<span class="icon_menu enter"></span>';html+='</a></div>';}
else{}
html+='</div>';}
if(node.key!=undefined&&(hasContactDetails(node)||hasContactVideo(node))){if(onecard.card.is_freemium=='0'&&node.img!=null&&node.img!=""){var d=new Date();var src='http://'+ siteAddress+'/files/'+ getCardID(onecard.card)+'/images/'+ node.img+'?time='+ d.getTime();if(isParent){src='http://'+ siteAddress+'/files/'+ getCompany(onecard.card)+'/images/'+ node.img+'?time='+ d.getTime();}
html+='<div onclick="showContactDetails(\''+node.key+'\', '+isParent+');" class="company-logo"><img src="'+src+'"></div>';}}
html+='<div class="sortable-group">';html+=loadContactChildren(node,isParent);html+='</div>';html+='</div>';return html;}
function loadContactChildren(node,isParent){var html="";var rightSideFound=false;if(onecard.admin.isPortal==false&&node.video!=null&&node.video!=""){html+='<div class="video-frame" style="margin: 10px;">';html+=buildFrameforVideo(node.video,node.video_type,true);html+='</div>';rightSideFound=true;}
if(!rightSideFound&&!isParent){if(onecard.card.video_intro!=null&&onecard.card.video_intro.url!=""&&onecard.card.images.banner!=''&&hasContactDetails(node)){html+='<div class="video-frame" style="margin: 10px;">';html+=buildFrameforVideo(onecard.card.video_intro.url,onecard.card.video_intro.type,true);html+='</div>';rightSideFound=true;}}
if(!rightSideFound&&isParent){if(onecard.card.company.commercial!=null&&onecard.card.company.commercial.url!=""&&onecard.card.images.banner!=''&&hasContactDetails(node)){html+='<div class="video-frame" style="margin: 10px;">';html+=buildFrameforVideo(onecard.card.company.commercial.url,onecard.card.company.commercial.type,true);html+='</div>';}}
var employees=$.grep(onecard.card.contacts,function(contact,index){return((contact.type=='Location'||contact.type=="General")&&contact.employees!=null&&contact.employees.length>0);});if(isCompanyCard(onecard.card)&&(onecard.admin.isPortal||(onecard.card.is_freemium=="0"&&employees!=null&&employees.length>0))){html+='<a onclick="changePage(\'staff.html\');" class="contact" style="font-size: 16px;padding: 10px 14px; text-align: center;background-color: #8F8F8F;">'+(onecard.admin.isPortal?'Edit Staff':'View Staff')+'<span class="icon_menu enter" style="right: 10px;"><span></span></span></a>';}
$(node.contacts).each(function(){switch(this.type){case"Number":html+=loadNumber(this,'');break;case"Email":html+=loadEmail(this,'');break;case"Address":html+=loadAddress(this,'');break;case"URL":html+=loadURL(this,'');break;}});return html;}
function loadContactDetails(node,isParent){var html="";var leftSideFound=false;var d=new Date();var src='http://'+ siteAddress+'/files/'+ getCardID(onecard.card)+'/images/'+ node.img+'?time='+ d.getTime();if(isParent){src='http://'+ siteAddress+'/files/'+ getCompany(onecard.card)+'/images/'+ node.img+'?time='+ d.getTime();}
if(onecard.card.is_freemium=='0'&&node.img!=null&&node.img!=""){html+='<div style="margin: 10px; background-color: #BCBEC0;">';html+='<img src="'+src+'" />';html+='</div>';leftSideFound=true;}
if(!leftSideFound&&!isParent&&(node.key==undefined||!contactsHaveGeneral())){if(onecard.card.video_intro!=null&&onecard.card.video_intro.url!=""&&(!leftSideFound||!hasContactDetails(node))){html+='<div class="video-frame" style="margin: 10px;">';html+=buildFrameforVideo(onecard.card.video_intro.url,onecard.card.video_intro.type,true);html+='</div>';leftSideFound=true;}}
if(!leftSideFound&&isParent){if(onecard.card.company.images.banner!=''){src='http://'+ siteAddress+'/files/'+ getCompany(onecard.card)+'/banner.png?t='+ d.getTime();html+='<div class="details-banner"><img src="'+src+'" /></div>';leftSideFound=true;}
if(onecard.card.company.commercial!=null&&onecard.card.company.commercial.url!=""&&(!leftSideFound||!hasContactDetails(node))){html+='<div class="video-frame" style="margin: 10px;">';html+=buildFrameforVideo(onecard.card.company.commercial.url,onecard.card.company.commercial.type,true);html+='</div>';leftSideFound=true;}}
if(isCompanyCard(onecard.card)==false&&node.title!=null&&node.title!=""){html+='<div class="detail">';html+='<b>Title</b> : '+ node.title+'';html+='</div>';}
if(node.start!=null&&(node.start.month!="0"||node.start.year!="0")){html+='<div class="detail">';html+='<b>Start Date</b> : ';html+=(node.start.month!="0")?node.start.month:'';html+=(node.start.month!="0"&&node.start.year!="0")?'/':'';html+=(node.start.year!="0")?node.start.year:'';html+='<br />';html+='</div>';}
if(node.hrs!=null&&node.hrs!=""){html+='<div class="detail">';html+='<b>Hours</b> : '+ node.hrs+'';html+='</div>';}
if(node.description!=null&&node.description!=""){html+='<div class="detail description">'+ node.description+'</div>';leftSideFound=true;}
if(!leftSideFound){var url=buildURL(getCurrentPageID()+'.html',false);var src='http://'+ siteAddress+'/qrcode/qrcode.php?path='+ encodeURIComponent(url);html+='<div class="details-qrcode">';html+='<img src="'+src+'" />';html+='<div class="instructions">';html+='<h2>QR Code</h2>';html+='Scan this QR Code to share it or view it on a smartphone<br /><br />';html+='For more information on what a QR Code is and how to use them <a href="http://onecardme.com/home/2013/06/how-to-use-a-qr-code/" style="color: #333232;font-weight: bold;">Click Here</a>.';html+='</div>';html+='<div class="clear"></div>';html+='</div>';}
return html;}
function hasContactDetails(node){var d=new Date();if(onecard.card.is_freemium=='0'&&node.img!=null&&node.img!=""){return true;}else if(node.start!=null&&node.start.month!="0"){return true;}else if(node.start!=null&&node.start.year!="0"){return true;}else if(node.hrs!=null&&node.hrs!=""){return true;}else if(node.description!=null&&node.description!=""){return true;}
return false;}
function hasContactVideo(node){return(node.video!=null&&node.video!="");}
function getParentByKey(key){var parent=null;if(onecard.card.contacts!=null){$(onecard.card.contacts).each(function(){if(this.key==key){parent=this;return false;}});}
if(parent==null&&isEmployeeCard(onecard.card)&&onecard.card.company.contacts!=null){$(onecard.card.company.contacts).each(function(){if(this.key==key){parent=this;return false;}});}
return parent;}
function showContactDetails(key,isParent){var node=getParentByKey(key);if(node!=null){var message="";var name="";if(isCompanyCard(onecard.card)||isParent){name=node.title;}
else{name=node.name;}
message+='<span class="text-align: center; display: block;">';var d=new Date();var src='http://'+ siteAddress+'/files/'+ getCardID(onecard.card)+'/images/'+ node.img+'?time='+ d.getTime();if(isParent){src='http://'+ siteAddress+'/files/'+ getCompany(onecard.card)+'/images/'+ node.img+'?time='+ d.getTime();}
if(onecard.card.is_freemium=='0'&&node.img!=null&&node.img!=""){message+='<img src="'+src+'" style="max-width: 90%; max-height: 300px; width: auto; height: auto; margin: 10px auto;display: block;left: 0px;right: 0px;"                                         />';}
message+='<span style="display: block; margin: 0; background-color: #6E6F71; padding: 4px 0; color: white;">';if(isCompanyCard(onecard.card)==false&&node.title!=null&&node.title!=""){message+='<b>Title</b> : '+ node.title+'<br />';}
if(node.start!=null&&(node.start.month!="0"||node.start.year!="0")){message+='<b>Start Date</b> : ';message+=(node.start.month!="0")?node.start.month:'';message+=(node.start.month!="0"&&node.start.year!="0")?'/':'';message+=(node.start.year!="0")?node.start.year:'';message+='<br />';}
if(node.hrs!=null&&node.hrs!=""){message+='<b>Hours</b> : '+ node.hrs+'<br />';}
message+='</span>';if(node.description!=null&&node.description!=""){message+='<div class="formated-text">'+ node.description+'</div>';}
message+='</span>';$.confirm({'title':name,'message':message,'buttons':{}});rewireIframe('body');}}
function loadNumber(node,key){var html="";if(node.number.rtrim()==''&&node.note.rtrim()==''){return'';}
var description=$(node).attr('description');var href=(description!='Texting')?'tel:':'sms:';if(description=='Mobile & Texting'&&device.OS!='WindowsPhone'){html+='<a href="javascript:numberCallOrSMS(\''+ node.number+'\');" class="contact" data-key="'+node.key+'" data-type="Number" data-sortable="contacts">';}else if(description=='Skype'){html+='<a href="javascript:numberSkype(\''+ node.number+'\');" class="contact" data-key="'+node.key+'" data-type="Number" data-sortable="contacts">';}else if(description=='FaceTime'){html+='<a href="javascript:numberFaceTime(\''+ node.number+'\');" class="contact" data-key="'+node.key+'" data-type="Number" data-sortable="contacts">';}else{if(device.OS=='WindowsPhone'){html+='<a href="tel:'+ node.number+'" class="contact" data-key="'+node.key+'" data-type="Number" data-sortable="contacts">';}else if(!onecard.admin.isPortal){html+='<a href="'+ href+ node.number+'" class="contact" data-key="'+node.key+'" data-type="Number" data-sortable="contacts">';}else{html+='<a class="contact" data-key="'+node.key+'" data-type="Number" data-sortable="contacts">';}}
html+='<span class="icon_contact '+ node.icon+'"></span>';html+='<div class="number">';if(description=='Skype'||description=='FaceTime'){html+='<div style="float:left;">'+ node.number+'&nbsp;</div>';}else{html+='<div style="float:left;">'+ formatPhoneNumber(node.number)+'&nbsp;</div>';}
html+='<div class="adj note"><span>&nbsp;'+ node.note+'</span></div>';html+='</div>';html+='</a>';return html;}
function loadEmail(node,key){var html="";if(node.email.rtrim()==''){return'';}
html+='<a href="mailto:'+ node.email+'" class="contact" data-key="'+node.key+'" data-type="Email" data-sortable="contacts">';html+='<span class="icon_contact email"></span>';html+='<div class="email">';html+='<div class="adj"><span>'+ node.email+'</span></div>';html+='</div>';html+='</a>';return html;}
function loadAddress(node,key){var html="";if(node.street1.rtrim()==''&&node.street2.rtrim()==''&&node.city.rtrim()==''&&node.state.rtrim()==''&&node.zip.rtrim()==''){return'';}
if(node.icon=='physical'){html+='<a target="_blank" href="http://maps.google.com/maps?q='+ node.street1+'%20'+ node.street2+'%20'+ node.city+'%20'+ node.state+'%20'+ node.zip+'" class="contact" data-key="'+node.key+'" data-type="Address" data-sortable="contacts">';}else{html+='<a class="contact" data-key="'+node.key+'" data-type="Address" data-sortable="contacts">';}
html+='<span class="icon_contact '+ node.icon+'"></span>';html+='<div class="address">';html+='<div class="adj"><span>'+ node.description+' Address</span></div>';html+='<div class="adj"><span>'+ node.street1+' '+ node.street2+'</span></div>';html+='<div class="adj"><span>'+ node.city+' '+ node.state+' '+ node.zip+'</span></div>';html+='</div>';html+='</a>';return html;}
function loadURL(node,key){var html="";if(node.url.rtrim()==''){return'';}
html+='<a href="'+ formatURL(node.url)+'" target="_blank" class="contact" data-key="'+node.key+'" data-type="URL" data-sortable="contacts">';html+='<span class="icon_contact safari"></span>';html+='<div class="url">';html+='<div class="adj"><span>'+((node.title!="")?node.title:"Visit Web Page")+'</span></div>';html+='</div>';html+='</a>';return html;}
function numberCallOrSMS(number){scrollToTop();note=((typeof(note)!='undefined')&&(note!=null))?note:"";var message='<br />This number is set to receive Calls<br />and SMS (Text) Messages.';$.confirm({'title':'Call/SMS','message':message,'buttons':{'Call':{'class':'blue','action':function(){window.location.href="tel:"+number;}},'SMS':{'class':'blue','action':function(){window.location.href="sms:"+number;}}}});}
function numberSkype(number){scrollToTop();note=((typeof(note)!='undefined')&&(note!=null))?note:"";var message='<br />You must have Skype installed.<br />Call initiation from One Card™ might not be available on every device. Carrier data rates and charges may apply.';$.confirm({'title':'Skype','message':message,'buttons':{'Call':{'class':'blue','action':function(){window.location.href="skype:"+number;}},'Cancel':{'class':'gray','action':function(){}}}});}
function numberFaceTime(number){scrollToTop();note=((typeof(note)!='undefined')&&(note!=null))?note:"";var message='<br />You must be on an Apple Device with FaceTime enabled.';$.confirm({'title':'FaceTime','message':message,'buttons':{'Call':{'class':'blue','action':function(){window.location.href="facetime://"+number;}},'Cancel':{'class':'gray','action':function(){}}}});}
function loadStaff(page){var mhtml="";mhtml+='<a onclick="changePage(\'index.html\');"><div class="staff-button">View Contact Page<span class="icon_menu enter"></span></div></a>';var locations=$.grep(onecard.card.contacts,function(contact,index){return(contact.type=='Location');});if(locations.length>0){$(locations).each(function(){var html="";if(this.employees.length>0||onecard.admin.isPortal){var leftCol="";var rightCol="";for(var i=0;i<this.employees.length;i++){var employee=this.employees[i];var button="";var name="";if(employee.name_first!=""){name+=employee.name_first.capitalize();}
if(employee.name_middle!=""){name+=' '+ employee.name_middle.capitalize();}
if(employee.name_last!=""){name+=' '+ employee.name_last.capitalize();}
var start_month=(employee.start.month)?employee.start.month:"0";var start_year=(employee.start.year)?employee.start.year:"0";var cardid=(employee.cardid!=null)?employee.cardid:"";var number="",numberkey="",email="",emailkey="";$(employee.contacts).each(function(){if(this.type=="Number"){number=this.number;numberkey=this.key;return false;}
if(this.type=="Email"){email=this.email;emailkey=this.key;return false;}});if(cardid!=""){button+='<a class="employee" href="http://onecardme.com/'+ cardid+'" target="_blank" data-key="'+employee.key+'" data-lkey="'+this.key+'" data-type="Staff" data-sortable="staff">';}else if(number!=""){button+='<a class="employee" href="tel:'+ number+'" target="_blank" data-key="'+employee.key+'" data-lkey="'+this.key+'" data-type="Staff" data-sortable="staff">';}else if(email!=""){button+='<a class="employee" href="mailto:'+ email+'" target="_blank" data-key="'+employee.key+'" data-lkey="'+this.key+'" data-type="Staff" data-sortable="staff">';}else{button+='<a class="employee" style="cursor: default;" data-key="'+employee.key+'" data-lkey="'+this.key+'" data-type="Staff" data-sortable="staff">';}
var d=new Date();var src='http://'+ siteAddress+'/files/'+ cardid.toLowerCase()+'/profile.png?time='+ d.getTime();if(cardid!=""&&checkImageAvailable(src)){button+='<div class="cont">';button+='<img src="'+src+'" />';}else{button+='<div class="cont" style="min-height: 0;">';}
button+='<h2>'+ name+'</h2>';if(employee.title!=""){button+='<b>'+ employee.title+'</b><br />';}
if(start_month!=""&&start_month!='0'){button+='<i>'+ start_month+'/'+ start_year+'</i><br />';}
if(cardid!=""){button+='http://onecardme.com/<wbr />'+ cardid+'';}else if(number!=null&&number!=""){button+=''+ formatPhoneNumber(number)+'';}else if(email!=null&&email!=""){button+=''+ email+'';}
button+='</div>';button+="</a>";if(i<this.employees.length/2){leftCol+=button;}else{rightCol+=button;}}
if(onecard.admin.isPortal){html+=leftCol+ rightCol;}else{html+='<div class="left-col">';html+=leftCol;html+='</div>';html+='<div class="right-col">'+rightCol+'</div>';}}
if(html!=""||onecard.admin.isPortal){mhtml+='<div id="'+this.key+'" class="group">';var title=this.key=='0'?getFullName(onecard.card):(this.title!=''?this.title:'Company Information');var subTitle=this.key=='0'?'Corporate Level Staff':'This Locations Staff';mhtml+=loadHeader(this.key,title,subTitle,true,false,false);mhtml+='<div class="collapsible-content">';if(onecard.admin.isPortal){mhtml+='<div class="group-toolbar">';if(this.employees.length>1){mhtml+='<div id="group-sort"><a class="sort" onclick="sortingStart(this, \'staff\');" >';mhtml+='Sort Contacts<span class="icon_menu enter"></span>';mhtml+='</a></div>';mhtml+='<div id="group-save"><a class="save" onclick="sortingSave();" >';mhtml+='Save Sorting<span class="icon_menu enter"></span>';mhtml+='</a></div>';mhtml+='<div id="group-edit"><a class="details" onclick="adminPopupEmployee(\'\', \''+this.key+'\');">';mhtml+='Add Staff<span class="icon_menu enter"></span>';mhtml+='</a></div>';}else if(this.employees.length<=1){mhtml+='<div id="group-sort"><a class="sort" style="cursor: default; padding: 5px 2px;">';mhtml+='Tap Entry to Edit</span>';mhtml+='</a></div>';mhtml+='<div id="group-edit"><a class="details" onclick="adminPopupEmployee(\'\', \''+this.key+'\');");">';mhtml+='Add Staff<span class="icon_menu enter"></span>';mhtml+='</a></div>';}
mhtml+='</div>';}
mhtml+='<div class="sortable-group">';mhtml+=html;mhtml+='</div>';mhtml+='</div>';mhtml+='</div>';}});if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(mhtml);}
$(page).find('.grid_content_scroller').append(mhtml);}}
function loadSocial(page){loadSocialLinks(page);loadSocialContact(page);}
function loadSocialLinks(page){var html="";if((onecard.card.social!=null&&onecard.card.social.length>0)||onecard.admin.isPortal){if(isEmployeeCard(onecard.card)){html+='<h2 style="text-align: center">Personal Profiles</h2>';}
var displayed=[];$(onecard.card.social).each(function(){var type=this.description;if(this.url.rtrim()==''){return;}
if($.inArray(type,displayed)==-1){displayed.push(type);var matches=$.grep(onecard.card.social,function(social,index){return(social.description==type&&social.url.rtrim()!='');});if(onecard.admin.isPortal==false){if(matches.length>1){html+='<a onclick="showSocialLink(\''+this.description+'\');" class="social-link">';}else{html+='<a href="'+formatURL(this.url)+'" target="_BLANK" class="social-link">';}
html+='<span class="icon_social '+ this.icon+'"></span>';html+='<div class="title">';if(matches.length>1){html+=this.description+' <i style="font-size: 10px;">('+matches.length+')</i>';}else{html+=this.description;}
html+='</div>';html+='</a>';}else{html+='<div id="'+this.key+'" class="group" data-sortable="socials">';html+='<div class="group_header">';html+='<table><tr>';html+='<td class="group_header_title" ><a onclick=""><div class="adj name"><span>'+this.description+'</span></div></a></td>';html+='</tr></table>';html+='</div>';html+='<div class="collapsible-content">';for(var i=0;i<matches.length;i++){var url=matches[i];if(url.url.rtrim()!=''){html+='<a class="history" style="text-align: left;" data-key="'+url.key+'" data-type="Social">';html+=((url.title!="")?url.title:url.url);html+='<span class="icon_menu enter"></span></a>';html+='</a>';}}
html+='</div>';html+='</div>';}}});}
if(!onecard.admin.isPortal&&isEmployeeCard(onecard.card)&&(onecard.card.company.social!=null&&onecard.card.company.social.length>0)){html+='<h2 style="text-align: center">Corporate Profiles</h2>';var displayed=[];$(onecard.card.company.social).each(function(){var type=this.description;if(this.url.rtrim()==''){return;}
if($.inArray(type,displayed)==-1){displayed.push(type);var matches=$.grep(onecard.card.social,function(social,index){return(social.description==type&&social.url.rtrim()!='');});if(onecard.admin.isPortal==false){if(matches.length>1){html+='<a onclick="showSocialLink(\''+this.description+'\');" class="social-link">';}else{html+='<a href="'+formatURL(this.url)+'" target="_BLANK" class="social-link">';}
html+='<span class="icon_social '+ this.icon+'"></span>';html+='<div class="title">';if(matches.length>1){html+=this.description+' <i style="font-size: 10px;">('+matches.length+')</i>';}else{html+=this.description;}
html+='</div>';html+='</a>';}else{html+='<div id="'+this.key+'" class="group" data-sortable="socials">';html+='<div class="group_header">';html+='<table><tr>';html+='<td class="group_header_title" ><a onclick=""><div class="adj name"><span>'+this.description+'</span></div></a></td>';html+='</tr></table>';html+='</div>';html+='<div class="collapsible-content">';for(var i=0;i<matches.length;i++){var url=matches[i];if(url.url.rtrim()!=''){html+='<a class="history" style="text-align: left;" data-key="'+url.key+'" data-type="Social">';html+=((url.title!="")?url.title:url.url);html+='<span class="icon_menu enter"></span></a>';html+='</a>';}}
html+='</div>';html+='</div>';}}});}
if(html!=''){if((onecard.card.contact_email!=null&&onecard.card.contact_email!="")||(isEmployeeCard(onecard.card)&&onecard.card.company.contact_email!=null&&onecard.card.company.contact_email!="")||onecard.admin.isPortal){html='<div class="right-col">'+html+'</div>';}
$(page).find('.grid_content_scroller').append(html);}}
function loadSocialContact(page){var html="";var email=onecard.card.contact_email;if(isEmployeeCard(onecard.card)&&onecard.card.company.contact_email&&onecard.card.company.contact_email!=""){email=onecard.card.company.contact_email;}
if(onecard.admin.isPortal==false&&email&&email!=""){html+='<input type="hidden" name="to" id="contact-to" value="'+ email+'" />';html+='<input type="hidden" name="id" id="contact-id" value="'+ getCardIDActual(onecard.card)+'" />';html+='<input type="hidden" name="name" id="contact-name" value="'+ getFullName(onecard.card)+'" />';html+='<h2>Request Contact Form</h2>';html+='<div style="position: relative; padding: 2px 0">';html+='<span id="placeholder-email" class="placeholder" onclick="placeholderClick(this);">Email</span>';html+='<input id="contact-from" class="dark" type="email" name="email-from" x-webkit-speech />';html+='</div>';html+='<div style="position: relative; padding: 2px 0">';html+='<span id="placeholder-subject" class="placeholder" onclick="placeholderClick(this);">Subject</span>';html+='<input id="contact-subject" class="dark" type="text" name="email-subject" x-webkit-speech />';html+='</div>';html+='<div style="position: relative; padding: 2px 0">';html+='<span id="placeholder-message" class="placeholder" onclick="placeholderClick(this);">How can I help you today?</span>';html+='<textarea id="contact-message" name="email-message" class="dark" rows="5" x-webkit-speech></textarea>';html+='</div>';html+='<a class="button" onclick="sendRequestContact();">';html+='Send Email';html+='</a>';html+='<br />';html='<div class="left-col">'+html+'</div>';$(page).find('.grid_content_scroller').append(html);}
if(onecard.admin.isPortal){html+='<h2 style="text-align:left; margin: 25px 5px 5px;">Contact Form</h2><div style="text-align:left; font-size: 12px; margin: 0 5px 5px;">A contact form allows customers to send you an email from your One Card™.</div>';html+='<a class="contact-email" data-type="ContactEmail" style="margin:0 5px 10px">';if(onecard.card.contact_email!=null&&onecard.card.contact_email!=""){html+='Edit Contact Form';}else{html+='Add Contact Form<br />';}
html+='</a>';html='<div class="left-col">'+html+'</div>';$(page).find('.grid_content_scroller').append(html);}}
function showSocialLink(type){var message="";message+='<h2 style="margin: 8px; 0px;">Click to View Profile</h2>';$(onecard.card.social).each(function(){if(this.description==type&&this.url.rtrim()!=''){message+='<a class="social-link-button" href="'+formatURL(this.url)+'" target="_BLANK">';message+=((this.title!="")?this.title:this.url);message+='</a>';}});$.confirm({'title':type,'message':message,'buttons':{}});}
function loadAbout(page){var html="";if(isCompanyCard(onecard.card)&&((onecard.card.video_intro!=null&&onecard.card.video_intro.url!=""))){html+='<div id="commercial" class="group">';html+=loadHeader("commercial","Commercial",null,true,false,false);html+='<div class="collapsible-content">';html+='<div id="about-video" class="video-frame">';html+=buildFrameforVideo(onecard.card.video_intro.url,onecard.card.video_intro.type,true);html+='</div>';if(onecard.admin.isPortal){html+='<a class="history more" data-type="AboutVideo" >';html+='Tap here to Edit';html+='</a>';}
html+='</div>';html+='</div>';}
if(onecard.card.about!=""){var modifiedWidth='';if((!onecard.card.video_intro||onecard.card.video_intro.url=='')&&(!onecard.card.skills||onecard.card.skills.length==0)){modifiedWidth='width: 100%';}
html+='<div id="about" class="group" style="'+modifiedWidth+'">';html+=loadHeader("about","About",null,true,false,false);html+='<div class="collapsible-content">';if(onecard.card.about!=""){html+='<div class="content">';html+=onecard.card.about;html+='</div>';}
if(onecard.admin.isPortal){html+='<a class="history more" data-type="About" >';html+='Tap here to Edit';html+='</a>';}
html+='</div>';html+='</div>';}
if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);rewireIframe('body');}
function loadSkillsAndExpertise(page){if(onecard.card.skills.length>0){var html="";html+='<div id="'+(isCompanyCard(onecard.card)?'sao':'sae')+'" class="group">';var title=(isCompanyCard(onecard.card))?'Services & Offerings':'Skills & Expertise';html+=loadHeader((isCompanyCard(onecard.card)?'sao':'sae'),title,null,true,false,false);html+='<div class="collapsible-content">';if(onecard.admin.isPortal){html+='<div class="group-toolbar">';if(onecard.card.skills.length==1){html+='<div id="group-edit" class="full"><a class="details" onclick="adminPopupSkill(null);" >';html+='Add<span class="icon_menu enter"></span>';html+='</a></div>';}
if(onecard.card.skills.length>1){html+='<div id="group-edit"><a class="details" onclick="adminPopupSkill(null);" >';html+='Add<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-sort"><a class="sort" onclick="sortingStart(this, \'skills\');" >';html+='Sort<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-save"><a class="save" onclick="sortingSave();" >';html+='Save<span class="icon_menu enter"></span>';html+='</a></div>';}
html+='</div>';}
html+='<div class="sortable-group">';var leftCol="";var rightCol="";for(var i=0;i<onecard.card.skills.length;i++){var skill=onecard.card.skills[i];var button="";button+='<a id="'+i+'" class="skill" data-type="Skill" data-sortable="skills" style="cursor: default;">';button+='&nbsp;&bull;&nbsp;<span class="skill-actual">'+ skill+'</span>';button+='</a>';if(i<onecard.card.skills.length/2){leftCol+=button;}else{rightCol+=button;}}
html+=leftCol+ rightCol;html+='</div>';html+='</div>';if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);if(isCompanyCard(onecard.card)){if($('#grid_content_scroller #about.group').height()<$('#grid_content_scroller #commercial.group').height()){$('#grid_content_scroller #sao.group').width('66.64%');}}}}
function loadResumeHistory(page){var html='';html+=loadEmploymentHistory();html+=loadEducationHistory();if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);}
function loadEmploymentHistory(){var html="";if((onecard.card.history!=null&&onecard.card.history.employment.length>0)){html+='<div id="employment" class="group">';html+=loadHeader("employment","Experience",null,true,false,false);html+='<div class="collapsible-content">';var leftCol="";var rightCol="";for(var i=0;i<onecard.card.history.employment.length;i++){var company=onecard.card.history.employment[i];var button="";button+='<a class="history '+((i==0)?"first":"")+'" data-key="'+company.key+'" data-type="Employment" style="cursor: default;">';var start_month=(company.start.month)?company.start.month:"0";var start_year=(company.start.year)?company.start.year:"0";var end_month=(company.end.month)?company.end.month:"0";var end_year=(company.end.year)?company.end.year:"0";button+='<h2>'+ company.name+'</h2>';if(company.title!=""){button+='<span>'+ company.title+'</span>';}else if(start_month!="0"||end_month!="0"){button+='<span>Date: </span>';}
if(start_month!="0"){button+='<span style="float: right; font-size: 12px;"><i>'+(start_month+'/'+ start_year);if(end_month!="0"){button+=" - "+(end_month+"/"+ end_year)+'</i></span>';}else{button+='</i></span>';}}else if(end_month!="0"){button+='<span style="float: right; font-size: 12px;"><i>'+(end_month+'/'+ end_year)+'</i></span>';}
button+='<span class="clear"></span>';button+='</a>';if(i<onecard.card.history.employment.length/2){leftCol+=button;}else{rightCol+=button;}}
html+=leftCol+ rightCol;html+='</div>';html+='</div>';}
return html;}
function loadEducationHistory(){var html="";if((onecard.card.history!=null&&onecard.card.history.education.length>0)){html+='<div id="education" class="group">';html+=loadHeader("education","Education",null,true,false,false);html+='<div class="collapsible-content">';var leftCol="";var rightCol="";for(var i=0;i<onecard.card.history.education.length;i++){var school=onecard.card.history.education[i];var button="";button+='<a class="history '+((i==0)?"first":"")+'" data-key="'+school.key+'" data-type="Education" style="cursor: default;">';var start_month=(school.start.month)?school.start.month:"0";var start_year=(school.start.year)?school.start.year:"0";var end_month=(school.end.month)?school.end.month:"0";var end_year=(school.end.year)?school.end.year:"0";button+='<h2>'+ school.name+'</h2>';if(school.degree!=""){button+='<span>'+ school.degree+'</span>';}else if(start_month!="0"||end_month!="0"){button+='<span>Date: </span>';}
if(start_month!="0"){button+='<span style="float: right; font-size: 12px;"><i>'+(start_month+"/"+ start_year);if(end_month!="0"){button+=" - "+(end_month+"/"+ end_year)+'</i></span>';}else{button+='</i></span>';}}else if(end_month!="0"){button+='<span style="float: right; font-size: 12px;"><i>'+(end_month+"/"+ end_year)+'</i></span>';}
button+='<span class="clear"></span>';button+='</a>';if(i<onecard.card.history.education.length/2){leftCol+=button;}else{rightCol+=button;}}
html+=leftCol+ rightCol;html+='</div>';html+='</div>';}
return html;}
function loadCompanyAbout(page){var html="";if(onecard.card.company&&((onecard.card.company.commercial&&onecard.card.company.commercial.url!="")||(onecard.card.company.about&&onecard.card.company.about!="")||(onecard.card.company.services&&onecard.card.company.services.length>0))){html+='<h2 style="text-align: center; clear: both;">Corporate Bio</h2>';}
if(onecard.card.company&&onecard.card.company.commercial&&onecard.card.company.commercial.url!=""){html+='<div id="commercial" class="group">';html+=loadHeader("commercial","Commercial",null,true,false,false);html+='<div class="collapsible-content">';html+='<div id="about-video" class="video-frame">';html+=buildFrameforVideo(onecard.card.company.commercial.url,onecard.card.company.commercial.type,true);html+='</div>';html+='</div>';html+='</div>';}
if(onecard.card.company&&onecard.card.company.about&&onecard.card.company.about!=""){var modifiedWidth='66.64%';if((!onecard.card.company.commercial||onecard.card.company.commercial.url=='')&&(!onecard.card.company.services||onecard.card.company.services.length==0)){modifiedWidth='100%';}
html+='<div id="cabout" class="group company" style="width: '+modifiedWidth+';">';html+=loadHeader("cabout","About",null,true,false,false);html+='<div class="collapsible-content">';html+='<div class="content">';html+=onecard.card.company.about;html+='</div>';html+='</div>';html+='</div>';}
if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);rewireIframe('body');}
function loadCompanySkillsAndExpertise(page){if(onecard.card.company&&onecard.card.company.services&&onecard.card.company.services.length>0){var html="";html+='<div id="sao" class="group">';var title='Services & Offerings';html+=loadHeader('sao',title,null,true,false,false);html+='<div class="collapsible-content">';html+='<div class="sortable-group">';var leftCol="";var rightCol="";for(var i=0;i<onecard.card.company.services.length;i++){var skill=onecard.card.company.services[i];var button="";button+='<a id="'+i+'" class="skill" data-type="Skill" data-sortable="skills" style="cursor: default;">';button+='&nbsp;&bull;&nbsp;<span class="skill-actual">'+ skill+'</span>';button+='</a>';if(i<onecard.card.skills.length/2){leftCol+=button;}else{rightCol+=button;}}
html+=leftCol+ rightCol;html+='</div>';html+='</div>';html+='</div>';if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);if(onecard.card.company){if($('#grid_content_scroller #cabout.group.company').height()<$('#grid_content_scroller #commercial.group').height()){$('#grid_content_scroller #sao.group').width('66.64%');}}}}
function loadInfoMenu(page){var html="";mode=getParam('infomenu')||'list';if(onecard.admin.isPortal){html+='<div class="group-toolbar" style="margin: -5px -5px 5px;">';html+='<div id="group-edit"><a class="details" onclick="adminPopupInfoPage(\'\');">';html+='Add Page<span class="icon_menu plus"></span>';html+='</a></div>';html+='<div id="group-sort"><a class="sort" onclick="sortingStart(this, \'info-pages\');" >';html+='Sort Pages<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-save"><a class="save" onclick="sortingSave();" >';html+='Save Sorting<span class="icon_menu enter"></span>';html+='</a></div>';html+='</div>';}
if(onecard.admin.isPortal==false){html+='<a onclick="toggleInfoViewMode(\''+((mode=='grid')?'list':'grid')+'\');" class="info-view-mode">';}
else{html+='<a class="info-view-mode">';}
html+='Information Center<br />';if(onecard.admin.isPortal==false){html+='<span>Tap to Toggle List/Grid View</span><span class="icon '+mode+'"></span>';}
html+='</a>';html+='<div class="sortable-group">';$(onecard.card.infocenter).each(function(){var iconTitle=this.icon_title||this.icon.capitalize();if(mode=='list'||onecard.admin.isPortal){html+='<a id="'+this.key+'" '+(onecard.admin.isPortal?'onclick="expandInfoSubMenu(this);"':'onclick="expandSection(\''+this.key+'\');"')+' class="group info-link list" data-sortable="info-pages">';html+='<div class="group_header_title" style="display: none;"><div class="name"><span>'+this.title+'</span></div></div>';html+='<span class="icon_info '+ this.icon+'"></span>';html+='<div class="title">';html+='<div>'+ this.title+'</div>';html+='<span>'+ iconTitle+'</span>';html+='</div>';if(onecard.admin.isPortal){html+='<span class="icon_menu enter"></span>';}
html+='</a>';if(onecard.admin.isPortal){html+='<div class="group-toolbar info-page-menu" style="display: none; margin: -5px 5px 5px;background-color: rgb(230, 230, 230);">';html+='<div id="group-sort">';html+='<a class="sort" onclick="expandSection(\''+this.key+'\');" style="background-color: rgb(0,69,121);border: none;">Edit Content<span class="icon_menu enter"></span></a>';html+='</div>';html+='<div id="group-edit">';html+='<a class="page-edit" onclick="adminPopupInfoPage(\''+this.key+'\');" style="background-color: #6D6E71;border: none;">Edit/Delete Page<span class="icon_menu plus"></span></a>';html+='</div>';html+='</div>';}}else{html+='<a id="'+this.key+'" onclick="expandSection(\''+this.key+'\');" class="group info-link" target="_BLANK">';html+='<div class="group_header_title" style="display: none;"><div class="name"><span>'+this.title+'</span></div></div>';html+='<span class="icon_info '+ this.icon+'"></span>';html+='<div class="title">';html+='<div class="jtf"><span>'+ iconTitle+'</span></div>';html+='</div>';html+='</a>';}});if(!onecard.admin.isPortal&&isEmployeeCard(onecard.card)&&onecard.card.company&&onecard.card.company.infocenter){html+='<h2 style="text-align: center; clear: both;">Corperate\'s Info Center</h2>';$(onecard.card.company.infocenter).each(function(){var iconTitle=this.icon_title||this.icon.capitalize();if(mode=='list'){html+='<a id="'+this.key+'" '+(onecard.admin.isPortal?'onclick="expandInfoSubMenu(this);"':'onclick="expandSection(\''+this.key+'\');"')+' class="group info-link list" data-sortable="info-pages">';html+='<div class="group_header_title" style="display: none;"><div class="name"><span>'+this.title+'</span></div></div>';html+='<span class="icon_info '+ this.icon+'"></span>';html+='<div class="title">';html+='<div>'+ this.title+'</div>';html+='<span>'+ iconTitle+'</span>';html+='</div>';if(onecard.admin.isPortal){html+='<span class="icon_menu enter"></span>';}
html+='</a>';}else{html+='<a id="'+this.key+'" onclick="expandSection(\''+this.key+'\');" class="group info-link" target="_BLANK">';html+='<div class="group_header_title" style="display: none;"><div class="name"><span>'+this.title+'</span></div></div>';html+='<span class="icon_info '+ this.icon+'"></span>';html+='<div class="title">';html+='<div class="jtf"><span>'+ iconTitle+'</span></div>';html+='</div>';html+='</a>';}});}
html+='</div>';$(page).find('.grid_nav_scroller').append(html);}
function loadInfoItems(page){var info=getParam('info');var infoFound=false;var html='';$(onecard.card.infocenter).each(function(){if(this.title.rtrim()==''){return;}
if(info!=null&&info==this.key){infoFound=true;}
var sort=this.sort;html+='<div id="'+this.key+'" class="group collapsed">';html+=loadHeader(this.key,this.title,null,true,false,false);html+='<div class="collapsible-content">';if(onecard.admin.isPortal){html+='<div class="group-toolbar">';var asort=this.groups.length+1;html+='<div id="group-edit"><a class="details" onclick="updateUserInfoGroup(this, \'insert\');" data-pkey="'+this.key+'" data-key="" data-sort="'+asort+'">';html+='Add Section<span class="icon_menu plus"></span>';html+='</a></div>';html+='<div id="group-sort"><a class="sort" onclick="sortingStart(this, \'info-groups\');" >';html+='Sort Sections<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-save"><a class="save" onclick="sortingSave();" >';html+='Save Sorting<span class="icon_menu enter"></span>';html+='</a></div>';html+='</div>';}
html+='<div class="sortable-group">';var leftCol='';var rightCol='';for(var g=0;g<this.groups.length;g++){var group=this.groups[g];var ghtml='';ghtml+='<div class="info-group" data-sortable="info-groups" data-key="'+group.key+'" data-type="Group">';if(onecard.admin.isPortal){ghtml+='<h2>Section</h2>';ghtml+='<a class="admin add" onclick="adminPopupAddInfoItem(\''+this.key+'\', \''+group.key+'\');">Add Item</a>';ghtml+='<a class="admin sort" onclick="sortingStart(this, \'info-items\');">Sort Items</a>';ghtml+='<a class="admin delete" onclick="updateUserInfoGroupDelete(this);" data-pkey="'+this.key+'" data-key="'+group.key+'" data-sort="'+group.sort+'">Delete</a>';}
ghtml+='<div class="sortable-group">';for(var i=0;i<group.items.length;i++){var item=group.items[i];switch(item.type){case"Header":ghtml+=loadInfoTypeHeader(item,this.key,group.key);break;case"Image":var images=item.src.split(",");if(images.length>1){ghtml+=loadInfoTypeAlbum(item,images,this.key,group.key,false);}
else if(images.length==1){ghtml+=loadInfoTypeImage(item,this.key,group.key,false);}
break;case"ListItem":ghtml+=loadInfoTypeListItem(item,this.key,group.key);break;case"Price":ghtml+=loadInfoTypePrice(item,this.key,group.key);break;case"TextBlock":ghtml+=loadInfoTypeTextBlock(item,this.key,group.key);break;case"Url":ghtml+=loadInfoTypeUrl(item,this.key,group.key);break;case"Video":ghtml+=loadInfoTypeVideo(item,this.key,group.key);break;default:ghtml+="";break;}}
ghtml+='</div>';ghtml+='</div>';if(this.groups.length.isEven()){if(g<this.groups.length/2){leftCol+=ghtml;}else{rightCol+=ghtml;}}else{if((g+1)<Math.ceil(this.groups.length/2)){leftCol+=ghtml;}else{rightCol+=ghtml;}}}
if(onecard.admin.isPortal){html+=leftCol+ rightCol;}else if(this.groups.length<=1){html+='<div class="info-padded">'+leftCol+rightCol+'</div>';}else{html+='<div class="left-col">'+leftCol+'</div>';html+='<div class="right-col">'+rightCol+'</div>';}
html+='</div>';html+='</div>';html+='</div>';});if(!onecard.admin.isPortal&&isEmployeeCard(onecard.card)&&onecard.card.company&&onecard.card.company.infocenter){$(onecard.card.company.infocenter).each(function(){if(this.title.rtrim()==''){return;}
if(info!=null&&info==this.key){infoFound=true;}
var sort=this.sort;html+='<div id="'+this.key+'" class="group collapsed">';html+=loadHeader(this.key,this.title,null,true,false,false);html+='<div class="collapsible-content">';if(onecard.admin.isPortal){html+='<div class="group-toolbar">';var asort=this.groups.length+1;html+='<div id="group-edit"><a class="details" onclick="updateUserInfoGroup(this, \'insert\');" data-pkey="'+this.key+'" data-key="" data-sort="'+asort+'">';html+='Add Section<span class="icon_menu plus"></span>';html+='</a></div>';html+='<div id="group-sort"><a class="sort" onclick="sortingStart(this, \'info-groups\');" >';html+='Sort Sections<span class="icon_menu enter"></span>';html+='</a></div>';html+='<div id="group-save"><a class="save" onclick="sortingSave();" >';html+='Save Sorting<span class="icon_menu enter"></span>';html+='</a></div>';html+='</div>';}
html+='<div class="sortable-group">';var leftCol='';var rightCol='';for(var g=0;g<this.groups.length;g++){var group=this.groups[g];var ghtml='';ghtml+='<div class="info-group" data-sortable="info-groups" data-key="'+group.key+'" data-type="Group">';if(onecard.admin.isPortal){ghtml+='<h2>Section</h2>';ghtml+='<a class="admin add" onclick="adminPopupAddInfoItem(\''+this.key+'\', \''+group.key+'\');">Add Item</a>';ghtml+='<a class="admin sort" onclick="sortingStart(this, \'info-items\');">Sort Items</a>';ghtml+='<a class="admin delete" onclick="updateUserInfoGroupDelete(this);" data-pkey="'+this.key+'" data-key="'+group.key+'" data-sort="'+group.sort+'">Delete</a>';}
ghtml+='<div class="sortable-group">';for(var i=0;i<group.items.length;i++){var item=group.items[i];switch(item.type){case"Header":ghtml+=loadInfoTypeHeader(item,this.key,group.key);break;case"Image":var images=item.src.split(",");if(images.length>1){ghtml+=loadInfoTypeAlbum(item,images,this.key,group.key,true);}
else if(images.length==1){ghtml+=loadInfoTypeImage(item,this.key,group.key,true);}
break;case"ListItem":ghtml+=loadInfoTypeListItem(item,this.key,group.key);break;case"Price":ghtml+=loadInfoTypePrice(item,this.key,group.key);break;case"TextBlock":ghtml+=loadInfoTypeTextBlock(item,this.key,group.key);break;case"Url":ghtml+=loadInfoTypeUrl(item,this.key,group.key);break;case"Video":ghtml+=loadInfoTypeVideo(item,this.key,group.key);break;default:ghtml+="";break;}}
ghtml+='</div>';ghtml+='</div>';if(this.groups.length.isEven()){if(g<this.groups.length/2){leftCol+=ghtml;}else{rightCol+=ghtml;}}else{if((g+1)<Math.ceil(this.groups.length/2)){leftCol+=ghtml;}else{rightCol+=ghtml;}}}
if(onecard.admin.isPortal){html+=leftCol+ rightCol;}else if(this.groups.length<=1){html+='<div class="info-padded">'+leftCol+rightCol+'</div>';}else{html+='<div class="left-col">'+leftCol+'</div>';html+='<div class="right-col">'+rightCol+'</div>';}
html+='</div>';html+='</div>';html+='</div>';});}
$(page).find('.grid_content_scroller').append(html);if(info!=null&&infoFound){expandSection(info);}else{if(isMobile()){collapseAllSections();}else{collapseAllButFirst();}
$(document.body).removeClass('menu');$('.page .grid').addClass('menu');}}
function toggleInfoViewMode(mode){setParam('infomenu',mode,true);alert('hi');$($('.body')).find('.grid_nav_scroller').children().remove();$($('.body')).find('.grid_content_scroller').children().remove();loadInfoMenu($('.body'));loadInfoItems($('.body'));loadNotices($('.body'));}
function getInfoPageWithKey(key){var page=null;$(onecard.card.infocenter).each(function(){if(this.key==key){page=this;return page;}});return page;}
function getImagesInAlbum(i,items){var orI=i;var nitems=Array();for(;i<items.length;i++){var item=items[i];if(item.type=="Image"){if(item.groupable=='1'){nitems.push(item);}else if(orI!=i){i--;break;}else{break;}}else{i--;break;}}
return[i,nitems];}
function loadInfoTypeHeader(node,pkey,gkey){if(node.header.rtrim()==''){return'';}
var html="";html+='<div class="info-header" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="Header">';if(onecard.admin.isPortal){html+='<span class="icon_info_item header"></span>';}
html+=''+ node.header+'';html+='</div>';return html;}
function loadInfoTypeImage(node,pkey,gkey,isParent){if(node.src.rtrim()==''){return'';}
var html='';var d=new Date();var src='http://'+ siteAddress+'/files/'+ getCardID(onecard.card)+'/images/'+ node.src+'?time='+ d.getTime();if(isParent){src='http://'+ siteAddress+'/files/'+ getCompany(onecard.card)+'/images/'+ node.src+'?time='+ d.getTime();}
if(node.src!=null&&node.src!=""){html+='<div class="info-image" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="Image">';if(onecard.admin.isPortal){html+='<span class="icon_info_item image"></span>';}
html+='<img src="'+src+'" />';if(onecard.admin.isPortal==true){html+='<br /><i style="font-size: 12px;">Click image to edit.</i>';}
html+='</div>';}
return html;}
function loadInfoTypeAlbum(node,images,pkey,gkey,isParent){if(images.length==0){return'';}
var html='';var d=new Date();html+='<div class="info-album" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="Image">';if(onecard.admin.isPortal){html+='<span class="icon_info_item image"></span>';}
for(var i=0;i<images.length;i++){var image=images[i];if(image!=null&&image!=""){var src='http://'+ siteAddress+'/files/'+ getCardID(onecard.card)+'/images/'+ image+'?time='+ d.getTime();if(isParent){src='http://'+ siteAddress+'/files/'+ getCompany(onecard.card)+'/images/'+ image+'?time='+ d.getTime();}
html+='<div id="container">';html+='<div id="dummy"></div>';html+='<div id="element" '+((onecard.admin.isPortal==false)?('onclick="expandImage(\''+src+'\');"'):'')+' style="background-image: url(\''+src+'\');"></div>';html+='</div>';}}
if(onecard.admin.isPortal==false){html+='<br /><i style="font-size: 12px;">Click images to zoom.</i>';}else{html+='<br /><i style="font-size: 12px;">Click any image to edit album.</i>';}
html+='</div>';return html;}
function loadInfoTypeListItem(node,pkey,gkey){if(node.item.rtrim()==''){return'';}
var html="";html+='<div class="info-listitem" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="ListItem">';if(onecard.admin.isPortal){html+='<span class="icon_info_item list"></span>';}
html+='&bull; '+ node.item+'';html+='</div>';return html;}
function loadInfoTypePrice(node,pkey,gkey){if(node.price.rtrim()==''){return'';}
var html="";html+='<div class="info-price" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="Price">';if(onecard.admin.isPortal){html+='<span class="icon_info_item price"></span>';}
html+=''+ node.price+'';html+='</div>';return html;}
function loadInfoTypeTextBlock(node,pkey,gkey){if(node.text.rtrim()==''){return'';}
var html="";html+='<div class="info-content" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="TextBlock">';if(onecard.admin.isPortal){html+='<span class="icon_info_item textblock"></span>';}
html+=''+ node.text+'</div>';return html;}
function loadInfoTypeUrl(node,pkey,gkey){if(node.url.rtrim()==''){return'';}
var html="";html+='<a href="'+formatURL(node.url)+'" target="_blank" class="info-url" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="Url">';if(onecard.admin.isPortal){html+='<span class="icon_info_item url"></span>';}
if(node.title!=""){html+=''+ node.title+'';}else{html+='Visit Web Page';}
html+='<span class="icon_menu enter"></span>';html+='</a>';return html;}
function loadInfoTypeVideo(node,pkey,gkey){if(node.url.rtrim()==''){return'';}
var html="";html+='<div class="info-video" data-sortable="info-items" data-key="'+node.key+'" data-pkey="'+pkey+'" data-gkey="'+gkey+'" data-type="Video">';if(onecard.admin.isPortal){html+='<span class="icon_info_item video"></span>';}
if(!onecard.admin.isPortal){html+='<div class="video-frame">';html+=buildFrameforVideo(node.url,node.video_type,true);html+='</div>';}else{html+=buildVideoURLFromID(node.url,node.video_type);}
html+='</div>';if(!onecard.admin.isPortal){var displayTitle='';if(node.video_type=='youtube'){displayTitle='YouTube';}
if(node.video_type=='vimeo'){displayTitle='Vimeo';}
html+='<a href="'+buildVideoURLFromID(node.url,node.video_type)+'" target="_blank" class="info-url">Open in '+displayTitle+'<span class="icon_menu enter"></span></a>';}
return html;}
function loadClear(page){var html="";html+='<span class="clear"></span>';if(onecard.admin.isPortal==false){$(page).find('.grid_nav_scroller').append(html);}
$(page).find('.grid_content_scroller').append(html);}
function loadQRPro(page){}
function loadAdvertisementPage(page){var id=$(page).attr('id');var html='';html+='<br /><div class="right-col" style="text-align: center;">\
		<a class="button" style="background-color: #005696; display:inline-block; width: 70%; border-radius: 5px;" href="http://QRPro.co" target="_blank">Learn More</a><br /><br />\
		<h1>What is the One Card™</h1>';html+='<div class="video-frame" style="margin: 0 10%;">';html+=buildFrameforVideo('l7LCDiHE5iQ','YouTube',true);html+='</div>';html+='<p style="padding: 20px 10px 10px; text-align: left; font-size:12px;">\
			The One Card™ is an interactive, digital business card that changes the way you communicate with your customers. The One Card™ works on smart phones, tablets and computers with NO APP required. That is one of the things that sets us apart from any of our “competitors”. The fact is, people don’t have time to go download an app to connect with your information. We made the digital handoff accessible to anyone, anywhere and anytime.\
		</p>\
		<br /><br />\
	</div>';switch(id){case"bio":html+='<div class="left-col" style="text-align: left;">\
				<div style="text-">\
					<a class="button" style="text-align:center;display:inline-block; width: 70%; border-radius: 5px; background-color:rgb(0, 150, 6);"  href="http://QRPro.co" target="_blank">Get a free One Card™</a><br /><br />\
				</div>\
				<div style="text-align: center;"><img src="/images/logos/onecard-powered-by-qrpro.png" alt="One Card Logo" style="margin-top: 10px; width: 70%"></div>\
				<h1>Your Digital Resume</h1>\
				<p style="padding: 0 10px;">\
					The About page of your One Card™ is designed to be a digital resume for you to share your accomplishments and what make you stand out from the rest of your competition. Because we all know that in business, credibility is everything.\
				</p>\
				<h2>Featuring:</h2>\
				<ul>\
					<li>About section</li>\
					<li>Experience section</li>\
					<li>Education section</li>\
					<li>Skills and Expertise section</li>\
				</ul>\
				<br /><br />\
			</div>';break;case"social":html+='<div class="left-col" style="text-align: left;">\
				<div style="text-">\
					<a class="button" style="text-align:center;display:inline-block; width: 70%; border-radius: 5px; background-color:rgb(0, 150, 6);left: 50%;margin-left: -35%;"  href="http://QRPro.co" target="_blank">Get a free One Card™</a><br /><br />\
				</div>\
				<div style="text-align: center;"><img src="/images/logos/onecard-powered-by-qrpro.png" alt="One Card Logo" style="margin-top: 10px; width: 70%"></div>\
				<h1>Your Social Media Dashboard</h1>\
				<p style="padding: 0 10px;">\
					With so many Social Networks out there, it’s important for your customers to be able to pick and choose how they want to connect with you. Your One Card™ Social Media page puts them all in one easily accessible place.\
				</p>\
				<h2>Featuring:</h2>\
				<ul>\
					<li>27 social networks</li>\
					<li>The ability to add multiple profiles from one social network</li>\
					<li>Direct contact form</li>\
				</ul>\
				<br /><br />\
			</div>';break;case"info":html+='<div class="left-col" style="text-align: left;">\
				<div style="text-">\
					<a class="button" style="text-align:center;display:inline-block; width: 70%; border-radius: 5px; background-color:rgb(0, 150, 6);left: 50%;margin-left: -35%;"  href="http://QRPro.co" target="_blank">Get a free One Card™</a><br /><br />\
				</div>\
				<div style="text-align: center;"><img src="/images/logos/onecard-powered-by-qrpro.png" alt="One Card Logo" style="margin-top: 10px; width: 70%"></div>\
				<h1>Your Digital Brochure</h1>\
				<p style="padding: 0 10px;">\
					The info center was designed to replace the standard brochure you give to your potential customer. When you need to share more information than a paper business card, but less than your website; you can custom build your info center to share information that is important.\
				</p>\
				<h2>Featuring:</h2>\
				<ul>\
					<li>Add your products or service information</li>\
					<li>Share a customer testimonial video</li>\
					<li>Create a resource page page with links</li>\
					<li>Feature a product with a video, description and a review</li>\
				</ul>\
				<br /><br />\
			</div>';break;case"staff":html+='<div class="left-col" style="text-align: left;">\
				<div style="text-">\
					<a class="button" style="text-align:center;display:inline-block; width: 70%; border-radius: 5px; background-color:rgb(0, 150, 6);left: 50%;margin-left: -35%;"  href="http://QRPro.co" target="_blank">Get a free One Card™</a><br /><br />\
				</div>\
				<div style="text-align: center;"><img src="/images/logos/onecard-powered-by-qrpro.png" alt="One Card Logo" style="margin-top: 10px; width: 70%"></div>\
				<h1>Your Staff directory</h1>\
				<p style="padding: 0 10px;">\
					The Staff section of the One Card™ was designed to be a basic directory of you staff\'s information. This will allows for your customers to easily find and connect your staff as needed instead searching through your website which may not have.\
				</p>\
				<h2>Featuring:</h2>\
				<ul>\
					<li>Link to their One Card™</li>\
					<li>Phone or Email contact</li>\
					<li>Organize by Location</li>\
				</ul>\
				<br /><br />\
			</div>';break;}
$(page).find('.grid_content_scroller').append(html);}
function displayDeviceDetection(){var html='<div class="space-checkbox">';html+='<h2>UserAgent</h2>';html+='<span style="font-size: 10px;">'+ navigator.userAgent+'</span>';html+='<br />';html+='<h2 style="margin: 10px 0">Special</h2>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.PhoneGap?'checked':'')+'>PhoneGap</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.iOSWebView?'checked':'')+'>iOSWebView</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.iOSStandalone?'checked':'')+'>Standalone</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.downgraded?'checked':'')+'>Down Graded Support</div>';html+='<br />';html+='<h2 style="margin: 10px 0">Detailed iOS Version</h2>';html+='<div style="margin: 6px 8px;"><input type="text" name="" value="Version: '+device.iOS.Version+'" disabled /></div>';html+='<div style="margin: 6px 8px;"><input type="text" name="" value="SubVersion: '+device.iOS.SubVerions+'" disabled /></div>';html+='<div style="margin: 6px 8px;"><input type="text" name="" value="Revision: '+device.iOS.Revision+'" disabled /></div>';html+='<br />';html+='<h2 style="margin: 10px 0">Supports</h2>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.PositionFixed?'checked':'')+'>PositionFixed</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.PushState?'checked':'')+'>PushState</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.InputFile?'checked':'')+'>InputFile</div>';html+='<br />';html+='<h2 style="margin: 10px 0">Operating System</h2>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.iOS?'checked':'')+'>iOS</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.Android?'checked':'')+'>Android</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.Blackberry?'checked':'')+'>Blackberry</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.Playbook?'checked':'')+'>Playbook</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.WindowsPhone?'checked':'')+'>WindowsPhone</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.WindowsCE?'checked':'')+'>WindowsCE</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.Zune?'checked':'')+'>Zune</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.webOS?'checked':'')+'>webOS</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.OSX?'checked':'')+'>OS X</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isOS.Windows?'checked':'')+'>Windows</div>';html+='<br />';html+='<h2 style="margin: 10px 0">Mobile/Tablet Browsers</h2>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.MobileSafari?'checked':'')+'>MobileSafari</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.AndroidBrowser?'checked':'')+'>AndroidBrowser</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.MobileChrome?'checked':'')+'>MobileChrome</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.MobileFirefox?'checked':'')+'>MobileFirefox</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Mercury?'checked':'')+'>Mercury</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.OperaMobile?'checked':'')+'>OperaMobile</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.OperaMini?'checked':'')+'>OperaMini</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Dolphin?'checked':'')+'>Dolphin</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.IEMobile?'checked':'')+'>IEMobile</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Blackberry?'checked':'')+'>Blackberry</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.webOS?'checked':'')+'>webOS</div>';html+='<br />';html+='<h2 style="margin: 10px 0">Full Browsers</h2>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Safari?'checked':'')+'>Safari</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Chrome?'checked':'')+'>Chrome</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Firefox?'checked':'')+'>Firefox</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Seamonkey?'checked':'')+'>Seamonkey</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.Opera?'checked':'')+'>Opera</div>';html+='<div class="checkbox"><input type="checkbox" name="" value="" disabled '+(device.isBrowser.InternetExplorer?'checked':'')+'>InternetExplorer</div>';html+='</div>';$.confirm({'title':'Device Details','message':html,'buttons':{}});}